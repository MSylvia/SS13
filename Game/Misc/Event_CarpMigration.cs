// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Event_CarpMigration : Event {

		public ByTable spawned_carp = new ByTable();

		protected override void __FieldInit() {
			base.__FieldInit();

			this.announceWhen = 20;
			this.endWhen = 450;
		}

		public Event_CarpMigration ( Obj_Item_MechaParts_MechaEquipment_Tool_CableLayer tlistener = null, string tprocname = null ) : base( tlistener, tprocname ) {
			
		}

		// Function from file: carp_migration.dm
		public override void end(  ) {
			Mob_Living_SimpleAnimal_Hostile_Carp C = null;
			dynamic T = null;

			
			foreach (dynamic _a in Lang13.Enumerate( this.spawned_carp, typeof(Mob_Living_SimpleAnimal_Hostile_Carp) )) {
				C = _a;
				

				if ( !Lang13.Bool( C.stat ) ) {
					T = GlobalFuncs.get_turf( C );

					if ( T is Tile_Space ) {
						GlobalFuncs.qdel( C );
						C = null;
					}
				}
			}
			return;
		}

		// Function from file: carp_migration.dm
		public override bool start(  ) {
			Obj_Effect_Landmark C = null;

			
			foreach (dynamic _a in Lang13.Enumerate( GlobalVars.landmarks_list, typeof(Obj_Effect_Landmark) )) {
				C = _a;
				

				if ( C.name == "carpspawn" ) {
					
					if ( Rand13.PercentChance( 90 ) ) {
						this.spawned_carp.Add( new Mob_Living_SimpleAnimal_Hostile_Carp( C.loc ) );
					}
				}
			}
			return false;
		}

		// Function from file: carp_migration.dm
		public override void announce(  ) {
			GlobalFuncs.command_alert( "Unknown biological entities have been detected near " + GlobalFuncs.station_name() + ", please stand-by.", "Lifesign Alert" );
			return;
		}

		// Function from file: carp_migration.dm
		public override void setup(  ) {
			this.announceWhen = Rand13.Int( 15, 30 );
			this.endWhen = Rand13.Int( 600, 1200 );
			return;
		}

	}

}