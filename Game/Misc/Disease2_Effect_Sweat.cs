// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Disease2_Effect_Sweat : Disease2_Effect {

		protected override void __FieldInit() {
			base.__FieldInit();

			this.name = "Hyper-perspiration Effect";
			this.stage = 3;
		}

		// Function from file: effect.dm
		public override bool activate( Mob_Living mob = null, bool multiplier = false ) {
			Ent_Static T = null;

			
			if ( Rand13.PercentChance( 30 ) ) {
				mob.emote( "me", 1, "is sweating profusely!" );

				if ( mob.loc is Tile_Simulated ) {
					T = mob.loc;

					if ( Convert.ToDouble( ((dynamic)T).wet ) < 1 ) {
						((dynamic)T).wet = 1;

						if ( Lang13.Bool( ((dynamic)T).wet_overlay ) ) {
							T.overlays.Remove( ((dynamic)T).wet_overlay );
							((dynamic)T).wet_overlay = null;
						}
						((dynamic)T).wet_overlay = new Image( "icons/effects/water.dmi", T, "wet_floor" );
						T.overlays.Add( ((dynamic)T).wet_overlay );
						Task13.Schedule( 800, (Task13.Closure)(() => {
							
							if ( T is Tile_Simulated && Convert.ToDouble( ((dynamic)T).wet ) < 2 ) {
								((dynamic)T).wet = 0;

								if ( Lang13.Bool( ((dynamic)T).wet_overlay ) ) {
									T.overlays.Remove( ((dynamic)T).wet_overlay );
									((dynamic)T).wet_overlay = null;
								}
							}
							return;
						}));
					}
				}
			}
			return false;
		}

	}

}