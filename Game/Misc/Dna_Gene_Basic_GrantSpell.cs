// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Dna_Gene_Basic_GrantSpell : Dna_Gene_Basic {

		public Type spelltype = null;
		public ByTable granted_spells = null;

		// Function from file: goon_powers.dm
		public override bool deactivate( dynamic M = null, dynamic connected = null, int? flags = null ) {
			Spell S = null;

			
			if ( base.deactivate( (object)(M), (object)(connected), flags ) ) {
				
				foreach (dynamic _a in Lang13.Enumerate( M.spell_list, typeof(Spell) )) {
					S = _a;
					

					if ( this.granted_spells.Contains( S ) ) {
						((Mob)M).remove_spell( S );
						this.granted_spells.Remove( S );
						GlobalFuncs.qdel( S );
					}
				}
				return true;
			}
			return false;
		}

		// Function from file: goon_powers.dm
		public override bool activate( dynamic M = null, dynamic connected = null, bool? flags = null ) {
			dynamic granted = null;

			base.activate( (object)(M), (object)(connected), flags );
			granted = Lang13.Call( this.spelltype );
			((Mob)M).add_spell( granted, "genetic_spell_ready", typeof(Obj_Screen_Movable_SpellMaster_Genetic) );

			if ( !( this.granted_spells != null ) ) {
				this.granted_spells = new ByTable();
			}
			this.granted_spells.Add( granted );
			return true;
		}

	}

}