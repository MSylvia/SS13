// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Recipe : Game_Data {

		public ByTable reagents = null;
		public ByTable reagents_forbidden = null;
		public ByTable items = null;
		public Type result = null;
		public int time = 100;

		// Function from file: recipe.dm
		public virtual dynamic make_food( Obj_Machinery_Microwave container = null ) {
			dynamic result_obj = null;
			Obj O = null;
			dynamic r_r = null;

			result_obj = Lang13.Call( this.result, container );

			foreach (dynamic _b in Lang13.Enumerate( container.contents - result_obj, typeof(Obj) )) {
				O = _b;
				

				if ( Lang13.Bool( O.reagents ) ) {
					
					foreach (dynamic _a in Lang13.Enumerate( this.reagents_forbidden )) {
						r_r = _a;
						
						((Reagents)O.reagents).del_reagent( "" + r_r );
					}
					((Reagents)O.reagents).update_total();
					((Reagents)O.reagents).trans_to( result_obj, O.reagents.total_volume );
				}
				GlobalFuncs.qdel( O );
			}
			((Reagents)container.reagents).clear_reagents();
			GlobalVars.score["meals"]++;
			return result_obj;
		}

		// Function from file: recipe.dm
		public virtual int check_items( Obj_Machinery_Microwave container = null ) {
			int _default = 0;

			ByTable checklist = null;
			Obj O = null;
			bool found = false;
			dynamic type = null;

			
			if ( !( this.items != null ) ) {
				
				if ( Lang13.Bool( Lang13.FindIn( typeof(Obj), container ) ) ) {
					return -1;
				} else {
					return 1;
				}
			}
			_default = 1;
			checklist = this.items.Copy();

			foreach (dynamic _b in Lang13.Enumerate( container, typeof(Obj) )) {
				O = _b;
				
				found = false;

				foreach (dynamic _a in Lang13.Enumerate( checklist )) {
					type = _a;
					

					if ( Lang13.Bool( type.IsInstanceOfType( O ) ) ) {
						checklist.Remove( type );
						found = true;
						break;
					}
				}

				if ( !found ) {
					_default = -1;
				}
			}

			if ( checklist.len != 0 ) {
				return 0;
			}
			return _default;
		}

		// Function from file: recipe.dm
		public int check_reagents( dynamic avail_reagents = null ) {
			int _default = 0;

			dynamic r_r = null;
			bool reagent_amount = false;

			_default = 1;

			foreach (dynamic _a in Lang13.Enumerate( this.reagents )) {
				r_r = _a;
				
				reagent_amount = ((Reagents)avail_reagents).get_reagent_amount( r_r );

				if ( !( Math.Abs( ( reagent_amount ?1:0) - Convert.ToDouble( this.reagents[r_r] ) ) < 0.5 ) ) {
					
					if ( ( reagent_amount ?1:0) > Convert.ToDouble( this.reagents[r_r] ) ) {
						_default = -1;
					} else {
						return 0;
					}
				}
			}

			if ( ( this.reagents != null ? this.reagents.len : 0 ) < avail_reagents.reagent_list.len ) {
				return -1;
			}
			return _default;
		}

	}

}