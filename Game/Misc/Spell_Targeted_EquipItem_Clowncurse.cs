// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Spell_Targeted_EquipItem_Clowncurse : Spell_Targeted_EquipItem {

		protected override void __FieldInit() {
			base.__FieldInit();

			this.name = "The Clown Curse";
			this.desc = "A curse that will turn its victim into a miserable clown.";
			this.charge_max = 300;
			this.invocation = "L' C'MMEDIA E F'NITA!";
			this.invocation_type = "shout";
			this.range = 1;
			this.spell_flags = 0;
			this.cooldown_min = 50;
			this.sparks_spread = true;
			this.sparks_amt = 4;
			this.compatible_mobs = new ByTable(new object [] { typeof(Mob_Living_Carbon_Human) });
			this.hud_state = "wiz_clown";
		}

		// Function from file: clowncurse.dm
		public Spell_Targeted_EquipItem_Clowncurse (  ) {
			// Warning: Super call was HERE! If anything above HERE is needed by the super call, it might break!;
			this.equipped_summons = new ByTable().Set( "" + 2, typeof(Obj_Item_Clothing_Mask_Gas_ClownHat) ).Set( "" + 14, typeof(Obj_Item_Clothing_Under_Rank_Clown) ).Set( "" + 12, typeof(Obj_Item_Clothing_Shoes_ClownShoes) );
			return;
		}

		// Function from file: clowncurse.dm
		public override dynamic summon_item( dynamic newtype = null ) {
			dynamic new_item = null;
			dynamic M = null;
			dynamic M2 = null;

			new_item = Lang13.Call( newtype );
			new_item.unacidable = 1;
			new_item.canremove = false;

			if ( new_item is Obj_Item_Clothing_Mask ) {
				M = new_item;
				M.can_flip = false;
			}

			if ( new_item is Obj_Item_Clothing_Shoes_ClownShoes ) {
				M2 = new_item;
				M2.wizard_garb = true;
			}
			return new_item;
		}

		// Function from file: clowncurse.dm
		public override bool cast( ByTable targets = null, Mob user = null ) {
			user = user ?? Task13.User;

			Mob_Living_Carbon_Human target = null;

			base.cast( targets, user );

			foreach (dynamic _a in Lang13.Enumerate( targets, typeof(Mob_Living_Carbon_Human) )) {
				target = _a;
				
				Icon13.Flick( "e_flash", target.flash );
				target.dna.SetSEState( GlobalVars.CLUMSYBLOCK, true );
				GlobalFuncs.genemutcheck( target, GlobalVars.CLUMSYBLOCK, null, true );
				target.update_mutations();
			}
			return false;
		}

	}

}