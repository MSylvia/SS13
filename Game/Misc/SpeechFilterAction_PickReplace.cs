// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class SpeechFilterAction_PickReplace : SpeechFilterAction {

		public dynamic replacements = null;

		// Function from file: speech.dm
		public SpeechFilterAction_PickReplace ( dynamic orig = null, dynamic args = null ) : base( (object)(orig), (object)(args) ) {
			// Warning: Super call was HERE! If anything above HERE is needed by the super call, it might break!;
			this.replacements = args;
			return;
		}

		// Function from file: speech.dm
		public override string Run( string text = null, Mob user = null, dynamic P = null ) {
			string o = null;
			dynamic lastidx = null;

			
			if ( Lang13.Bool( this.expr.Find( text ) ) ) {
				o = "";
				lastidx = 1;

				do {
					o += String13.SubStr( text, Convert.ToInt32( lastidx ), Convert.ToInt32( this.expr.match ) );
					o += Rand13.PickFromTable( this.replacements );
					lastidx = this.expr.index;
				} while ( Lang13.Bool( this.expr.FindNext( text ) ) );
				o += String13.SubStr( text, Convert.ToInt32( this.expr.index ), 0 );
				return o;
			}
			return text;
		}

	}

}