// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Spell_Targeted_Polymorph : Spell_Targeted {

		protected override void __FieldInit() {
			base.__FieldInit();

			this.name = "Polymorph";
			this.desc = "Mimic the appearance of others!";
			this.panel = "Mutant Powers";
			this.charge_max = 1800;
			this.spell_flags = 0;
			this.range = 1;
			this.selection_type = "range";
			this.compatible_mobs = new ByTable(new object [] { typeof(Mob_Living_Carbon_Human) });
			this.hud_state = "wiz_hulk";
			this.override_base = "genetic";
		}

		// Function from file: goon_powers.dm
		public override bool cast( ByTable targets = null, Mob user = null ) {
			Mob_Living_Carbon_Human target = null;

			base.cast( targets, user );

			if ( !( user is Mob_Living_Carbon_Human ) ) {
				return false;
			}

			foreach (dynamic _a in Lang13.Enumerate( targets, typeof(Mob_Living_Carbon_Human) )) {
				target = _a;
				
				user.visible_message( "<span class='sinister'>" + user.name + "'s body shifts and contorts.</span>" );
				Task13.Schedule( 10, (Task13.Closure)(() => {
					
					if ( target != null && user != null ) {
						user.UpdateAppearance( target.dna.UI );
						user.real_name = target.real_name;
						user.name = target.name;
					}
					return;
				}));
			}
			return false;
		}

	}

}