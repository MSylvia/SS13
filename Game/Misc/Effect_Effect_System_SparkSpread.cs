// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Effect_Effect_System_SparkSpread : Effect_Effect_System {

		// Function from file: effect_system.dm
		public override void start(  ) {
			ByTable directions = null;
			double i = 0;
			dynamic nextdir = null;
			Game_Data sparks = null;

			
			if ( Lang13.Bool( this.holder ) ) {
				this.location = GlobalFuncs.get_turf( this.holder );
			}

			if ( Lang13.Bool( this.cardinals ) ) {
				directions = GlobalVars.cardinal.Copy();
			} else {
				directions = GlobalVars.alldirs.Copy();
			}
			GlobalFuncs.playsound( this.location, "sparks", 100, 1 );

			foreach (dynamic _a in Lang13.IterateRange( 1, this.number )) {
				i = _a;
				
				nextdir = GlobalFuncs.pick_n_take( directions );

				if ( Lang13.Bool( nextdir ) ) {
					sparks = GlobalFuncs.getFromPool( typeof(Obj_Effect_Effect_Sparks), this.location );
					((Obj_Effect_Effect_Sparks)sparks).start( nextdir );
				}
			}
			return;
		}

		// Function from file: effect_system.dm
		public override void set_up( dynamic carry = null, dynamic n = null, dynamic c = null, dynamic loca = null, dynamic direct = null ) {
			carry = carry ?? 3;
			n = n ?? 0;

			this.number = Num13.MinInt( 10, Convert.ToInt32( carry ) );
			this.cardinals = n;

			if ( c is Tile ) {
				this.location = c;
			} else {
				this.location = GlobalFuncs.get_turf( c );
			}
			return;
		}

	}

}