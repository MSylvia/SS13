// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Spell_Targeted_EquipItem_Horsemask : Spell_Targeted_EquipItem {

		protected override void __FieldInit() {
			base.__FieldInit();

			this.name = "Curse of the Horseman";
			this.desc = "This spell triggers a curse on a target, causing them to wield an unremovable horse head mask. They will speak like a horse! Any masks they are wearing will be disintegrated. This spell does not require robes.";
			this.school = "transmutation";
			this.charge_max = 150;
			this.invocation = "KN'A FTAGHU, PUCK 'BTHNK!";
			this.invocation_type = "shout";
			this.cooldown_min = 30;
			this.selection_type = "range";
			this.compatible_mobs = new ByTable(new object [] { typeof(Mob_Living_Carbon_Human), typeof(Mob_Living_Carbon_Monkey) });
			this.hud_state = "wiz_horse";
		}

		// Function from file: horsemask.dm
		public Spell_Targeted_EquipItem_Horsemask (  ) {
			// Warning: Super call was HERE! If anything above HERE is needed by the super call, it might break!;
			this.equipped_summons = new ByTable().Set( "" + 2, typeof(Obj_Item_Clothing_Mask_Horsehead) );
			return;
		}

		// Function from file: horsemask.dm
		public override dynamic summon_item( dynamic newtype = null ) {
			dynamic new_item = null;
			dynamic magichead = null;

			new_item = Lang13.Call( newtype );

			if ( new_item is Obj_Item_Clothing_Mask_Horsehead ) {
				magichead = new_item;
				magichead.canremove = false;
				magichead.voicechange = true;
			}
			return new_item;
		}

		// Function from file: horsemask.dm
		public override bool cast( ByTable targets = null, Mob user = null ) {
			user = user ?? Task13.User;

			Mob_Living target = null;

			base.cast( targets, user );

			foreach (dynamic _a in Lang13.Enumerate( targets, typeof(Mob_Living) )) {
				target = _a;
				
				target.visible_message( "<span class='danger'>" + target + "'s face lights up in fire, and after the event a horse's head takes its place!</span>", "<span class='danger'>Your face burns up, and shortly after the fire you realise you have the face of a horse!</span>" );
				Icon13.Flick( "e_flash", target.flash );
			}
			return false;
		}

	}

}