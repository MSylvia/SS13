// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Event_MundaneNews : Event {

		protected override void __FieldInit() {
			base.__FieldInit();

			this.endWhen = 10;
		}

		public Event_MundaneNews ( Obj_Item_MechaParts_MechaEquipment_Tool_CableLayer tlistener = null, string tprocname = null ) : base( tlistener, tprocname ) {
			
		}

		// Function from file: Economy_Events_Mundane.dm
		public override void announce(  ) {
			dynamic affected_dest = null;
			dynamic event_type = null;
			FeedMessage newMsg = null;
			FeedChannel FC = null;
			Obj_Machinery_Newscaster NEWSCASTER = null;

			affected_dest = GlobalFuncs.pickweight( GlobalVars.weighted_mundaneevent_locations );
			event_type = 0;

			if ( affected_dest.viable_mundane_events.len != 0 ) {
				event_type = Rand13.PickFromTable( affected_dest.viable_mundane_events );
			}

			if ( !Lang13.Bool( event_type ) ) {
				return;
			}
			newMsg = new FeedMessage();
			newMsg.author = "Tau Ceti Daily";
			newMsg.is_admin_message = true;
			newMsg.body = ((TradeDestination)affected_dest).get_custom_eventstring();

			if ( !Lang13.Bool( newMsg.body ) ) {
				newMsg.body = "" + affected_dest.name + " doesn't have custom events.  Bug a coder.";
			}

			foreach (dynamic _a in Lang13.Enumerate( GlobalVars.news_network.network_channels, typeof(FeedChannel) )) {
				FC = _a;
				

				if ( FC.channel_name == "Tau Ceti Daily" ) {
					FC.messages.Add( newMsg );
					break;
				}
			}

			foreach (dynamic _b in Lang13.Enumerate( GlobalVars.allCasters, typeof(Obj_Machinery_Newscaster) )) {
				NEWSCASTER = _b;
				
				NEWSCASTER.newsAlert( "Tau Ceti Daily" );
			}
			return;
		}

	}

}