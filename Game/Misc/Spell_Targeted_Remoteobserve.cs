// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Spell_Targeted_Remoteobserve : Spell_Targeted {

		protected override void __FieldInit() {
			base.__FieldInit();

			this.name = "Remote View";
			this.panel = "Mutant Powers";
			this.charge_max = 50;
			this.range = -2;
			this.spell_flags = 192;
			this.override_base = "genetic";
			this.hud_state = "gen_rmind";
			this.mind_affecting = true;
		}

		// Function from file: powers.dm
		public override bool cast( ByTable targets = null, Mob user = null ) {
			Mob_Living target = null;

			
			if ( !( targets != null ) || !( targets.len != 0 ) || !( user != null ) || !( user is Mob_Living_Carbon_Human ) ) {
				return false;
			}

			if ( user.isUnconscious() ) {
				((dynamic)user).remoteview_target = null;
				user.reset_view( 0 );
				return false;
			}

			if ( user.l_hand is Obj_Item_TkGrab || user.r_hand is Obj_Item_TkGrab ) {
				GlobalFuncs.to_chat( user, "<span class='warning'>Your mind is too busy with that telekinetic grab.</span>" );
				((dynamic)user).remoteview_target = null;
				user.reset_view( 0 );
				return false;
			}

			if ( user.client.eye != user.client.mob ) {
				((dynamic)user).remoteview_target = null;
				user.reset_view( 0 );
				return false;
			}

			foreach (dynamic _a in Lang13.Enumerate( targets, typeof(Mob_Living) )) {
				target = _a;
				

				if ( target != null ) {
					
					if ( target == user ) {
						((dynamic)user).remoteview_target = null;
						user.reset_view( 0 );
					} else {
						((dynamic)user).remoteview_target = target;
						user.reset_view( target );
					}
					break;
				}
			}
			return false;
		}

	}

}