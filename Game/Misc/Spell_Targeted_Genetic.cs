// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Spell_Targeted_Genetic : Spell_Targeted {

		public bool disabilities = false;
		public ByTable mutations = new ByTable();

		protected override void __FieldInit() {
			base.__FieldInit();

			this.name = "Genetic modifier";
			this.desc = "This spell inflicts a set of mutations and disabilities upon the target.";
			this.duration = 100;
		}

		// Function from file: genetic.dm
		public override bool cast( ByTable targets = null, Mob user = null ) {
			Mob_Living target = null;
			dynamic x = null;
			dynamic x2 = null;

			base.cast( targets, user );

			foreach (dynamic _c in Lang13.Enumerate( targets, typeof(Mob_Living) )) {
				target = _c;
				

				foreach (dynamic _a in Lang13.Enumerate( this.mutations )) {
					x = _a;
					
					target.mutations.Add( x );
				}
				target.disabilities |= this.disabilities ?1:0;
				target.update_mutations();
				Task13.Schedule( this.duration ??0, (Task13.Closure)(() => {
					
					foreach (dynamic _b in Lang13.Enumerate( this.mutations )) {
						x2 = _b;
						
						target.mutations.Remove( x2 );
					}
					target.disabilities &= ~( this.disabilities ?1:0);
					target.update_mutations();
					return;
				}));
			}
			return false;
		}

	}

}