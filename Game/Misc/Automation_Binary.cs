// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Automation_Binary : Automation {

		public string v_operator = "???";

		protected override void __FieldInit() {
			base.__FieldInit();

			this.name = "binary statement";
			this.returntype = null;
			this.valid_child_returntypes = new ByTable(new object [] { 1 });
		}

		// Function from file: statements.dm
		public Automation_Binary ( Obj_Machinery_Computer_GeneralAirControl_AtmosAutomation aa = null ) : base( aa ) {
			// Warning: Super call was HERE! If anything above HERE is needed by the super call, it might break!;
			this.children = new ByTable(new object [] { null, null });
			return;
		}

		// Function from file: statements.dm
		public override dynamic Topic( string href = null, ByTable href_list = null, dynamic hclient = null, HtmlInterface currui = null ) {
			dynamic _default = null;

			double? idx = null;
			bool new_child = false;

			_default = base.Topic( href, href_list, (object)(hclient) );

			if ( Lang13.Bool( _default ) ) {
				return _default;
			}

			if ( Lang13.Bool( href_list["set_field"] ) ) {
				idx = String13.ParseNumber( href_list["set_field"] );
				new_child = this.selectValidChildFor( Task13.User );

				if ( !new_child ) {
					return 1;
				}
				this.children[idx] = new_child;
				this.parent.updateUsrDialog();
				return 1;
			}
			return _default;
		}

		// Function from file: statements.dm
		public override string GetText(  ) {
			string _default = null;

			Automation left = null;
			Automation right = null;

			left = this.children[1];
			right = this.children[2];
			_default = new Txt( "<a href=\"?src=" ).Ref( this ).str( ";set_field=1\">(Set Left)</a> (" ).ToString();

			if ( left == null ) {
				_default += "-----";
			} else {
				_default += left.GetText();
			}
			_default += new Txt( ") " ).item( this.v_operator ).str( "  <a href=\"?src=" ).Ref( this ).str( ";set_field=2\">(Set Right)</a> (" ).ToString();

			if ( right == null ) {
				_default += "-----";
			} else {
				_default += right.GetText();
			}
			_default += ")";
			return _default;
		}

		// Function from file: statements.dm
		public virtual dynamic do_operation( dynamic a = null, dynamic b = null ) {
			return 0;
		}

		// Function from file: statements.dm
		public override dynamic Evaluate(  ) {
			dynamic a = null;
			dynamic b = null;

			
			if ( this.children.len != 2 ) {
				return 0;
			}
			a = this.children[1];
			b = this.children[2];

			if ( !Lang13.Bool( a ) || !Lang13.Bool( b ) ) {
				return 0;
			}
			return this.do_operation( a.Evaluate(), b.Evaluate() );
		}

	}

}