// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Disease_Wizarditis : Disease {

		protected override void __FieldInit() {
			base.__FieldInit();

			this.name = "Wizarditis";
			this.max_stages = 4;
			this.spread_text = "Airborne";
			this.cure_text = "The Manly Dorf";
			this.cures = new ByTable(new object [] { "manlydorf" });
			this.cure_chance = 100;
			this.agent = "Rincewindus Vulgaris";
			this.viable_mobtypes = new ByTable(new object [] { typeof(Mob_Living_Carbon_Human) });
			this.permeability_mod = 0.75;
			this.desc = "Some speculate, that this virus is the cause of Wizard Federation existance. Subjects affected show the signs of mental retardation, yelling obscure sentences or total gibberish. On late stages subjects sometime express the feelings of inner power, and, cite, 'the ability to control the forces of cosmos themselves!' A gulp of strong, manly spirits usually reverts them to normal, humanlike, condition.";
			this.severity = "Harmful";
			this.required_organs = new ByTable(new object [] { typeof(Obj_Item_Organ_Limb_Head) });
		}

		// Function from file: wizarditis.dm
		public void teleport(  ) {
			ByTable theareas = null;
			Zone_Space S = null;
			dynamic thearea = null;
			ByTable L = null;
			dynamic T = null;
			bool clear = false;
			Obj O = null;

			theareas = GlobalFuncs.get_areas_in_range( 80, this.affected_mob );

			foreach (dynamic _a in Lang13.Enumerate( theareas, typeof(Zone_Space) )) {
				S = _a;
				
				theareas.Remove( S );
			}

			if ( !( theareas != null ) || !( theareas.len != 0 ) ) {
				return;
			}
			thearea = Rand13.PickFromTable( theareas );
			L = new ByTable();

			foreach (dynamic _c in Lang13.Enumerate( GlobalFuncs.get_area_turfs( thearea.type ) )) {
				T = _c;
				

				if ( T.z != this.affected_mob.z ) {
					continue;
				}

				if ( T.name == "space" ) {
					continue;
				}

				if ( !T.density ) {
					clear = true;

					foreach (dynamic _b in Lang13.Enumerate( T, typeof(Obj) )) {
						O = _b;
						

						if ( O.density ) {
							clear = false;
							break;
						}
					}

					if ( clear ) {
						L.Add( T );
					}
				}
			}

			if ( !( L != null ) ) {
				return;
			}
			((Ent_Dynamic)this.affected_mob).say( "SCYAR NILA " + String13.ToUpper( thearea.name ) + "!" );
			this.affected_mob.loc = Rand13.PickFromTable( L );
			return;
		}

		// Function from file: wizarditis.dm
		public void spawn_wizard_clothes( int? chance = null ) {
			chance = chance ?? 0;

			dynamic H = null;
			dynamic H2 = null;

			
			if ( this.affected_mob is Mob_Living_Carbon_Human ) {
				H = this.affected_mob;

				if ( Rand13.PercentChance( chance ??0 ) ) {
					
					if ( !( H.head is Obj_Item_Clothing_Head_Wizard ) ) {
						
						if ( !((Mob)H).unEquip( H.head ) ) {
							GlobalFuncs.qdel( H.head );
						}
						((Mob)H).equip_to_slot_or_del( new Obj_Item_Clothing_Head_Wizard( H ), 11 );
					}
					return;
				}

				if ( Rand13.PercentChance( chance ??0 ) ) {
					
					if ( !( H.wear_suit is Obj_Item_Clothing_Suit_Wizrobe ) ) {
						
						if ( !((Mob)H).unEquip( H.wear_suit ) ) {
							GlobalFuncs.qdel( H.wear_suit );
						}
						((Mob)H).equip_to_slot_or_del( new Obj_Item_Clothing_Suit_Wizrobe( H ), 13 );
					}
					return;
				}

				if ( Rand13.PercentChance( chance ??0 ) ) {
					
					if ( !( H.shoes is Obj_Item_Clothing_Shoes_Sandal ) ) {
						
						if ( !((Mob)H).unEquip( H.shoes ) ) {
							GlobalFuncs.qdel( H.shoes );
						}
					}
					((Mob)H).equip_to_slot_or_del( new Obj_Item_Clothing_Shoes_Sandal( H ), 12 );
					return;
				}
			} else {
				H2 = this.affected_mob;

				if ( Rand13.PercentChance( chance ??0 ) ) {
					
					if ( !( H2.r_hand is Obj_Item_Weapon_Staff ) ) {
						((Mob)H2).drop_r_hand();
						((Mob)H2).put_in_r_hand( new Obj_Item_Weapon_Staff( H2 ) );
					}
					return;
				}
			}
			return;
		}

		// Function from file: wizarditis.dm
		public override void stage_act(  ) {
			base.stage_act();

			switch ((int?)( this.stage )) {
				case 2:
					
					if ( Rand13.PercentChance( 1 ) && Rand13.PercentChance( 50 ) ) {
						((Ent_Dynamic)this.affected_mob).say( Rand13.Pick(new object [] { "You shall not pass!", "Expeliarmus!", "By Merlins beard!", "Feel the power of the Dark Side!" }) );
					}

					if ( Rand13.PercentChance( 1 ) && Rand13.PercentChance( 50 ) ) {
						this.affected_mob.WriteMsg( "<span class='danger'>You feel " + Rand13.Pick(new object [] { "that you don't have enough mana", "that the winds of magic are gone", "an urge to summon familiar" }) + ".</span>" );
					}
					break;
				case 3:
					
					if ( Rand13.PercentChance( 1 ) && Rand13.PercentChance( 50 ) ) {
						((Ent_Dynamic)this.affected_mob).say( Rand13.Pick(new object [] { "NEC CANTIO!", "AULIE OXIN FIERA!", "STI KALY!", "TARCOL MINTI ZHERI!" }) );
					}

					if ( Rand13.PercentChance( 1 ) && Rand13.PercentChance( 50 ) ) {
						this.affected_mob.WriteMsg( "<span class='danger'>You feel " + Rand13.Pick(new object [] { "the magic bubbling in your veins", "that this location gives you a +1 to INT", "an urge to summon familiar" }) + ".</span>" );
					}
					break;
				case 4:
					
					if ( Rand13.PercentChance( 1 ) ) {
						((Ent_Dynamic)this.affected_mob).say( Rand13.Pick(new object [] { "NEC CANTIO!", "AULIE OXIN FIERA!", "STI KALY!", "EI NATH!" }) );
						return;
					}

					if ( Rand13.PercentChance( 1 ) && Rand13.PercentChance( 50 ) ) {
						this.affected_mob.WriteMsg( "<span class='danger'>You feel " + Rand13.Pick(new object [] { "the tidal wave of raw power building inside", "that this location gives you a +2 to INT and +1 to WIS", "an urge to teleport" }) + ".</span>" );
						this.spawn_wizard_clothes( 50 );
					}

					if ( Rand13.PercentChance( 1 ) && Rand13.PercentChance( 1 ) ) {
						this.teleport();
					}
					break;
			}
			return;
		}

	}

}