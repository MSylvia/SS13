// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class UplinkItem : Game_Data {

		public string name = "item name";
		public string category = "item category";
		public string desc = "item description";
		public dynamic item = null;
		public int cost = 0;
		public bool refundable = false;
		public int surplus = 100;
		public ByTable include_modes = new ByTable();
		public ByTable exclude_modes = new ByTable();

		// Function from file: uplink_item.dm
		public bool buy( Mob user = null, Obj_Item_Device_Uplink U = null ) {
			dynamic A = null;
			dynamic B = null;
			Obj_Item I = null;
			Mob H = null;

			
			if ( !( U is Obj_Item_Device_Uplink ) ) {
				return false;
			}

			if ( !( user != null ) || user.incapacitated() ) {
				return false;
			}

			if ( Convert.ToDouble( U.telecrystals ) < this.cost ) {
				return false;
			} else {
				U.telecrystals -= this.cost;
				U.spent_telecrystals += this.cost;
			}
			A = this.spawn_item( GlobalFuncs.get_turf( user ), U );
			B = A;

			if ( B is Obj_Item_Weapon_Storage_Box && B.contents.len > 0 ) {
				
				foreach (dynamic _a in Lang13.Enumerate( B, typeof(Obj_Item) )) {
					I = _a;
					
					U.purchase_log += new Txt( "<big>" ).icon( I ).str( "</big>" ).ToString();
				}
			} else {
				U.purchase_log += new Txt( "<big>" ).icon( A ).str( "</big>" ).ToString();
			}

			if ( user is Mob_Living_Carbon_Human && A is Obj_Item ) {
				H = user;

				if ( H.put_in_hands( A ) ) {
					H.WriteMsg( "" + A + " materializes into your hands!" );
				} else {
					H.WriteMsg( new Txt().The( A ).item().str( " materializes onto the floor." ).ToString() );
				}
			}
			return true;
		}

		// Function from file: uplink_item.dm
		public virtual dynamic spawn_item( dynamic loc = null, Obj_Item_Device_Uplink U = null ) {
			
			if ( Lang13.Bool( this.item ) ) {
				GlobalFuncs.feedback_add_details( "traitor_uplink_items_bought", "" + this.item );
				return Lang13.Call( this.item, loc );
			}
			return null;
		}

	}

}