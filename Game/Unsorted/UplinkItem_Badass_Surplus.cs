// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class UplinkItem_Badass_Surplus : UplinkItem_Badass {

		protected override void __FieldInit() {
			base.__FieldInit();

			this.name = "Syndicate Surplus Crate";
			this.desc = "A dusty crate from the back of the Syndicate warehouse. Rumored to contain a valuable assortion of items, but you never know. Contents are sorted to always be worth 50 TC.";
			this.item = typeof(Obj_Structure_Closet_Crate);
			this.cost = 20;
			this.exclude_modes = new ByTable(new object [] { typeof(GameMode_Nuclear), typeof(GameMode_Gang) });
		}

		// Function from file: uplink_item.dm
		public override dynamic spawn_item( dynamic loc = null, Obj_Item_Device_Uplink U = null ) {
			ByTable uplink_items = null;
			double crate_value = 0;
			Obj_Structure_Closet_Crate C = null;
			dynamic category = null;
			dynamic item = null;
			dynamic I = null;

			uplink_items = GlobalFuncs.get_uplink_items();
			crate_value = 50;
			C = new Obj_Structure_Closet_Crate( loc );

			while (crate_value != 0) {
				category = Rand13.PickFromTable( uplink_items );
				item = Rand13.PickFromTable( uplink_items[category] );
				I = uplink_items[category][item];

				if ( !Lang13.Bool( I.surplus ) || Rand13.PercentChance( ((int)( 100 - Convert.ToDouble( I.surplus ) )) ) ) {
					continue;
				}

				if ( crate_value < Convert.ToDouble( I.cost ) ) {
					continue;
				}
				crate_value -= Convert.ToDouble( I.cost );
				Lang13.Call( I.item, C );
				U.purchase_log += new Txt( "<big>" ).icon( I.item ).str( "</big>" ).ToString();
			}
			return C;
		}

	}

}