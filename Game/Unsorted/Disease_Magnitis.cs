// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Disease_Magnitis : Disease {

		protected override void __FieldInit() {
			base.__FieldInit();

			this.name = "Magnitis";
			this.max_stages = 4;
			this.spread_text = "Airborne";
			this.cure_text = "Iron";
			this.cures = new ByTable(new object [] { "iron" });
			this.agent = "Fukkos Miracos";
			this.viable_mobtypes = new ByTable(new object [] { typeof(Mob_Living_Carbon_Human) });
			this.permeability_mod = 0.75;
			this.desc = "This disease disrupts the magnetic field of your body, making it act as if a powerful magnet. Injections of iron help stabilize the field.";
			this.severity = "Medium";
		}

		// Function from file: tgstation.dme
		public override void stage_act(  ) {
			Obj M = null;
			Mob_Living_Silicon S = null;
			Obj M2 = null;
			int? i = null;
			int? iter = null;
			Mob_Living_Silicon S2 = null;
			int? i2 = null;
			int? iter2 = null;
			Obj M3 = null;
			int? i3 = null;
			int? iter3 = null;
			Mob_Living_Silicon S3 = null;
			int? i4 = null;
			int? iter4 = null;

			base.stage_act();

			switch ((int?)( this.stage )) {
				case 2:
					
					if ( Rand13.PercentChance( 2 ) ) {
						this.affected_mob.WriteMsg( "<span class='danger'>You feel a slight shock course through your body.</span>" );
					}

					if ( Rand13.PercentChance( 2 ) ) {
						
						foreach (dynamic _a in Lang13.Enumerate( Map13.FetchInRangeExcludeThis( this.affected_mob, 2 ), typeof(Obj) )) {
							M = _a;
							

							if ( !Lang13.Bool( M.anchored ) && Lang13.Bool( M.flags & 64 ) ) {
								Map13.StepTowardsSimple( M, this.affected_mob );
							}
						}

						foreach (dynamic _b in Lang13.Enumerate( Map13.FetchInRangeExcludeThis( this.affected_mob, 2 ), typeof(Mob_Living_Silicon) )) {
							S = _b;
							

							if ( S is Mob_Living_Silicon_Ai ) {
								continue;
							}
							Map13.StepTowardsSimple( S, this.affected_mob );
						}
					}
					break;
				case 3:
					
					if ( Rand13.PercentChance( 2 ) ) {
						this.affected_mob.WriteMsg( "<span class='danger'>You feel a strong shock course through your body.</span>" );
					}

					if ( Rand13.PercentChance( 2 ) ) {
						this.affected_mob.WriteMsg( "<span class='danger'>You feel like clowning around.</span>" );
					}

					if ( Rand13.PercentChance( 4 ) ) {
						
						foreach (dynamic _c in Lang13.Enumerate( Map13.FetchInRangeExcludeThis( this.affected_mob, 4 ), typeof(Obj) )) {
							M2 = _c;
							

							if ( !Lang13.Bool( M2.anchored ) && Lang13.Bool( M2.flags & 64 ) ) {
								i = null;
								iter = Rand13.Int( 1, 2 );
								i = 0;

								while (( i ??0) < ( iter ??0)) {
									Map13.StepTowardsSimple( M2, this.affected_mob );
									i++;
								}
							}
						}

						foreach (dynamic _d in Lang13.Enumerate( Map13.FetchInRangeExcludeThis( this.affected_mob, 4 ), typeof(Mob_Living_Silicon) )) {
							S2 = _d;
							

							if ( S2 is Mob_Living_Silicon_Ai ) {
								continue;
							}
							i2 = null;
							iter2 = Rand13.Int( 1, 2 );
							i2 = 0;

							while (( i2 ??0) < ( iter2 ??0)) {
								Map13.StepTowardsSimple( S2, this.affected_mob );
								i2++;
							}
						}
					}
					break;
				case 4:
					
					if ( Rand13.PercentChance( 2 ) ) {
						this.affected_mob.WriteMsg( "<span class='danger'>You feel a powerful shock course through your body.</span>" );
					}

					if ( Rand13.PercentChance( 2 ) ) {
						this.affected_mob.WriteMsg( "<span class='danger'>You query upon the nature of miracles.</span>" );
					}

					if ( Rand13.PercentChance( 8 ) ) {
						
						foreach (dynamic _e in Lang13.Enumerate( Map13.FetchInRangeExcludeThis( this.affected_mob, 6 ), typeof(Obj) )) {
							M3 = _e;
							

							if ( !Lang13.Bool( M3.anchored ) && Lang13.Bool( M3.flags & 64 ) ) {
								i3 = null;
								iter3 = Rand13.Int( 1, 3 );
								i3 = 0;

								while (( i3 ??0) < ( iter3 ??0)) {
									Map13.StepTowardsSimple( M3, this.affected_mob );
									i3++;
								}
							}
						}

						foreach (dynamic _f in Lang13.Enumerate( Map13.FetchInRangeExcludeThis( this.affected_mob, 6 ), typeof(Mob_Living_Silicon) )) {
							S3 = _f;
							

							if ( S3 is Mob_Living_Silicon_Ai ) {
								continue;
							}
							i4 = null;
							iter4 = Rand13.Int( 1, 3 );
							i4 = 0;

							while (( i4 ??0) < ( iter4 ??0)) {
								Map13.StepTowardsSimple( S3, this.affected_mob );
								i4++;
							}
						}
					}
					break;
			}
			return;
		}

	}

}