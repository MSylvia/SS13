// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class SurgeryStep_RemoveObject : SurgeryStep {

		public dynamic L = null;

		protected override void __FieldInit() {
			base.__FieldInit();

			this.name = "remove embedded objects";
			this.time = 32;
			this.accept_hand = true;
		}

		// Function from file: remove_embedded_object.dm
		public override bool success( dynamic user = null, Mob target = null, string target_zone = null, dynamic tool = null, Surgery surgery = null ) {
			Mob H = null;
			int objects = 0;
			Obj_Item I = null;

			
			if ( Lang13.Bool( this.L ) ) {
				
				if ( target is Mob_Living_Carbon_Human ) {
					H = target;
					objects = 0;

					foreach (dynamic _a in Lang13.Enumerate( this.L.embedded_objects, typeof(Obj_Item) )) {
						I = _a;
						
						objects++;
						I.loc = GlobalFuncs.get_turf( H );
						this.L.embedded_objects.Remove( I );
					}

					if ( objects > 0 ) {
						((Ent_Static)user).visible_message( "" + user + " sucessfully removes " + objects + " objects from " + H + "'s " + ((Obj_Item_Organ_Limb)this.L).getDisplayName() + "!", "<span class='notice'>You sucessfully remove " + objects + " objects from " + H + "'s " + ((Obj_Item_Organ_Limb)this.L).getDisplayName() + ".</span>" );
					} else {
						user.WriteMsg( "<span class='warning'>You find no objects embedded in " + H + "'s " + ((Obj_Item_Organ_Limb)this.L).getDisplayName() + "!</span>" );
					}
				}
			} else {
				user.WriteMsg( "<span class='warning'>You can't find " + target + "'s " + GlobalFuncs.parse_zone( user.zone_selected ) + ", let alone any objects embedded in it!</span>" );
			}
			return true;
		}

		// Function from file: remove_embedded_object.dm
		public override int preop( dynamic user = null, Mob target = null, string target_zone = null, dynamic tool = null, Surgery surgery = null ) {
			this.L = surgery.organ;

			if ( Lang13.Bool( this.L ) ) {
				((Ent_Static)user).visible_message( "" + user + " looks for objects embedded in " + target + "'s " + GlobalFuncs.parse_zone( user.zone_selected ) + ".", "<span class='notice'>You look for objects embedded in " + target + "'s " + GlobalFuncs.parse_zone( user.zone_selected ) + "...</span>" );
			} else {
				((Ent_Static)user).visible_message( "" + user + " looks for " + target + "'s " + GlobalFuncs.parse_zone( user.zone_selected ) + ".", "<span class='notice'>You look for " + target + "'s " + GlobalFuncs.parse_zone( user.zone_selected ) + "...</span>" );
			}
			return 0;
		}

	}

}