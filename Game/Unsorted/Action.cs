// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Action : Game_Data {

		public string name = "Generic Action";
		public dynamic target = null;
		public int check_flags = 0;
		public bool processing = false;
		public Obj_Screen_Movable_ActionButton button = null;
		public string button_icon = "icons/mob/actions.dmi";
		public string button_icon_state = "default";
		public string background_icon_state = "bg_default";
		public dynamic owner = null;

		// Function from file: action.dm
		public Action ( Obj_Item_Weapon_Tank Target = null ) {
			this.target = Target;
			return;
		}

		// Function from file: action.dm
		public virtual void ApplyIcon( Obj_Screen_Movable_ActionButton current_button = null ) {
			Image img = null;

			current_button.overlays.Cut();

			if ( Lang13.Bool( this.button_icon ) && Lang13.Bool( this.button_icon_state ) ) {
				img = new Image( this.button_icon, current_button, this.button_icon_state );
				img.pixel_x = 0;
				img.pixel_y = 0;
				current_button.overlays.Add( img );
			}
			return;
		}

		// Function from file: action.dm
		public virtual string UpdateName(  ) {
			return this.name;
		}

		// Function from file: action.dm
		public bool Checks(  ) {
			
			if ( !Lang13.Bool( this.owner ) ) {
				return false;
			}

			if ( ( this.check_flags & 1 ) != 0 ) {
				
				if ( ((Mob)this.owner).restrained() ) {
					return false;
				}
			}

			if ( ( this.check_flags & 2 ) != 0 ) {
				
				if ( this.owner.stunned != 0 ) {
					return false;
				}
			}

			if ( ( this.check_flags & 4 ) != 0 ) {
				
				if ( Lang13.Bool( this.owner.lying ) ) {
					return false;
				}
			}

			if ( ( this.check_flags & 8 ) != 0 ) {
				
				if ( Lang13.Bool( this.owner.stat ) ) {
					return false;
				}
			}

			if ( ( this.check_flags & 16 ) != 0 ) {
				
				if ( !Lang13.Bool( this.owner.Contains( this.target ) ) && !this.target.action_button_internal ) {
					return false;
				}
			}
			return true;
		}

		// Function from file: action.dm
		public virtual dynamic IsAvailable(  ) {
			return this.Checks();
		}

		// Function from file: action.dm
		public virtual bool CheckRemoval( dynamic user = null ) {
			return false;
		}

		// Function from file: action.dm
		public void Process(  ) {
			return;
		}

		// Function from file: action.dm
		public virtual bool Trigger(  ) {
			
			if ( !this.Checks() ) {
				return false;
			}
			return true;
		}

		// Function from file: action.dm
		public virtual void Remove( dynamic T = null ) {
			
			if ( this.button != null ) {
				
				if ( Lang13.Bool( T.client ) ) {
					T.client.screen -= this.button;
				}
				GlobalFuncs.qdel( this.button );
				this.button = null;
			}
			T.actions.Remove( this );
			((Mob)T).update_action_buttons();
			this.owner = null;
			return;
		}

		// Function from file: action.dm
		public virtual void Grant( dynamic T = null ) {
			
			if ( Lang13.Bool( this.owner ) ) {
				
				if ( this.owner == T ) {
					return;
				}
				this.Remove( this.owner );
			}
			this.owner = T;
			T.actions.Add( this );
			((Mob)T).update_action_buttons();
			return;
		}

		// Function from file: action.dm
		public override dynamic Destroy(  ) {
			
			if ( Lang13.Bool( this.owner ) ) {
				this.Remove( this.owner );
			}
			return base.Destroy();
		}

	}

}