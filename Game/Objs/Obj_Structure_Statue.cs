// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Structure_Statue : Obj_Structure {

		public double hardness = 1;
		public int? oreAmount = 7;
		public string mineralType = "metal";

		protected override void __FieldInit() {
			base.__FieldInit();

			this.icon = "icons/obj/statue.dmi";
		}

		public Obj_Structure_Statue ( dynamic loc = null ) : base( (object)(loc) ) {
			
		}

		// Function from file: statues.dm
		public override bool ex_act( double? severity = null, dynamic target = null ) {
			severity = severity ?? 1;

			
			switch ((int?)( severity )) {
				case 1:
					this.Dismantle( true );
					break;
				case 2:
					
					if ( Rand13.PercentChance( 20 ) ) {
						this.Dismantle( true );
					} else {
						this.hardness--;
						this.CheckHardness();
					}
					break;
				case 3:
					this.hardness -= 0.1;
					this.CheckHardness();
					break;
			}
			return false;
		}

		// Function from file: statues.dm
		public void Dismantle( bool? devastated = null ) {
			devastated = devastated ?? false;

			Type ore = null;
			int? i = null;
			Type ore2 = null;
			int? i2 = null;
			Type ore3 = null;
			int? i3 = null;
			Type ore4 = null;
			int? i4 = null;

			
			if ( !( devastated == true ) ) {
				
				if ( this.mineralType == "metal" ) {
					ore = typeof(Obj_Item_Stack_Sheet_Metal);
					i = null;
					i = 1;

					while (( i ??0) <= ( this.oreAmount ??0)) {
						Lang13.Call( ore, GlobalFuncs.get_turf( this ) );
						i++;
					}
				} else {
					ore2 = Lang13.FindClass( "/obj/item/stack/sheet/mineral/" + this.mineralType );
					i2 = null;
					i2 = 1;

					while (( i2 ??0) <= ( this.oreAmount ??0)) {
						Lang13.Call( ore2, GlobalFuncs.get_turf( this ) );
						i2++;
					}
				}
			} else if ( this.mineralType == "metal" ) {
				ore3 = typeof(Obj_Item_Stack_Sheet_Metal);
				i3 = null;
				i3 = 3;

				while (( i3 ??0) <= ( this.oreAmount ??0)) {
					Lang13.Call( ore3, GlobalFuncs.get_turf( this ) );
					i3++;
				}
			} else {
				ore4 = Lang13.FindClass( "/obj/item/stack/sheet/mineral/" + this.mineralType );
				i4 = null;
				i4 = 3;

				while (( i4 ??0) <= ( this.oreAmount ??0)) {
					Lang13.Call( ore4, GlobalFuncs.get_turf( this ) );
					i4++;
				}
			}
			GlobalFuncs.qdel( this );
			return;
		}

		// Function from file: statues.dm
		public void CheckHardness(  ) {
			
			if ( this.hardness <= 0 ) {
				this.Dismantle( true );
			}
			return;
		}

		// Function from file: statues.dm
		public override dynamic bullet_act( dynamic P = null, dynamic def_zone = null ) {
			this.hardness -= Convert.ToDouble( P.damage );
			base.bullet_act( (object)(P), (object)(def_zone) );
			this.CheckHardness();
			return null;
		}

		// Function from file: statues.dm
		public override bool CanAtmosPass( dynamic T = null ) {
			return !this.density;
		}

		// Function from file: statues.dm
		public override dynamic attack_hand( dynamic a = null, bool? b = null, bool? c = null ) {
			((Mob)a).changeNext_move( 8 );
			this.add_fingerprint( a );
			((Ent_Static)a).visible_message( "" + a + " rubs some dust off from the " + this.name + "'s surface.", "<span class='notice'>You rub some dust off from the " + this.name + "'s surface.</span>" );
			return null;
		}

		// Function from file: statues.dm
		public override dynamic attackby( dynamic A = null, dynamic user = null, string _params = null, bool? silent = null, bool? replace_spent = null ) {
			dynamic D = null;

			this.add_fingerprint( user );
			((Mob)user).changeNext_move( 8 );

			if ( A is Obj_Item_Weapon_Wrench ) {
				
				if ( Lang13.Bool( this.anchored ) ) {
					GlobalFuncs.playsound( this.loc, "sound/items/ratchet.ogg", 100, 1 );
					((Ent_Static)user).visible_message( "" + user + " is loosening the " + this.name + "'s bolts.", "<span class='notice'>You are loosening the " + this.name + "'s bolts...</span>" );

					if ( GlobalFuncs.do_after( user, 40 / A.toolspeed, null, this ) ) {
						
						if ( !( this.loc != null ) || !Lang13.Bool( this.anchored ) ) {
							return null;
						}
						((Ent_Static)user).visible_message( "" + user + " loosened the " + this.name + "'s bolts!", "<span class='notice'>You loosen the " + this.name + "'s bolts!</span>" );
						this.anchored = 0;
					}
				} else {
					
					if ( !( this.loc is Tile_Simulated_Floor ) ) {
						((Ent_Static)user).visible_message( "<span class='warning'>A floor must be present to secure the " + this.name + "!</span>" );
						return null;
					}
					GlobalFuncs.playsound( this.loc, "sound/items/ratchet.ogg", 100, 1 );
					((Ent_Static)user).visible_message( "" + user + " is securing the " + this.name + "'s bolts...", "<span class='notice'>You are securing the " + this.name + "'s bolts...</span>" );

					if ( GlobalFuncs.do_after( user, 40 / A.toolspeed, null, this ) ) {
						
						if ( !( this.loc != null ) || Lang13.Bool( this.anchored ) ) {
							return null;
						}
						((Ent_Static)user).visible_message( "" + user + " has secured the " + this.name + "'s bolts.", "<span class='notice'>You have secured the " + this.name + "'s bolts.</span>" );
						this.anchored = 1;
					}
				}
			} else if ( A is Obj_Item_Weapon_Gun_Energy_Plasmacutter ) {
				GlobalFuncs.playsound( this, "sound/items/welder.ogg", 100, 1 );
				((Ent_Static)user).visible_message( "" + user + " is slicing apart the " + this.name + "...", "<span class='notice'>You are slicing apart the " + this.name + "...</span>" );

				if ( GlobalFuncs.do_after( user, 30, null, this ) ) {
					
					if ( !( this.loc != null ) ) {
						return null;
					}
					((Ent_Static)user).visible_message( "" + user + " slices apart the " + this.name + ".", "<span class='notice'>You slice apart the " + this.name + ".</span>" );
					this.Dismantle( true );
				}
			} else if ( A is Obj_Item_Weapon_Pickaxe_Drill_Jackhammer ) {
				D = A;

				if ( !( this.loc != null ) ) {
					return null;
				}
				((Ent_Static)user).visible_message( "" + user + " destroys the " + this.name + "!", "<span class='notice'>You destroy the " + this.name + ".</span>" );
				((Obj_Item_Weapon_Pickaxe)D).playDigSound();
				GlobalFuncs.qdel( this );
			} else if ( A is Obj_Item_Weapon_Weldingtool && !Lang13.Bool( this.anchored ) ) {
				GlobalFuncs.playsound( this.loc, "sound/items/welder.ogg", 40, 1 );
				((Ent_Static)user).visible_message( "" + user + " is slicing apart the " + this.name + ".", "<span class='notice'>You are slicing apart the " + this.name + "...</span>" );

				if ( GlobalFuncs.do_after( user, 40 / A.toolspeed, null, this ) ) {
					
					if ( !( this.loc != null ) ) {
						return null;
					}
					GlobalFuncs.playsound( this.loc, "sound/items/welder2.ogg", 50, 1 );
					((Ent_Static)user).visible_message( "" + user + " slices apart the " + this.name + ".", "<span class='notice'>You slice apart the " + this.name + "!</span>" );
					this.Dismantle( true );
				}
			} else {
				this.hardness -= Convert.ToDouble( A.force / 100 );
				base.attackby( (object)(A), (object)(user), _params, silent, replace_spent );
				this.CheckHardness();
			}
			return null;
		}

		// Function from file: statues.dm
		public override dynamic Destroy(  ) {
			this.density = false;
			return base.Destroy();
		}

	}

}