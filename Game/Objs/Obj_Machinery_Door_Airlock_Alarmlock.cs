// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Machinery_Door_Airlock_Alarmlock : Obj_Machinery_Door_Airlock {

		public RadioFrequency air_connection = null;
		public double air_frequency = 1437;

		protected override void __FieldInit() {
			base.__FieldInit();

			this.glass = true;
			this.icon = "icons/obj/doors/Doorglass.dmi";
		}

		// Function from file: alarmlock.dm
		public Obj_Machinery_Door_Airlock_Alarmlock ( dynamic loc = null ) : base( (object)(loc) ) {
			// Warning: Super call was HERE! If anything above HERE is needed by the super call, it might break!;
			this.air_connection = new RadioFrequency();
			return;
		}

		// Function from file: alarmlock.dm
		public override bool receive_signal( Game_Data signal = null, bool? receive_method = null, dynamic receive_param = null ) {
			string alarm_area = null;
			dynamic alert = null;
			dynamic our_area = null;

			base.receive_signal( signal, receive_method, (object)(receive_param) );

			if ( ( this.stat & 3 ) != 0 ) {
				return false;
			}
			alarm_area = ((dynamic)signal).data["zone"];
			alert = ((dynamic)signal).data["alert"];
			our_area = GlobalFuncs.get_area( this );

			if ( alarm_area == our_area.name ) {
				
				dynamic _a = alert; // Was a switch-case, sorry for the mess.
				if ( _a=="severe" ) {
					this.autoclose = true;
					this.close();
				} else if ( _a=="minor" || _a=="clear" ) {
					this.autoclose = false;
					this.open();
				}
			}
			return false;
		}

		// Function from file: alarmlock.dm
		public override bool initialize( bool? suppress_icon_check = null ) {
			base.initialize( suppress_icon_check );
			GlobalVars.radio_controller.remove_object( this, this.air_frequency );
			this.air_connection = GlobalVars.radio_controller.add_object( this, this.air_frequency, GlobalVars.RADIO_TO_AIRALARM );
			this.open();
			return false;
		}

	}

}