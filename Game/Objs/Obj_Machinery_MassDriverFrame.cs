// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Machinery_MassDriverFrame : Obj_Machinery {

		public int build = 0;

		protected override void __FieldInit() {
			base.__FieldInit();

			this.icon_state = "mass_driver_b0";
		}

		public Obj_Machinery_MassDriverFrame ( dynamic loc = null ) : base( (object)(loc) ) {
			
		}

		// Function from file: mass_driver.dm
		public override bool? update_icon( dynamic location = null, dynamic target = null ) {
			this.icon_state = "mass_driver_b" + this.build;
			return null;
		}

		// Function from file: mass_driver.dm
		public override dynamic attackby( dynamic a = null, dynamic b = null, dynamic c = null ) {
			dynamic WT = null;
			dynamic WT2 = null;
			dynamic WT3 = null;
			dynamic C = null;
			dynamic R = null;
			Obj_Machinery_MassDriver M = null;

			
			switch ((int)( this.build )) {
				case 0:
					
					if ( a is Obj_Item_Weapon_Weldingtool ) {
						WT = a;

						if ( !Lang13.Bool( WT.remove_fuel( 0, b ) ) ) {
							GlobalFuncs.to_chat( b, "The welding tool must be on to complete this task." );
							return 1;
						}
						GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/items/welder.ogg", 50, 1 );
						GlobalFuncs.to_chat( b, "You begin to cut the frame apart..." );

						if ( GlobalFuncs.do_after( b, this, 30 ) && this.build == 0 ) {
							GlobalFuncs.to_chat( b, "<span class='notice'>You detach the plasteel sheets from each others.</span>" );
							new Obj_Item_Stack_Sheet_Plasteel( GlobalFuncs.get_turf( this ), 3 );
							GlobalFuncs.qdel( this );
						}
						return 1;
					}

					if ( a is Obj_Item_Weapon_Wrench ) {
						GlobalFuncs.to_chat( b, new Txt( "You begin to anchor " ).the( this ).item().str( " on the floor." ).ToString() );
						GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/items/Ratchet.ogg", 50, 1 );

						if ( GlobalFuncs.do_after( b, this, 10 ) && this.build == 0 ) {
							GlobalFuncs.to_chat( b, new Txt( "<span class='notice'>You anchor " ).the( this ).item().str( "!</span>" ).ToString() );
							this.anchored = 1;
							this.build++;
							this.update_icon();
						}
						return 1;
					}
					break;
				case 1:
					
					if ( a is Obj_Item_Weapon_Wrench ) {
						GlobalFuncs.to_chat( b, new Txt( "You begin to de-anchor " ).the( this ).item().str( " from the floor." ).ToString() );
						GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/items/Ratchet.ogg", 50, 1 );

						if ( GlobalFuncs.do_after( b, this, 10 ) && this.build == 1 ) {
							this.build--;
							this.update_icon();
							this.anchored = 0;
							GlobalFuncs.to_chat( b, new Txt( "<span class='notice'>You de-anchored " ).the( this ).item().str( "!</span>" ).ToString() );
						}
						return 1;
					}

					if ( a is Obj_Item_Weapon_Weldingtool ) {
						WT2 = a;

						if ( !Lang13.Bool( WT2.remove_fuel( 0, b ) ) ) {
							GlobalFuncs.to_chat( b, "The welding tool must be on to complete this task." );
							return 1;
						}
						GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/items/welder.ogg", 50, 1 );
						GlobalFuncs.to_chat( b, new Txt( "You begin to weld " ).the( this ).item().str( " to the floor..." ).ToString() );

						if ( GlobalFuncs.do_after( b, this, 40 ) && this.build == 1 ) {
							GlobalFuncs.to_chat( b, new Txt( "<span class='notice'>You welded " ).the( this ).item().str( " to the floor.</span>" ).ToString() );
							this.build++;
							this.update_icon();
						}
						return 1;
					}
					break;
				case 2:
					
					if ( a is Obj_Item_Weapon_Weldingtool ) {
						WT3 = a;

						if ( !Lang13.Bool( WT3.remove_fuel( 0, b ) ) ) {
							GlobalFuncs.to_chat( b, "The welding tool must be on to complete this task." );
							return 1;
						}
						GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/items/welder.ogg", 50, 1 );
						GlobalFuncs.to_chat( b, new Txt( "You begin to unweld " ).the( this ).item().str( " to the floor..." ).ToString() );

						if ( GlobalFuncs.do_after( b, this, 40 ) && this.build == 2 ) {
							GlobalFuncs.to_chat( b, new Txt( "<span class='notice'>You unwelded " ).the( this ).item().str( " to the floor.</span>" ).ToString() );
							this.build--;
							this.update_icon();
						}
					}

					if ( a is Obj_Item_Stack_CableCoil ) {
						C = a;
						GlobalFuncs.to_chat( b, new Txt( "You start adding cables to " ).the( this ).item().str( "..." ).ToString() );
						GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/items/Deconstruct.ogg", 50, 1 );

						if ( GlobalFuncs.do_after( b, this, 20 ) && Convert.ToDouble( C.amount ) >= 3 && this.build == 2 ) {
							C.use( 3 );
							GlobalFuncs.to_chat( b, new Txt( "<span class='notice'>You've added cables to " ).the( this ).item().str( ".</span>" ).ToString() );
							this.build++;
							this.update_icon();
						}
					}
					break;
				case 3:
					
					if ( a is Obj_Item_Weapon_Wirecutters ) {
						GlobalFuncs.to_chat( b, new Txt( "You begin to remove the wiring from " ).the( this ).item().str( "." ).ToString() );

						if ( GlobalFuncs.do_after( b, this, 10 ) && this.build == 3 ) {
							new Obj_Item_Stack_CableCoil( this.loc, 3 );
							GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/items/Wirecutter.ogg", 50, 1 );
							GlobalFuncs.to_chat( b, new Txt( "<span class='notice'>You've removed the cables from " ).the( this ).item().str( ".</span>" ).ToString() );
							this.build--;
							this.update_icon();
						}
						return 1;
					}

					if ( a is Obj_Item_Stack_Rods ) {
						R = a;
						GlobalFuncs.to_chat( b, new Txt( "You begin to complete " ).the( this ).item().str( "..." ).ToString() );
						GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/items/Deconstruct.ogg", 50, 1 );

						if ( GlobalFuncs.do_after( b, this, 20 ) && Convert.ToDouble( R.amount ) >= 3 && this.build == 3 ) {
							R.use( 3 );
							GlobalFuncs.to_chat( b, new Txt( "<span class='notice'>You've added the grille to " ).the( this ).item().str( ".</span>" ).ToString() );
							this.build++;
							this.update_icon();
						}
						return 1;
					}
					break;
				case 4:
					
					if ( a is Obj_Item_Weapon_Crowbar ) {
						GlobalFuncs.to_chat( b, new Txt( "You begin to pry off the grille from " ).the( this ).item().str( "..." ).ToString() );
						GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/items/Crowbar.ogg", 50, 1 );

						if ( GlobalFuncs.do_after( b, this, 30 ) && this.build == 4 ) {
							new Obj_Item_Stack_Rods( this.loc, 2 );
							this.build--;
							this.update_icon();
						}
						return 1;
					}

					if ( a is Obj_Item_Weapon_Screwdriver ) {
						GlobalFuncs.to_chat( b, "You finalize the Mass Driver..." );
						GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/items/Screwdriver.ogg", 50, 1 );
						M = new Obj_Machinery_MassDriver( GlobalFuncs.get_turf( this ) );
						M.dir = this.dir;
						GlobalFuncs.qdel( this );
						return 1;
					}
					break;
			}
			base.attackby( (object)(a), (object)(b), (object)(c) );
			return null;
		}

		// Function from file: mass_driver.dm
		[Verb]
		[VerbInfo( name: "Rotate Frame", group: "Object", access: VerbAccess.InView, range: 1 )]
		public void rotate(  ) {
			
			if ( Task13.User.isUnconscious() || Task13.User.restrained() ) {
				return;
			}
			this.dir = Num13.Rotate( this.dir, -90 );
			return;
		}

	}

}