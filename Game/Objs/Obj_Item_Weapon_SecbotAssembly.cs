// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Item_Weapon_SecbotAssembly : Obj_Item_Weapon {

		public int build_step = 0;
		public string created_name = "Securitron";

		protected override void __FieldInit() {
			base.__FieldInit();

			this.item_state = "helmet";
			this.icon = "icons/obj/aibots.dmi";
			this.icon_state = "helmet_signaler";
		}

		public Obj_Item_Weapon_SecbotAssembly ( dynamic loc = null ) : base( (object)(loc) ) {
			
		}

		// Function from file: construction.dm
		public override dynamic attackby( dynamic A = null, dynamic user = null, string _params = null, bool? silent = null, bool? replace_spent = null ) {
			dynamic WT = null;
			dynamic WT2 = null;
			Mob_Living_SimpleAnimal_Bot_Secbot S = null;
			string t = null;

			base.attackby( (object)(A), (object)(user), _params, silent, replace_spent );

			if ( A is Obj_Item_Weapon_Weldingtool ) {
				
				if ( !( this.build_step != 0 ) ) {
					WT = A;

					if ( ((Obj_Item_Weapon_Weldingtool)WT).remove_fuel( 0, user ) ) {
						this.build_step++;
						this.overlays.Add( "hs_hole" );
						user.WriteMsg( "<span class='notice'>You weld a hole in " + this + "!</span>" );
					}
				} else if ( this.build_step == 1 ) {
					WT2 = A;

					if ( ((Obj_Item_Weapon_Weldingtool)WT2).remove_fuel( 0, user ) ) {
						this.build_step--;
						this.overlays.Remove( "hs_hole" );
						user.WriteMsg( "<span class='notice'>You weld the hole in " + this + " shut!</span>" );
					}
				}
			} else if ( A is Obj_Item_Device_Assembly_ProxSensor && this.build_step == 1 ) {
				
				if ( !((Mob)user).unEquip( A ) ) {
					return null;
				}
				this.build_step++;
				user.WriteMsg( "<span class='notice'>You add the prox sensor to " + this + "!</span>" );
				this.overlays.Add( "hs_eye" );
				this.name = "helmet/signaler/prox sensor assembly";
				GlobalFuncs.qdel( A );
			} else if ( ( A is Obj_Item_RobotParts_LArm || A is Obj_Item_RobotParts_RArm ) && this.build_step == 2 ) {
				
				if ( !((Mob)user).unEquip( A ) ) {
					return null;
				}
				this.build_step++;
				user.WriteMsg( "<span class='notice'>You add the robot arm to " + this + "!</span>" );
				this.name = "helmet/signaler/prox sensor/robot arm assembly";
				this.overlays.Add( "hs_arm" );
				GlobalFuncs.qdel( A );
			} else if ( A is Obj_Item_Weapon_Melee_Baton && this.build_step >= 3 ) {
				
				if ( !((Mob)user).unEquip( A ) ) {
					return null;
				}
				this.build_step++;
				user.WriteMsg( "<span class='notice'>You complete the Securitron! Beep boop.</span>" );
				S = new Mob_Living_SimpleAnimal_Bot_Secbot();
				S.loc = GlobalFuncs.get_turf( this );
				S.name = this.created_name;
				GlobalFuncs.qdel( A );
				GlobalFuncs.qdel( this );
			} else if ( A is Obj_Item_Weapon_Pen ) {
				t = GlobalFuncs.stripped_input( user, "Enter new robot name", this.name, this.created_name, 26 );

				if ( !Lang13.Bool( t ) ) {
					return null;
				}

				if ( !( Map13.GetDistance( this, Task13.User ) <= 1 ) && this.loc != Task13.User ) {
					return null;
				}
				this.created_name = t;
			} else if ( A is Obj_Item_Weapon_Screwdriver ) {
				
				if ( !( this.build_step != 0 ) ) {
					new Obj_Item_Device_Assembly_Signaler( GlobalFuncs.get_turf( this ) );
					new Obj_Item_Clothing_Head_Helmet_Sec( GlobalFuncs.get_turf( this ) );
					user.WriteMsg( "<span class='notice'>You disconnect the signaler from the helmet.</span>" );
					GlobalFuncs.qdel( this );
				} else if ( this.build_step == 2 ) {
					this.overlays.Remove( "hs_eye" );
					new Obj_Item_Device_Assembly_ProxSensor( GlobalFuncs.get_turf( this ) );
					user.WriteMsg( "<span class='notice'>You detach the proximity sensor from " + this + ".</span>" );
					this.build_step--;
				} else if ( this.build_step == 3 ) {
					this.overlays.Remove( "hs_arm" );
					new Obj_Item_RobotParts_LArm( GlobalFuncs.get_turf( this ) );
					user.WriteMsg( "<span class='notice'>You remove the robot arm from " + this + ".</span>" );
					this.build_step--;
				}
			}
			return null;
		}

	}

}