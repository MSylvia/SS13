// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Item_Clothing_Glasses_Hud_Health_Mech : Obj_Item_Clothing_Glasses_Hud_Health {

		public Obj_Item_Clothing_Glasses_Hud_Health_Mech ( dynamic loc = null ) : base( (object)(loc) ) {
			
		}

		// Function from file: odysseus.dm
		public override void process_hud( Mob_Living_Carbon_Human M = null ) {
			Client C = null;
			dynamic holder = null;
			Mob_Living_Carbon_Human patient = null;
			int foundVirus = 0;
			Disease D = null;

			
			if ( !( M != null ) || Lang13.Bool( M.stat ) || !Map13.FetchInView( null, M ).Contains( M ) ) {
				return;
			}

			if ( !( M.client != null ) ) {
				return;
			}
			C = M.client;

			foreach (dynamic _b in Lang13.Enumerate( Map13.FetchInView( null, M.loc ), typeof(Mob_Living_Carbon_Human) )) {
				patient = _b;
				

				if ( M.see_invisible < patient.invisibility ) {
					continue;
				}
				foundVirus = 0;

				foreach (dynamic _a in Lang13.Enumerate( patient.viruses, typeof(Disease) )) {
					D = _a;
					

					if ( !Lang13.Bool( D.hidden[1] ) ) {
						foundVirus++;
					}
				}
				holder = patient.hud_list[1];

				if ( patient.stat == 2 ) {
					holder.icon_state = "hudhealth-100";
					C.images.Add( holder );
				} else {
					holder.icon_state = "hud" + GlobalFuncs.RoundHealth( patient.health );
					C.images.Add( holder );
				}
				holder = patient.hud_list[2];

				if ( patient.stat == 2 ) {
					holder.icon_state = "huddead";
				} else if ( ( patient.status_flags & 32768 ) != 0 ) {
					holder.icon_state = "hudxeno";
				} else if ( foundVirus != 0 ) {
					holder.icon_state = "hudill";
				} else {
					holder.icon_state = "hudhealthy";
				}
				C.images.Add( holder );
			}
			return;
		}

	}

}