// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Item_Stack_Sheet_Snow : Obj_Item_Stack_Sheet {

		public Ent_Static spawn_loc = null;

		protected override void __FieldInit() {
			base.__FieldInit();

			this.singular_name = "snow ball";
			this.melt_temperature = 304.41;
			this.throw_range = 6;
			this.icon_state = "snow";
		}

		// Function from file: snow.dm
		public Obj_Item_Stack_Sheet_Snow ( dynamic loc = null, int? amount = null ) : base( (object)(loc), amount ) {
			this.recipes = GlobalVars.snow_recipes;
			this.pixel_x = Rand13.Int( -13, 13 );
			this.pixel_y = Rand13.Int( -13, 13 );
			this.spawn_loc = this.loc;
			Task13.Schedule( 400, (Task13.Closure)(() => {
				this.remove_snowball();
				return;
			}));
			// Warning: Super call was HERE! If anything above HERE is needed by the super call, it might break!;
			return;
		}

		// Function from file: snow.dm
		public override dynamic throw_impact( dynamic hit_atom = null, dynamic speed = null, Mob user = null ) {
			dynamic C = null;
			dynamic S = null;

			
			if ( hit_atom is Mob_Living_Carbon ) {
				C = hit_atom;

				if ( Convert.ToDouble( C.stuttering ) < 1 && !false ) {
					C.stuttering = 1;
				}
				((Mob)C).Weaken( 1 );
				((Mob)C).Stun( 1 );
				GlobalFuncs.playsound( C.loc, "swing_hit", 50, 1 );

				if ( Convert.ToDouble( C.bodytemperature ) >= 303.41 ) {
					C.bodytemperature -= 0.5;
				}
			} else if ( hit_atom is Mob_Living_SimpleAnimal_Hostile_Retaliate_Snowman ) {
				S = hit_atom;
				GlobalFuncs.playsound( S.loc, "swing_hit", 50, 1 );

				if ( S.enemies.len != 0 ) {
					
					if ( Rand13.PercentChance( 10 ) ) {
						S.enemies = new ByTable();
						((Mob_Living_SimpleAnimal_Hostile)S).LoseTarget();
						((Ent_Dynamic)S).say( "Ah, I give up, you've got a pretty good swing." );
						Lang13.Call( typeof(Obj_Item_Weapon_WinterGift).GetMethod( "pick_a_gift" ), S.loc );
					} else {
						((Ent_Dynamic)S).say( Rand13.Pick(new object [] { "Didn't feel anything", "You call that snowballing?" }) );
					}
				} else {
					((Ent_Dynamic)S).say( Rand13.Pick(new object [] { "A fight? With pleasure.", "Don't forget that you're the one who started it all." }) );
					((Mob_Living_SimpleAnimal_Hostile_Retaliate)S).Retaliate();
				}

				if ( Convert.ToDouble( S.bodytemperature ) >= 233 ) {
					S.bodytemperature -= 2;
				}
			} else {
				base.throw_impact( (object)(hit_atom), (object)(speed), user );
			}
			return null;
		}

		// Function from file: snow.dm
		public override bool throw_at( dynamic target = null, double? range = null, dynamic speed = null, bool? _override = null ) {
			GlobalFuncs.playsound( this.loc, "sound/weapons/punchmiss.ogg", 50, 1 );
			base.throw_at( (object)(target), range, (object)(speed), _override );
			return false;
		}

		// Function from file: snow.dm
		public override void melt(  ) {
			dynamic T = null;
			dynamic TS = null;

			T = GlobalFuncs.get_turf( this );

			if ( T is Tile_Simulated ) {
				TS = T;
				((Tile_Simulated)TS).f_wet( 100 );
			}
			GlobalFuncs.qdel( this );
			return;
		}

		// Function from file: snow.dm
		public void remove_snowball(  ) {
			
			if ( this != null && this.loc == this.spawn_loc && this.loc is Tile ) {
				GlobalFuncs.qdel( this );
			}
			return;
		}

	}

}