// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Item_Clothing_Mask_Happy : Obj_Item_Clothing_Mask {

		protected override void __FieldInit() {
			base.__FieldInit();

			this.item_state = "happiest";
			this.flags = 264;
			this.body_parts_covered = 38912;
			this.w_class = 2;
			this.siemens_coefficient = 3;
			this.gas_transfer_coefficient = 081;
			this.unacidable = true;
			this.icon_state = "happiest";
		}

		public Obj_Item_Clothing_Mask_Happy ( dynamic loc = null ) : base( (object)(loc) ) {
			
		}

		// Function from file: mystic.dm
		public void RaiseShade( Mob_Living_Carbon_Human H = null ) {
			Mob_Living_Carbon_Human M = null;
			Mob_Living_SimpleAnimal_Shade S = null;

			
			foreach (dynamic _a in Lang13.Enumerate( Map13.FetchInView( H, 4 ), typeof(Mob_Living_Carbon_Human) )) {
				M = _a;
				

				if ( !( M != null ) ) {
					return;
				}

				if ( M.stat != 2 ) {
					continue;
				}

				if ( M.client == null ) {
					continue;
				}
				Icon13.Flick( "happiest_flash", this );
				S = new Mob_Living_SimpleAnimal_Shade( M.loc );
				S.name = "Shade of " + M.real_name;
				S.real_name = "Shade of " + M.real_name;

				if ( M.client != null ) {
					M.client.mob = S;
				}
				S.__CallVerb("Cancel Camera View" );
				Icon13.Flick( "happiest_flash", this );
				GlobalFuncs.to_chat( H, "<span class='sinister'>Oh joy! " + M.real_name + "'s decided to join the party!</span>" );
				GlobalFuncs.to_chat( S, "<span class='sinister'>You have been given form by the power of the happiest mask! Go forth and cause joyful chaos for " + H.real_name + "!</span>" );
			}
			return;
		}

		// Function from file: mystic.dm
		public override void OnMobDeath( Mob holder = null ) {
			Mob W = null;

			W = holder;
			W.visible_message( "<span class=warning>The mask lets go of " + W + "'s corpse.</span>" );
			W.drop_from_inventory( this );
			Icon13.Flick( "happiest_flash", this );
			this.canremove = true;
			return;
		}

		// Function from file: mystic.dm
		public override void OnMobLife( Mob_Living_Carbon_Human holder = null ) {
			Mob_Living_Carbon_Human W = null;
			ByTable laughtypes = null;
			dynamic laughtype = null;

			W = holder;

			if ( W.wear_mask == this ) {
				this.RaiseShade( W );
			}

			if ( Rand13.PercentChance( 5 ) ) {
				
				dynamic _a = Rand13.Pick(new object [] { 1, 2, 3 }); // Was a switch-case, sorry for the mess.
				if ( _a==1 ) {
					W.say( Rand13.Pick(new object [] { "I'M SO HAPPY!", "SMILE!", "ISN'T EVERYTHING SO WONDERFUL?", "EVERYONE SHOULD SMILE!" }) );
				} else if ( _a==2 ) {
					laughtypes = new ByTable(new object [] { "funny", "disturbing", "creepy", "horrid", "bloodcurdling", "freaky", "scary", "childish", "deranged", "airy", "snorting" });
					laughtype = Rand13.PickFromTable( laughtypes );
					W.visible_message( new Txt().item( W ).str( " makes " ).a( laughtype ).item().str( " laugh." ).ToString() );
				} else if ( _a==3 ) {
					W.emote( Rand13.Pick(new object [] { "laugh", "chuckle", "giggle", "grin", "smile" }) );
				}
			}
			return;
		}

		// Function from file: mystic.dm
		public override bool pickup( Mob user = null ) {
			Icon13.Flick( "happiest_flash", this );
			GlobalFuncs.to_chat( user, "<span class=warning><B>The mask's eyesockets briefly flash with a foreboding red glare.</span></B>" );
			return false;
		}

		// Function from file: mystic.dm
		public override dynamic attack_hand( dynamic a = null, dynamic b = null, dynamic c = null ) {
			
			if ( a.wear_mask == this ) {
				GlobalFuncs.to_chat( a, "<span class='sinister'>It won't come off.</span>" );
				Icon13.Flick( "happiest_flash", this );
			} else {
				base.attack_hand( (object)(a), (object)(b), (object)(c) );
			}
			return null;
		}

		// Function from file: mystic.dm
		public override dynamic equipped( dynamic user = null, dynamic slot = null ) {
			dynamic H = null;

			H = user;

			if ( !( H is Mob_Living_Carbon_Human ) ) {
				return null;
			}

			if ( H.wear_mask == this ) {
				Icon13.Flick( "happiest_flash", this );
				GlobalFuncs.to_chat( H, "<span class='sinister'>Your thoughts are bombarded by incessant laughter.</span>" );
				GlobalFuncs.to_chat( H, new Sound( "sound/effects/hellclown.ogg" ) );
				this.canremove = false;
			}
			return null;
		}

	}

}