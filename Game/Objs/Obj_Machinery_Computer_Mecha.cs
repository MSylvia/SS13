// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Machinery_Computer_Mecha : Obj_Machinery_Computer {

		public ByTable located = new ByTable();
		public bool screen = false;
		public dynamic stored_data = null;

		protected override void __FieldInit() {
			base.__FieldInit();

			this.req_access = new ByTable(new object [] { 29 });
			this.circuit = "/obj/item/weapon/circuitboard/mecha_control";
			this.light_color = "#E17DE1";
			this.icon_state = "mecha";
		}

		public Obj_Machinery_Computer_Mecha ( dynamic loc = null ) : base( (object)(loc) ) {
			
		}

		// Function from file: mecha_control_console.dm
		public override dynamic Topic( string href = null, ByTable href_list = null, dynamic hclient = null, HtmlInterface currui = null ) {
			TopicInput filter = null;
			dynamic MT = null;
			dynamic message = null;
			dynamic M = null;
			dynamic MT2 = null;
			dynamic M2 = null;
			dynamic MT3 = null;
			dynamic MT4 = null;

			
			if ( Lang13.Bool( base.Topic( href, href_list, (object)(hclient) ) ) ) {
				return null;
			}
			filter = new TopicInput( href, href_list );

			if ( Lang13.Bool( href_list["send_message"] ) ) {
				MT = filter.getObj( "send_message" );
				message = GlobalFuncs.strip_html_simple( Interface13.Input( Task13.User, "Input message", "Transmit message", null, null, InputType.Str ) );
				M = ((Obj_Item_MechaParts_MechaTracking)MT).in_mecha();

				if ( Lang13.Bool( GlobalFuncs.trim( message ) ) && Lang13.Bool( M ) ) {
					((Obj_Mecha)M).occupant_message( message );
				}
				return null;
			}

			if ( Lang13.Bool( href_list["lockdown"] ) ) {
				MT2 = filter.getObj( "lockdown" );
				M2 = ((Obj_Item_MechaParts_MechaTracking)MT2).in_mecha();

				if ( Lang13.Bool( M2.state ) ) {
					GlobalFuncs.to_chat( Task13.User, "That exosuit is already under lockdown!" );
					return null;
				}

				switch ((string)( Interface13.Alert( "Are you sure? The exosuit will enter maintenance mode.", "Transmit Beacon Lockdown Code", "Yes", "No" ) )) {
					case "Yes":
						((Obj_Item_MechaParts_MechaTracking)MT2).f_lockdown();
						break;
					case "No":
						GlobalFuncs.to_chat( Task13.User, "You have second thoughts." );
						break;
				}
			}

			if ( Lang13.Bool( href_list["shock"] ) ) {
				
				switch ((string)( Interface13.Alert( "Are you sure? This cannot be undone.", "Transmit Beacon Self-Destruct Code", "Yes", "No" ) )) {
					case "Yes":
						MT3 = filter.getObj( "shock" );
						MT3.shock();
						break;
					case "No":
						GlobalFuncs.to_chat( Task13.User, "You have second thoughts." );
						break;
				}
			}

			if ( Lang13.Bool( href_list["get_log"] ) ) {
				MT4 = filter.getObj( "get_log" );
				this.stored_data = ((Obj_Item_MechaParts_MechaTracking)MT4).get_mecha_log();
				this.screen = true;
			}

			if ( Lang13.Bool( href_list["return"] ) ) {
				this.screen = false;
			}
			this.updateUsrDialog();
			return null;
		}

		// Function from file: mecha_control_console.dm
		public override dynamic attack_hand( dynamic a = null, dynamic b = null, dynamic c = null ) {
			string dat = null;
			Obj_Item_MechaParts_MechaTracking TR = null;
			dynamic answer = null;

			
			if ( Lang13.Bool( base.attack_hand( (object)(a), (object)(b), (object)(c) ) ) ) {
				return null;
			}
			((Mob)a).set_machine( this );
			dat = "<html><head><title>" + this.name + "</title><style>h3 {margin: 0px; padding: 0px;}</style></head><body>";

			if ( !this.screen ) {
				dat += "<h3>Tracking beacons data</h3>";

				foreach (dynamic _a in Lang13.Enumerate( typeof(Game13), typeof(Obj_Item_MechaParts_MechaTracking) )) {
					TR = _a;
					
					answer = TR.get_mecha_info();

					if ( Lang13.Bool( answer ) ) {
						dat += new Txt( "<hr>" ).item( answer ).str( "<br/>\n						  <a href='?src=" ).Ref( this ).str( ";send_message=" ).Ref( TR ).str( "'>Send message</a><br/>\n						  <a href='?src=" ).Ref( this ).str( ";get_log=" ).Ref( TR ).str( "'>Show exosuit log</a> |\n						  <a style='color: #A66300;' href='?src=" ).Ref( this ).str( ";lockdown=" ).Ref( TR ).str( "'>(Lockdown)</a> |\n						  <a style='color: #f00;' href='?src=" ).Ref( this ).str( ";shock=" ).Ref( TR ).str( "'>(Detonate Beacon)</a><br>" ).ToString();
					}
				}
			}

			if ( this.screen ) {
				dat += new Txt( "<h3>Log contents</h3>\n			<a href='?src=" ).Ref( this ).str( ";return=1'>Return</a><hr>\n			" ).item( this.stored_data ).ToString();
			}
			dat += new Txt( "<A href='?src=" ).Ref( this ).str( ";refresh=1'>(Refresh)</A><BR>\n		</body></html>" ).ToString();
			Interface13.Browse( a, dat, "window=computer;size=400x500" );
			GlobalFuncs.onclose( a, "computer" );
			return null;
		}

		// Function from file: mecha_control_console.dm
		public override dynamic attack_paw( Mob a = null, dynamic b = null, dynamic c = null ) {
			return this.attack_hand( a );
		}

		// Function from file: mecha_control_console.dm
		public override dynamic attack_ai( dynamic user = null ) {
			this.add_hiddenprint( user );
			return this.attack_hand( user );
		}

	}

}