// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Item_Weapon_Strangerock : Obj_Item_Weapon {

		public dynamic inside = null;
		public bool method = false;
		public dynamic geologic_data = null;

		protected override void __FieldInit() {
			base.__FieldInit();

			this.origin_tech = "materials=5";
			this.icon = "icons/obj/xenoarchaeology.dmi";
			this.icon_state = "strange";
		}

		// Function from file: finds.dm
		public Obj_Item_Weapon_Strangerock ( dynamic loc = null, bool? inside_item_type = null ) : base( (object)(loc) ) {
			inside_item_type = inside_item_type ?? false;

			// Warning: Super call was HERE! If anything above HERE is needed by the super call, it might break!;

			if ( inside_item_type == true ) {
				new Obj_Item_Weapon_ArchaeologicalFind( this, inside_item_type );

				if ( !Lang13.Bool( this.inside ) ) {
					this.inside = Lang13.FindIn( typeof(Obj_Item_Weapon), this.contents );
				}
			}
			return;
		}

		// Function from file: finds.dm
		public override dynamic attackby( dynamic a = null, dynamic b = null, dynamic c = null ) {
			dynamic w = null;
			dynamic M = null;
			dynamic M2 = null;
			dynamic M3 = null;
			dynamic S = null;

			
			if ( a is Obj_Item_Weapon_Weldingtool ) {
				w = a;

				if ( ((Obj_Item_Weapon_Weldingtool)w).isOn() ) {
					
					if ( ( ((Obj_Item_Weapon_Weldingtool)w).get_fuel() ?1:0) >= 4 && !this.method ) {
						
						if ( Lang13.Bool( this.inside ) ) {
							this.inside.loc = GlobalFuncs.get_turf( this );
							this.inside = null;

							foreach (dynamic _a in Lang13.Enumerate( Map13.FetchViewers( b, Game13.view ) )) {
								M = _a;
								
								M.show_message( "<span class='info'>" + this + " burns away revealing " + this.inside + ".</span>", 1 );
							}
						} else {
							
							foreach (dynamic _b in Lang13.Enumerate( Map13.FetchViewers( b, Game13.view ) )) {
								M2 = _b;
								
								M2.show_message( "<span class='info'>" + this + " burns away into nothing.</span>", 1 );
							}
						}
						GlobalFuncs.qdel( this );
						w.remove_fuel( 4 );
					} else {
						
						foreach (dynamic _c in Lang13.Enumerate( Map13.FetchViewers( b, Game13.view ) )) {
							M3 = _c;
							
							M3.show_message( "<span class='info'>A few sparks fly off " + this + ", but nothing else happens.</span>", 1 );
						}
						w.remove_fuel( 1 );
					}
					return null;
				}
			} else if ( a is Obj_Item_Device_CoreSampler ) {
				S = a;
				((Obj_Item_Device_CoreSampler)S).sample_item( this, b );
				return null;
			}
			base.attackby( (object)(a), (object)(b), (object)(c) );

			if ( Rand13.PercentChance( 33 ) ) {
				this.visible_message( "<span class='warning'>" + this + " crumbles away, leaving some dust and gravel behind.</span>" );
				GlobalFuncs.qdel( this );
			}
			return null;
		}

		// Function from file: finds.dm
		public override dynamic Destroy( dynamic brokenup = null ) {
			base.Destroy( (object)(brokenup) );
			GlobalFuncs.qdel( this.inside );
			this.inside = null;
			return null;
		}

	}

}