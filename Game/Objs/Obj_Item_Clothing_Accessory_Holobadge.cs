// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Item_Clothing_Accessory_Holobadge : Obj_Item_Clothing_Accessory {

		public bool emagged = false;
		public dynamic stored_name = null;

		protected override void __FieldInit() {
			base.__FieldInit();

			this._color = "holobadge";
			this.slot_flags = 512;
			this.icon_state = "holobadge";
		}

		public Obj_Item_Clothing_Accessory_Holobadge ( dynamic loc = null ) : base( (object)(loc) ) {
			
		}

		// Function from file: accessory.dm
		public override bool? attack( dynamic M = null, dynamic user = null, string def_zone = null, bool? eat_override = null ) {
			
			if ( user is Mob_Living ) {
				((Ent_Static)user).visible_message( "<span class='warning'>" + user + " invades " + M + "'s personal space, thrusting " + this + " into their face insistently.</span>", "<span class='warning'>You invade " + M + "'s personal space, thrusting " + this + " into their face insistently. You are the law.</span>" );
			}
			return null;
		}

		// Function from file: accessory.dm
		public override dynamic attackby( dynamic a = null, dynamic b = null, dynamic c = null ) {
			dynamic id_card = null;
			dynamic pda = null;

			
			if ( a is Obj_Item_Weapon_Card_Emag ) {
				
				if ( this.emagged ) {
					GlobalFuncs.to_chat( b, "<span class='warning'>" + this + " is already cracked.</span>" );
					return null;
				} else {
					this.emagged = true;
					GlobalFuncs.to_chat( b, "<span class='warning'>You swipe " + a + " and crack the holobadge security checks.</span>" );
					return null;
				}
			} else if ( a is Obj_Item_Weapon_Card_Id || a is Obj_Item_Device_Pda ) {
				id_card = null;

				if ( a is Obj_Item_Weapon_Card_Id ) {
					id_card = a;
				} else {
					pda = a;
					id_card = pda.id;
				}

				if ( Lang13.Bool( ((dynamic)( Lang13.Bool( id_card.access ) || this.emagged )).Contains( GlobalVars.access_security ) ) ) {
					GlobalFuncs.to_chat( b, "You imprint your ID details onto the badge." );
					this.stored_name = id_card.registered_name;
					this.name = "holobadge (" + this.stored_name + ")";
					this.desc = "This glowing blue badge marks " + this.stored_name + " as THE LAW.";
				} else {
					GlobalFuncs.to_chat( b, "" + this + " rejects your insufficient access rights." );
				}
				return null;
			}
			base.attackby( (object)(a), (object)(b), (object)(c) );
			return null;
		}

		// Function from file: accessory.dm
		public override dynamic attack_self( dynamic user = null, dynamic flag = null, bool? emp = null ) {
			
			if ( !Lang13.Bool( this.stored_name ) ) {
				GlobalFuncs.to_chat( user, "Waving around a badge before swiping an ID would be pretty pointless." );
				return null;
			}

			if ( user is Mob_Living ) {
				((Ent_Static)user).visible_message( "<span class='warning'>" + user + " displays their Nanotrasen Internal Security Legal Authorization Badge.\nIt reads: " + this.stored_name + ", NT Security.</span>", "<span class='warning'>You display your Nanotrasen Internal Security Legal Authorization Badge.\nIt reads: " + this.stored_name + ", NT Security.</span>" );
			}
			return null;
		}

	}

}