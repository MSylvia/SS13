// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Effect_ProcHolder_Spell_AoeTurf_AscendantStorm : Obj_Effect_ProcHolder_Spell_AoeTurf {

		protected override void __FieldInit() {
			base.__FieldInit();

			this.panel = "Ascendant";
			this.range = 6;
			this.clothes_req = 0;
			this.action_icon_state = "lightning_storm";
			this.sound = "sound/magic/lightningbolt.ogg";
		}

		public Obj_Effect_ProcHolder_Spell_AoeTurf_AscendantStorm ( dynamic loc = null ) : base( (object)(loc) ) {
			
		}

		// Function from file: shadowling_abilities.dm
		public override bool cast( dynamic targets = null, dynamic thearea = null, dynamic user = null ) {
			thearea = thearea ?? Task13.User;

			dynamic T = null;
			Mob_Living_Carbon_Human target = null;

			
			if ( Lang13.Bool( thearea.phasing ) ) {
				thearea.WriteMsg( "<span class='warning'>You are not in the same plane of existence. Unphase first.</span>" );
				this.revert_cast();
				return false;
			}
			((Ent_Static)thearea).visible_message( "<span class='warning'><b>A massive ball of lightning appears in " + thearea + "'s hands and flares out!</b></span>", "<span class='shadowling'>You conjure a ball of lightning and release it.</span>" );

			foreach (dynamic _b in Lang13.Enumerate( targets )) {
				T = _b;
				

				foreach (dynamic _a in Lang13.Enumerate( T.contents, typeof(Mob_Living_Carbon_Human) )) {
					target = _a;
					

					if ( GlobalFuncs.is_shadow_or_thrall( target ) ) {
						continue;
					}
					target.WriteMsg( "<span class='userdanger'>You are struck by a bolt of lightning!</span>" );
					GlobalFuncs.playsound( target, "sound/magic/LightningShock.ogg", 50, 1 );
					target.Weaken( 8 );
					target.take_organ_damage( 0, 50 );
					((Ent_Static)thearea).Beam( target, "red_lightning", "icons/effects/effects.dmi", 1 );
				}
			}
			return false;
		}

	}

}