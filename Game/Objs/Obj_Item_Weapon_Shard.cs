// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Item_Weapon_Shard : Obj_Item_Weapon {

		public Type glass = typeof(Obj_Item_Stack_Sheet_Glass_Glass);

		protected override void __FieldInit() {
			base.__FieldInit();

			this.sharpness = 0.8;
			this.w_class = 1;
			this.hitsound = "sound/weapons/bladeslice.ogg";
			this.force = 5;
			this.throwforce = 15;
			this.item_state = "shard-glassnew";
			this.starting_materials = new ByTable().Set( "$glass", 3750 );
			this.w_type = 2;
			this.melt_temperature = 1773.1500244140625;
			this.attack_verb = new ByTable(new object [] { "stabbed", "slashed", "sliced", "cut" });
			this.icon = "icons/obj/shards.dmi";
			this.icon_state = "large";
		}

		// Function from file: shard.dm
		public Obj_Item_Weapon_Shard ( dynamic loc = null ) : base( (object)(loc) ) {
			this.icon_state = Rand13.Pick(new object [] { "large", "medium", "small" });

			switch ((string)( this.icon_state )) {
				case "small":
					this.pixel_x = Rand13.Int( -12, 12 );
					this.pixel_y = Rand13.Int( -12, 12 );
					break;
				case "medium":
					this.pixel_x = Rand13.Int( -8, 8 );
					this.pixel_y = Rand13.Int( -8, 8 );
					break;
				case "large":
					this.pixel_x = Rand13.Int( -5, 5 );
					this.pixel_y = Rand13.Int( -5, 5 );
					break;
			}
			// Warning: Super call was HERE! If anything above HERE is needed by the super call, it might break!;
			return;
		}

		// Function from file: shard.dm
		public override dynamic Crossed( Ent_Dynamic O = null, dynamic X = null ) {
			Ent_Dynamic M = null;
			Ent_Dynamic H = null;
			dynamic affecting = null;

			
			if ( O is Mob_Living ) {
				M = O;

				if ( Lang13.Bool( M.locked_to ) ) {
					GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/effects/glass_step.ogg", 50, 1 );
					return null;
				}

				if ( Lang13.Bool( ((dynamic)M).flying ) ) {
					return null;
				} else {
					GlobalFuncs.to_chat( M, "<span class='danger'>You step in the broken glass!</span>" );
					GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/effects/glass_step.ogg", 50, 1 );

					if ( M is Mob_Living_Carbon_Human ) {
						H = M;

						if ( !Lang13.Bool( ((dynamic)H).check_body_part_coverage( 96 ) ) ) {
							affecting = ((dynamic)H).get_organ( Rand13.Pick(new object [] { "l_foot", "r_foot" }) );

							if ( Lang13.Bool( affecting.status & 4224 ) ) {
								return null;
							}

							if ( !( Lang13.Bool( ((dynamic)H).species ) && Lang13.Bool( ((dynamic)H).species.flags & 8 ) ) ) {
								((dynamic)H).Weaken( 3 );
							}

							if ( Lang13.Bool( affecting.take_damage( 5, 0 ) ) ) {
								((dynamic)H).UpdateDamageIcon();
							}
							((dynamic)H).updatehealth();
						}
					}
				}
			}
			base.Crossed( O, (object)(X) );
			return null;
		}

		// Function from file: shard.dm
		public override dynamic attackby( dynamic a = null, dynamic b = null, dynamic c = null ) {
			dynamic WT = null;
			dynamic new_item = null;

			
			if ( a is Obj_Item_Weapon_Weldingtool ) {
				WT = a;

				if ( ((Obj_Item_Weapon_Weldingtool)WT).remove_fuel( 0, b ) ) {
					new_item = Lang13.Call( this.glass, b.loc );
					((Obj_Item_Stack)new_item).add_to_stacks( Task13.User );
					GlobalFuncs.returnToPool( this );
					return null;
				}
			}
			return base.attackby( (object)(a), (object)(b), (object)(c) );
		}

		// Function from file: shard.dm
		public override dynamic Bump( Obj Obstacle = null, dynamic yes = null ) {
			Task13.Schedule( 0, (Task13.Closure)(() => {
				
				if ( Rand13.PercentChance( 20 ) ) {
					this.force = 15;
				} else {
					this.force = 4;
				}
				base.Bump( Obstacle );
				return;
				return;
			}));
			return null;
		}

		// Function from file: shard.dm
		public override dynamic resetVariables( string args = null, params object[] _ ) {
			ByTable _args = new ByTable( new object[] { args } ).Extend(_);

			base.resetVariables( "icon_state", "pixel_y", "pixel_x" );
			return null;
		}

		// Function from file: shard.dm
		public override bool? attack( dynamic M = null, dynamic user = null, string def_zone = null, bool? eat_override = null ) {
			GlobalFuncs.playsound( this.loc, "sound/weapons/bladeslice.ogg", 50, 1, -1 );
			return base.attack( (object)(M), (object)(user), def_zone, eat_override );
		}

		// Function from file: shard.dm
		public override dynamic suicide_act( Mob_Living_Carbon_Human user = null ) {
			GlobalFuncs.to_chat( Map13.FetchViewers( null, user ), Rand13.Pick(new object [] { new Txt( "<span class='danger'>" ).item( user ).str( " is slitting " ).his_her_its_their().str( " wrists with the shard of glass! It looks like " ).he_she_it_they().str( "'s trying to commit suicide.</span>" ).ToString(), new Txt( "<span class='danger'>" ).item( user ).str( " is slitting " ).his_her_its_their().str( " throat with the shard of glass! It looks like " ).he_she_it_they().str( "'s trying to commit suicide.</span>" ).ToString() }) );
			return 1;
		}

	}

}