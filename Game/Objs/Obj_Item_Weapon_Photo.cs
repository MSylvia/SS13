// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Item_Weapon_Photo : Obj_Item_Weapon {

		public Icon img = null;
		public string scribble = null;
		public bool blueprints = false;
		public bool sillynewscastervar = false;

		protected override void __FieldInit() {
			base.__FieldInit();

			this.item_state = "paper";
			this.w_class = 1;
			this.burn_state = 0;
			this.burntime = 5;
			this.icon_state = "photo";
		}

		public Obj_Item_Weapon_Photo ( dynamic loc = null ) : base( (object)(loc) ) {
			
		}

		// Function from file: photography.dm
		public void photocreate( dynamic inicon = null, Icon inimg = null, dynamic indesc = null, dynamic inblueprints = null ) {
			this.icon = inicon;
			this.img = inimg;
			this.desc = indesc;
			this.blueprints = Lang13.Bool( inblueprints );
			return;
		}

		// Function from file: photography.dm
		public void show( dynamic user = null ) {
			Interface13.CacheBrowseResource( user, this.img, "tmp_photo.png" );
			Interface13.Browse( user, "<html><head><title>" + this.name + "</title></head>" + "<body style='overflow:hidden;margin:0;text-align:center'>" + "<img src='tmp_photo.png' width='192' style='-ms-interpolation-mode:nearest-neighbor' />" + ( "" + ( Lang13.Bool( this.scribble ) ? "<br>Written on the back:<br><i>" + this.scribble + "</i>" : "" ) ) + "</body></html>", "window=book;size=192x" + ( Lang13.Bool( this.scribble ) ? 400 : 192 ) );
			GlobalFuncs.onclose( user, "" + this.name );
			return;
		}

		// Function from file: photography.dm
		public override double examine( dynamic user = null ) {
			base.examine( (object)(user) );

			if ( Map13.GetDistance( user, this ) <= 1 ) {
				this.show( user );
			} else {
				user.WriteMsg( "<span class='warning'>You need to get closer to get a good look at this photo!</span>" );
			}
			return 0;
		}

		// Function from file: photography.dm
		public override dynamic attackby( dynamic A = null, dynamic user = null, string _params = null, bool? silent = null, bool? replace_spent = null ) {
			string txt = null;

			
			if ( A is Obj_Item_Weapon_Pen || A is Obj_Item_Toy_Crayon ) {
				txt = GlobalFuncs.sanitize( Interface13.Input( user, "What would you like to write on the back?", "Photo Writing", null, null, InputType.Str ) );
				txt = String13.SubStr( txt, 1, 128 );

				if ( this.loc == user && Lang13.Bool( user.stat ) == false ) {
					this.scribble = txt;
				}
			}
			base.attackby( (object)(A), (object)(user), _params, silent, replace_spent );
			return null;
		}

		// Function from file: photography.dm
		public override dynamic attack_self( dynamic user = null, dynamic flag = null, bool? emp = null ) {
			user.__CallVerb("Examine", this );
			return null;
		}

		// Function from file: photography.dm
		[Verb]
		[VerbInfo( name: "Rename photo", group: "Object", access: VerbAccess.InUserContents, range: 127 )]
		public void rename(  ) {
			string n_name = null;

			n_name = String13.SubStr( GlobalFuncs.sanitize( Interface13.Input( Task13.User, "What would you like to label the photo?", "Photo Labelling", null, null, InputType.Str ) ), 1, 26 );

			if ( ( this.loc == Task13.User || this.loc.loc != null && this.loc.loc == Task13.User ) && Task13.User.stat == 0 && Task13.User.canmove && !Task13.User.restrained() ) {
				this.name = "photo" + ( Lang13.Bool( n_name ) ? "- '" + n_name + "'" : null );
			}
			this.add_fingerprint( Task13.User );
			return;
		}

	}

}