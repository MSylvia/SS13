// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Item_Weapon_Gun_Energy_Bison : Obj_Item_Weapon_Gun_Energy {

		public bool pumping = false;

		protected override void __FieldInit() {
			base.__FieldInit();

			this.origin_tech = "materials=3;powerstorage=3;combat=3";
			this.projectile_type = "/obj/item/projectile/beam/bison";
			this.inhand_states = new ByTable().Set( "left_hand", "icons/mob/in-hand/left/guns_experimental.dmi" ).Set( "right_hand", "icons/mob/in-hand/right/guns_experimental.dmi" );
			this.fire_delay = 8;
			this.fire_sound = "sound/weapons/bison_fire.ogg";
			this.icon = "icons/obj/gun_experimental.dmi";
			this.icon_state = "bison";
		}

		// Function from file: special.dm
		public Obj_Item_Weapon_Gun_Energy_Bison ( dynamic loc = null ) : base( (object)(loc) ) {
			// Warning: Super call was HERE! If anything above HERE is needed by the super call, it might break!;
			this.power_supply.charge = 0;
			return;
		}

		// Function from file: special.dm
		public override bool? update_icon( dynamic location = null, dynamic target = null ) {
			
			if ( Convert.ToDouble( this.power_supply.charge ) >= Convert.ToDouble( this.power_supply.maxcharge ) ) {
				this.icon_state = "bison100";
			} else if ( Convert.ToDouble( this.power_supply.charge ) > 0 ) {
				this.icon_state = "bison50";
			} else {
				this.icon_state = "bison0";
			}
			return null;
		}

		// Function from file: special.dm
		public override dynamic attack_self( dynamic user = null, dynamic flag = null, bool? emp = null ) {
			
			if ( this.pumping || !Lang13.Bool( this.power_supply ) ) {
				return null;
			}
			this.pumping = true;
			this.power_supply.charge = Num13.MinInt( Convert.ToInt32( this.power_supply.charge + 200 ), Convert.ToInt32( this.power_supply.maxcharge ) );

			if ( Convert.ToDouble( this.power_supply.charge ) >= Convert.ToDouble( this.power_supply.maxcharge ) ) {
				GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/machines/click.ogg", 25, 1 );
				GlobalFuncs.to_chat( user, "<span class='rose'>You pull the pump at the back of the gun. Looks like the inner battery is fully charged now.</span>" );
			} else {
				GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/weapons/bison_reload.ogg", 25, 1 );
				GlobalFuncs.to_chat( user, "<span class='rose'>You pull the pump at the back of the gun.</span>" );
			}
			Task13.Sleep( 5 );
			this.pumping = false;
			this.update_icon();
			return null;
		}

	}

}