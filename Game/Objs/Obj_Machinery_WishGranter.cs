// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Machinery_WishGranter : Obj_Machinery {

		public int charges = 1;
		public int insisting = 0;

		protected override void __FieldInit() {
			base.__FieldInit();

			this.use_power = 0;
			this.anchored = 1;
			this.icon = "icons/obj/device.dmi";
			this.icon_state = "syndbeacon";
		}

		public Obj_Machinery_WishGranter ( dynamic loc = null ) : base( (object)(loc) ) {
			
		}

		// Function from file: tgstation.dme
		public override dynamic attack_hand( dynamic a = null, bool? b = null, bool? c = null ) {
			Objective_Hijack hijack = null;
			int obj_count = 0;
			Objective OBJ = null;

			
			if ( this.charges <= 0 ) {
				a.WriteMsg( "The Wish Granter lies silent." );
				return null;
			} else if ( !( a is Mob_Living_Carbon_Human ) ) {
				a.WriteMsg( "You feel a dark stirring inside of the Wish Granter, something you want nothing of. Your instincts are better than any man's." );
				return null;
			} else if ( GlobalFuncs.is_special_character( a ) != 0 ) {
				a.WriteMsg( "Even to a heart as dark as yours, you know nothing good will come of this.  Something instinctual makes you pull away." );
			} else if ( !( this.insisting != 0 ) ) {
				a.WriteMsg( "Your first touch makes the Wish Granter stir, listening to you.  Are you really sure you want to do this?" );
				this.insisting++;
			} else {
				a.WriteMsg( "You speak.  " + Rand13.Pick(new object [] { "I want the station to disappear", "Humanity is corrupt, mankind must be destroyed", "I want to be rich", "I want to rule the world", "I want immortality." }) + ".  The Wish Granter answers." );
				a.WriteMsg( "Your head pounds for a moment, before your vision clears.  You are the avatar of the Wish Granter, and your power is LIMITLESS!  And it's all yours.  You need to make sure no one can take it from you.  No one can know, first." );
				this.charges--;
				this.insisting = 0;
				((Dna)a.dna).add_mutation( "Hulk" );
				((Dna)a.dna).add_mutation( "X Ray Vision" );
				((Dna)a.dna).add_mutation( "Cold Resistance" );
				((Dna)a.dna).add_mutation( "Telekinesis" );
				GlobalVars.ticker.mode.traitors.Add( a.mind );
				a.mind.special_role = "Avatar of the Wish Granter";
				hijack = new Objective_Hijack();
				hijack.owner = a.mind;
				a.mind.objectives.Add( hijack );
				obj_count = 1;

				foreach (dynamic _a in Lang13.Enumerate( a.mind.objectives, typeof(Objective) )) {
					OBJ = _a;
					
					a.WriteMsg( "<B>Objective #" + obj_count + "</B>: " + OBJ.explanation_text );
					obj_count++;
				}
				a.WriteMsg( "You have a very bad feeling about this." );
			}
			return null;
		}

	}

}