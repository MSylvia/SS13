// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Machinery_Communication : Obj_Machinery {

		public ByTable allstones = new ByTable();
		public int remaining = 6;

		protected override void __FieldInit() {
			base.__FieldInit();

			this.stat = 2;
			this.active_power_usage = 4000;
			this.idle_power_usage = 1000;
			this.machine_flags = 24;
			this.icon = "icons/obj/xenoarchaeology.dmi";
			this.icon_state = "communication";
		}

		public Obj_Machinery_Communication ( dynamic loc = null ) : base( (object)(loc) ) {
			
		}

		// Function from file: artifact_communication.dm
		public ByTable get_active_stones(  ) {
			ByTable thestones = null;
			Obj_Item_Commstone check = null;

			
			if ( ( this.stat & 2 ) != 0 && !Lang13.Bool( this.anchored ) ) {
				return new ByTable();
			}
			thestones = this.allstones;

			foreach (dynamic _a in Lang13.Enumerate( thestones, typeof(Obj_Item_Commstone) )) {
				check = _a;
				

				if ( check.loc == this ) {
					thestones.Remove( check );
				}
			}
			return thestones;
		}

		// Function from file: artifact_communication.dm
		public override dynamic Destroy( dynamic brokenup = null ) {
			dynamic stone = null;

			
			foreach (dynamic _a in Lang13.Enumerate( this.contents )) {
				stone = _a;
				
				GlobalFuncs.qdel( stone );
			}
			base.Destroy( (object)(brokenup) );
			return null;
		}

		// Function from file: artifact_communication.dm
		public override dynamic examine( dynamic user = null, string size = null ) {
			base.examine( (object)(user), size );

			if ( this.remaining != 0 ) {
				GlobalFuncs.to_chat( user, new Txt( "<span class='info'>The device's slots still apears to hold " ).item( this.remaining ).str( " stone" ).s().str( "." ).ToString() );
			} else {
				GlobalFuncs.to_chat( user, "<span class='info'>The device no longer has any stones in any of its holders." );
			}

			if ( ( this.stat & 2 ) != 0 ) {
				GlobalFuncs.to_chat( user, "<span class='info'>It seems the machine is currently dark, perhaps it would activate when anchored into a powered area." );
			}
			return null;
		}

		// Function from file: artifact_communication.dm
		public override dynamic attack_hand( dynamic a = null, dynamic b = null, dynamic c = null ) {
			dynamic stone = null;
			Obj_Item_Commstone stone2 = null;

			
			if ( Lang13.Bool( base.attack_hand( (object)(a), (object)(b), (object)(c) ) ) ) {
				return 1;
			}

			if ( this.contents.len != 0 ) {
				stone = this.contents[1];
				((Mob)a).put_in_hands( stone );
				GlobalFuncs.to_chat( a, "<span class='notice'>You delicately remove one of the strange stones from the ancient device.</span>" );
				return null;
			}

			if ( this.remaining != 0 ) {
				stone2 = new Obj_Item_Commstone( this.remaining );
				((Mob)a).put_in_hands( stone2 );
				stone2.commdevice = this;
				this.allstones.Add( stone2 );
				this.remaining--;
				GlobalFuncs.to_chat( a, "<span class='notice'>You delicately remove one of the strange stones from the ancient device.</span>" );
				return null;
			}
			return null;
		}

		// Function from file: artifact_communication.dm
		public override dynamic attack_ai( dynamic user = null ) {
			return null;
		}

		// Function from file: artifact_communication.dm
		public override dynamic attack_ghost( Mob_Dead_Observer user = null ) {
			return null;
		}

		// Function from file: artifact_communication.dm
		public override dynamic attackby( dynamic a = null, dynamic b = null, dynamic c = null ) {
			
			if ( a is Obj_Item_Commstone ) {
				
				if ( this.allstones.Contains( a ) && this.remaining < 6 ) {
					
					if ( Lang13.Bool( b.drop_item( a, this ) ) ) {
						GlobalFuncs.to_chat( b, "<span class='notice'>You place one of the strange stones back onto the ancient device, it snaps into place.</span>" );
					}
				}
			}
			base.attackby( (object)(a), (object)(b), (object)(c) );
			return null;
		}

	}

}