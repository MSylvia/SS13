// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Item_Weapon_Dice_D20_Cursed : Obj_Item_Weapon_Dice_D20 {

		public bool deactivated = false;

		public Obj_Item_Weapon_Dice_D20_Cursed ( dynamic loc = null ) : base( (object)(loc) ) {
			
		}

		// Function from file: dice.dm
		public override bool diceroll( dynamic user = null, bool thrown = false ) {
			dynamic h = null;
			Organ_External E = null;
			Organ_External E2 = null;
			Organ_External_LArm E3 = null;
			Organ_External_RArm E4 = null;
			Organ_External_LArm E5 = null;
			Organ_External_RArm E6 = null;
			Organ_External_LArm E7 = null;
			Organ_External_RArm E8 = null;
			Organ_External_LArm E9 = null;
			Organ_External_RArm E10 = null;

			base.diceroll( (object)(user), thrown );

			if ( !this.deactivated ) {
				GlobalFuncs.message_admins( "" + GlobalFuncs.key_name( user ) + " has " + ( thrown ? "used" : "thrown" ) + " a cursed dice and rolled a " + this.result );
				GlobalVars.diary.WriteMsg( String13.HtmlDecode( "[" + GlobalFuncs.time_stamp() + "]GAME: " + ( "" + GlobalFuncs.key_name( user ) + " has " + ( thrown ? "used" : "thrown" ) + " a cursed dice and rolled a " + this.result ) ) );

				if ( user is Mob_Living_Carbon_Human ) {
					h = user;

					dynamic _o = this.result; // Was a switch-case, sorry for the mess.
					if ( 2<=_o&&_o<=5 ) {
						GlobalFuncs.to_chat( user, "<span class=sinister><B>It could be worse, but not much worse! Enjoy your curse! </span></B>" );
						Icon13.Flick( "e_flash", user.flash );

						dynamic _c = Rand13.Pick(new object [] { 1, 2, 3 }); // Was a switch-case, sorry for the mess.
						if ( _c==1 ) {
							
							if ( h.species.name != "Tajaran" ) {
								
								if ( ((Mob_Living_Carbon_Human)h).set_species( "Tajaran" ) ) {
									((Mob)h).regenerate_icons();
								}
								GlobalFuncs.to_chat( user, "<span class=danger><B>You have been turned into a disgusting catbeast! </span></B>" );
							} else {
								
								foreach (dynamic _a in Lang13.Enumerate( h.organs, typeof(Organ_External) )) {
									E = _a;
									
									E.droplimb( 1 );
								}
							}
						} else if ( _c==2 ) {
							
							foreach (dynamic _b in Lang13.Enumerate( h.organs, typeof(Organ_External) )) {
								E2 = _b;
								
								E2.droplimb( 1 );
							}
						} else if ( _c==3 ) {
							((Reagents)user.reagents).add_reagent( "amutationtoxin", 1 );
							GlobalFuncs.to_chat( user, "<span class=danger><B>You've been turned into a slime! </span></B>" );
						}
					} else if ( 6<=_o&&_o<=9 ) {
						GlobalFuncs.to_chat( user, "<span class=sinister></B>You have rolled low and shall recieve a curse! It could be a lot worse however! </span></B>" );
						Icon13.Flick( "e_flash", user.flash );

						dynamic _m = Rand13.Pick(new object [] { 1, 2, 3, 4 }); // Was a switch-case, sorry for the mess.
						if ( _m==1 ) {
							((Dna)user.dna).SetSEState( GlobalVars.DEAFBLOCK, true );
							((Dna)user.dna).SetSEState( GlobalVars.MUTEBLOCK, true );
							((Dna)user.dna).SetSEState( GlobalVars.BLINDBLOCK, true );
							GlobalFuncs.genemutcheck( user, GlobalVars.DEAFBLOCK, null, true );
							GlobalFuncs.genemutcheck( user, GlobalVars.MUTEBLOCK, null, true );
							GlobalFuncs.genemutcheck( user, GlobalVars.BLINDBLOCK, null, true );
							((Mob)user).update_mutations();
							GlobalFuncs.to_chat( user, "<span class=danger><B>You've gone blind, deaf and mute! </span></B>" );
						} else if ( _m==2 ) {
							
							foreach (dynamic _d in Lang13.Enumerate( h.organs, typeof(Organ_External_LArm) )) {
								E3 = _d;
								
								E3.droplimb( 1 );
							}

							foreach (dynamic _e in Lang13.Enumerate( h.organs, typeof(Organ_External_RArm) )) {
								E4 = _e;
								
								E4.droplimb( 2 );
							}
						} else if ( _m==3 ) {
							
							if ( h.species.name != "Tajaran" ) {
								
								dynamic _l = Rand13.Pick(new object [] { 1, 2, 3 }); // Was a switch-case, sorry for the mess.
								if ( _l==1 ) {
									
									if ( h.species.name != "Unathi" ) {
										
										if ( ((Mob_Living_Carbon_Human)h).set_species( "Unathi" ) ) {
											((Mob)h).regenerate_icons();
										}
										GlobalFuncs.to_chat( user, "<span class=danger><B>You have been turned into a disgusting lizard! </span></B>" );
									} else {
										
										foreach (dynamic _f in Lang13.Enumerate( h.organs, typeof(Organ_External_LArm) )) {
											E5 = _f;
											
											E5.droplimb( 1 );
										}

										foreach (dynamic _g in Lang13.Enumerate( h.organs, typeof(Organ_External_RArm) )) {
											E6 = _g;
											
											E6.droplimb( 1 );
										}
									}
								} else if ( _l==2 ) {
									
									if ( h.species.name != "Skrell" ) {
										
										if ( ((Mob_Living_Carbon_Human)h).set_species( "Skrell" ) ) {
											((Mob)h).regenerate_icons();
										}
										GlobalFuncs.to_chat( user, "<span class=danger><B>You have been turned into a disgusting squidman! </span></B>" );
									} else {
										
										foreach (dynamic _h in Lang13.Enumerate( h.organs, typeof(Organ_External_LArm) )) {
											E7 = _h;
											
											E7.droplimb( 1 );
										}

										foreach (dynamic _i in Lang13.Enumerate( h.organs, typeof(Organ_External_RArm) )) {
											E8 = _i;
											
											E8.droplimb( 1 );
										}
									}
								} else if ( _l==3 ) {
									
									if ( h.species.name != "Vox" ) {
										
										if ( ((Mob_Living_Carbon_Human)h).set_species( "Vox" ) ) {
											((Mob)h).regenerate_icons();
										}
										GlobalFuncs.to_chat( user, "<span class=danger><B>You have been turned into a dumb, diseased bird! </span></B>" );
									} else {
										
										foreach (dynamic _j in Lang13.Enumerate( h.organs, typeof(Organ_External_LArm) )) {
											E9 = _j;
											
											E9.droplimb( 1 );
										}

										foreach (dynamic _k in Lang13.Enumerate( h.organs, typeof(Organ_External_RArm) )) {
											E10 = _k;
											
											E10.droplimb( 1 );
										}
									}
								}
							}
						} else if ( _m==4 ) {
							((Mob_Living)h).adjustBrainLoss( 200 );
							((Reagents)user.reagents).add_reagent( "nutriment", 1000 );
							user.overeatduration = 1000;
							GlobalFuncs.to_chat( user, "<span class=danger><B>In this moment you feel euphoric! </span></B>" );
						}
					} else if ( 10<=_o&&_o<=12 ) {
						GlobalFuncs.to_chat( user, "<span class=sinister><B>You get nothing. No curse or reward! </span></B>" );
					} else if ( 14<=_o&&_o<=19 ) {
						GlobalFuncs.to_chat( user, "<span class=sinister><B>You've rolled well and shall be rewarded! </span></B>" );

						dynamic _n = Rand13.Pick(new object [] { 1, 2, 3, 4, 5 }); // Was a switch-case, sorry for the mess.
						if ( _n==1 ) {
							((Dna)user.dna).SetSEState( GlobalVars.INCREASERUNBLOCK, true );
							((Dna)user.dna).SetSEState( GlobalVars.SMALLSIZEBLOCK, true );
							GlobalFuncs.genemutcheck( user, GlobalVars.INCREASERUNBLOCK, null, true );
							GlobalFuncs.genemutcheck( user, GlobalVars.SMALLSIZEBLOCK, null, true );
							((Mob)user).update_mutations();
							GlobalFuncs.to_chat( user, "<span class=danger><B>You have been made faster! </span></B>" );
						} else if ( _n==2 ) {
							((Dna)user.dna).SetSEState( GlobalVars.XRAYBLOCK, true );
							((Dna)user.dna).SetSEState( GlobalVars.TELEBLOCK, true );
							GlobalFuncs.genemutcheck( user, GlobalVars.XRAYBLOCK, null, true );
							GlobalFuncs.genemutcheck( user, GlobalVars.TELEBLOCK, null, true );
							((Mob)user).update_mutations();
							GlobalFuncs.to_chat( user, "<span class=danger><B>You have been granted vision! </span></B>" );
						} else if ( _n==3 ) {
							((Dna)user.dna).SetSEState( GlobalVars.COLDBLOCK, true );
							((Dna)user.dna).SetSEState( GlobalVars.FIREBLOCK, true );
							((Dna)user.dna).SetSEState( GlobalVars.NOBREATHBLOCK, true );
							GlobalFuncs.genemutcheck( user, GlobalVars.COLDBLOCK, null, true );
							GlobalFuncs.genemutcheck( user, GlobalVars.FIREBLOCK, null, true );
							GlobalFuncs.genemutcheck( user, GlobalVars.NOBREATHBLOCK, null, true );
							((Mob)user).update_mutations();
							GlobalFuncs.to_chat( user, "<span class=danger><B>You have been granted protection! </span></B>" );
						} else if ( _n==4 ) {
							GlobalFuncs.getFromPool( typeof(Obj_Item_Stack_Sheet_Mineral_Gold), user.loc, 50 );
							GlobalFuncs.to_chat( user, "<span class=danger)(B>You have been reward in gold! </span></B>" );
						} else if ( _n==5 ) {
							GlobalFuncs.getFromPool( typeof(Obj_Item_Stack_Sheet_Mineral_Silver), user.loc, 50 );
							GlobalFuncs.to_chat( user, "<span class=danger><B>You have been rewarded in silver! </span></B>" );
						}
					} else if ( _o==1 ) {
						GlobalFuncs.to_chat( user, "<span class=sinister><B>A natural failure, your poor roll has cursed you. Better luck next time! </span></B>" );
						Icon13.Flick( "e_flash", user.flash );
						((Mob_Living_Carbon_Human)h).Cluwneize();
					} else if ( _o==13 ) {
						GlobalFuncs.to_chat( user, "<span class=sinister><B>You've rolled 13! The cursed dice is broken! </span></B>" );
						GlobalFuncs.explosion( GlobalFuncs.get_turf( this ), 0, 0, 4, 7 );
						GlobalFuncs.to_chat( user, "<span class=danger><B>The dice explosively shatters! </span></B>" );
						GlobalFuncs.qdel( this );
					} else if ( _o==20 ) {
						GlobalFuncs.to_chat( user, "<span class=sinister><B>A perfect roll! enjoy your reward! </span></B>" );
						GlobalFuncs.getFromPool( typeof(Obj_Item_Stack_Sheet_Mineral_Phazon), user.loc, 50 );
						GlobalFuncs.getFromPool( typeof(Obj_Item_Stack_Sheet_Mineral_Diamond), user.loc, 50 );
						GlobalFuncs.getFromPool( typeof(Obj_Item_Stack_Sheet_Mineral_Clown), user.loc, 50 );
						((Dna)user.dna).SetSEState( GlobalVars.XRAYBLOCK, true );
						((Dna)user.dna).SetSEState( GlobalVars.TELEBLOCK, true );
						((Dna)user.dna).SetSEState( GlobalVars.INCREASERUNBLOCK, true );
						((Dna)user.dna).SetSEState( GlobalVars.SMALLSIZEBLOCK, true );
						((Dna)user.dna).SetSEState( GlobalVars.COLDBLOCK, true );
						((Dna)user.dna).SetSEState( GlobalVars.NOBREATHBLOCK, true );
						((Dna)user.dna).SetSEState( GlobalVars.FIREBLOCK, true );
						GlobalFuncs.genemutcheck( user, GlobalVars.XRAYBLOCK, null, true );
						GlobalFuncs.genemutcheck( user, GlobalVars.TELEBLOCK, null, true );
						GlobalFuncs.genemutcheck( user, GlobalVars.INCREASERUNBLOCK, null, true );
						GlobalFuncs.genemutcheck( user, GlobalVars.SMALLSIZEBLOCK, null, true );
						GlobalFuncs.genemutcheck( user, GlobalVars.COLDBLOCK, null, true );
						GlobalFuncs.genemutcheck( user, GlobalVars.NOBREATHBLOCK, null, true );
						GlobalFuncs.genemutcheck( user, GlobalVars.FIREBLOCK, null, true );
						((Mob)user).update_mutations();
						GlobalFuncs.to_chat( user, "<span class=danger><B>You have been rewarded hanesomely with rare minerals and powers! </span></B>" );
					}

					if ( Rand13.PercentChance( 15 ) ) {
						this.deactivated = true;
						((Ent_Static)user).visible_message( "<span class=danger><B>The dice shudders and loses its power! </span></B>" );
						this.name = "d20";
						this.desc = "A die with twenty sides. The prefered die to throw at the GM.";
					}
				}
			} else {
				return false;
			}
			return false;
		}

		// Function from file: dice.dm
		public override bool pickup( Mob user = null ) {
			base.pickup( user );

			if ( !this.deactivated ) {
				GlobalFuncs.to_chat( user, "<span class='sinister'>Are you feeling lucky?</span>" );
			}
			return false;
		}

	}

}