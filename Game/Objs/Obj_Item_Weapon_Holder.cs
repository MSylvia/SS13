// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Item_Weapon_Holder : Obj_Item_Weapon {

		public Ent_Static stored_mob = null;
		public bool update_itemstate_on_twohand = false;
		public string itemstate_twohand_suffix = "_2hand";

		protected override void __FieldInit() {
			base.__FieldInit();

			this.inhand_states = new ByTable().Set( "left_hand", "icons/mob/in-hand/left/mob_holders.dmi" ).Set( "right_hand", "icons/mob/in-hand/right/mob_holders.dmi" );
		}

		// Function from file: holders.dm
		public Obj_Item_Weapon_Holder ( dynamic loc = null, Ent_Static M = null ) : base( (object)(loc) ) {
			// Warning: Super call was HERE! If anything above HERE is needed by the super call, it might break!;
			GlobalVars.processing_objects.Add( this );

			if ( M != null ) {
				M.loc = this;
				this.stored_mob = M;
			}
			return;
		}

		// Function from file: holders.dm
		public override void update_wield( dynamic user = null ) {
			base.update_wield( (object)(user) );

			if ( this.update_itemstate_on_twohand ) {
				this.item_state = "" + Lang13.Initial( this, "item_state" ) + ( Lang13.Bool( this.wielded ) ? GlobalVars.itemstate_twohand_suffix : "" );

				if ( Lang13.Bool( user ) ) {
					((Mob)user).update_inv_l_hand();
					((Mob)user).update_inv_r_hand();
				}
			}
			return;
		}

		// Function from file: holders.dm
		public override dynamic attackby( dynamic a = null, dynamic b = null, dynamic c = null ) {
			dynamic M = null;

			
			foreach (dynamic _a in Lang13.Enumerate( this.contents )) {
				M = _a;
				
				((Ent_Static)M).attackby( a, b );
			}
			return null;
		}

		// Function from file: holders.dm
		public override dynamic relaymove( Mob M = null, double? direction = null ) {
			GlobalFuncs.returnToPool( this );
			return null;
		}

		// Function from file: holders.dm
		public override dynamic process(  ) {
			
			if ( !( this.loc != null ) ) {
				GlobalFuncs.returnToPool( this ); return null;
			} else if ( this.loc is Tile || !( this.contents.len != 0 ) ) {
				GlobalFuncs.returnToPool( this ); return null;
			}
			return null;
		}

		// Function from file: holders.dm
		public override dynamic Destroy( dynamic brokenup = null ) {
			Ent_Static A = null;
			dynamic M = null;

			
			if ( this.loc is Mob_Living ) {
				A = this.loc;
				new ByTable().Set( 1, this ).Set( "force_drop", 1 ).Apply( Lang13.BindFunc( A, "drop_item" ) );
				((dynamic)A).update_icons();
			}

			foreach (dynamic _a in Lang13.Enumerate( this.contents )) {
				M = _a;
				
				((Ent_Dynamic)M).forceMove( GlobalFuncs.get_turf( this ) );

				if ( Lang13.Bool( M.client ) ) {
					M.client.eye = M;
				}
			}
			GlobalVars.processing_objects.Remove( this );
			base.Destroy( (object)(brokenup) );
			return null;
		}

	}

}