// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Item_Weapon_Grenade_Spawnergrenade : Obj_Item_Weapon_Grenade {

		public Type spawner_type = null;
		public int? deliveryamt = 1;

		protected override void __FieldInit() {
			base.__FieldInit();

			this.origin_tech = "materials=3;magnets=4";
			this.icon_state = "delivery";
		}

		public Obj_Item_Weapon_Grenade_Spawnergrenade ( dynamic loc = null ) : base( (object)(loc) ) {
			
		}

		// Function from file: spawnergrenade.dm
		public override void prime(  ) {
			dynamic T = null;
			Mob_Living_Carbon C = null;
			int? i = null;
			dynamic x = null;
			int? j = null;

			this.update_mob();

			if ( this.spawner_type != null && Lang13.Bool( this.deliveryamt ) ) {
				T = GlobalFuncs.get_turf( this );
				GlobalFuncs.playsound( T, "sound/effects/phasein.ogg", 100, 1 );

				foreach (dynamic _a in Lang13.Enumerate( Map13.FetchViewers( null, T ), typeof(Mob_Living_Carbon) )) {
					C = _a;
					
					C.flash_eyes();
				}
				i = null;
				i = 1;

				while (( i ??0) <= ( this.deliveryamt ??0)) {
					x = Lang13.Call( this.spawner_type );
					x.loc = T;

					if ( Rand13.PercentChance( 50 ) ) {
						j = null;
						j = 1;

						while (( j ??0) <= Rand13.Int( 1, 3 )) {
							Map13.Step( x, Convert.ToInt32( Rand13.Pick(new object [] { GlobalVars.NORTH, GlobalVars.SOUTH, GlobalVars.EAST, GlobalVars.WEST }) ) );
							j++;
						}
					}
					i++;
				}
			}
			GlobalFuncs.qdel( this );
			return;
		}

	}

}