// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Item_Projectile_Spur : Obj_Item_Projectile {

		protected override void __FieldInit() {
			base.__FieldInit();

			this.kill_count = 100;
			this.damage = 40;
			this.custom_impact = true;
			this.linear_movement = false;
			this.icon = "icons/obj/projectiles_experimental.dmi";
			this.icon_state = "spur_high";
			this.layer = 13;
		}

		public Obj_Item_Projectile_Spur ( dynamic loc = null ) : base( (object)(loc) ) {
			
		}

		// Function from file: bullets.dm
		public override void process_step(  ) {
			Ent_Static T = null;
			Image impact = null;

			
			if ( ( this.kill_count ??0) <= 0 ) {
				
				if ( this.loc != null ) {
					T = this.loc;
					impact = new Image( "icons/obj/projectiles_impacts.dmi", this.loc, "spur_2" );
					impact.layer = 13;
					T.overlays.Add( impact );
					Task13.Schedule( 3, (Task13.Closure)(() => {
						T.overlays.Remove( impact );
						return;
					}));
				}
			}
			base.process_step();
			return;
		}

		// Function from file: bullets.dm
		public override dynamic Bump(Ent_Static Obstacle = null, dynamic yes = null) {
			Ent_Static T = null;
			string impact_icon = null;
			string impact_sound = null;
			int PixelX = 0;
			int PixelY = 0;
			Image impact = null;
			Obj M = null;

			
			if ( this.loc != null ) {
				T = this.loc;
				impact_icon = null;
				impact_sound = null;
				PixelX = 0;
				PixelY = 0;

				switch ((int)( Map13.GetDistance( this, Obstacle ) )) {
					case 1:
						PixelY = 16;
						break;
					case 2:
						PixelY = -16;
						break;
					case 4:
						PixelX = 16;
						break;
					case 8:
						PixelX = -16;
						break;
				}

				if ( Obstacle is Mob ) {
					impact_icon = "spur_3";
					impact_sound = "sound/weapons/spur_hitmob.ogg";
				} else {
					impact_icon = "spur_1";
					impact_sound = "sound/weapons/spur_hitwall.ogg";
				}
				impact = new Image( "icons/obj/projectiles_impacts.dmi", this.loc, impact_icon );
				impact.pixel_x = PixelX;
				impact.pixel_y = PixelY;
				impact.layer = 13;
				T.overlays.Add( impact );
				Task13.Schedule( 3, (Task13.Closure)(() => {
					T.overlays.Remove( impact );
					return;
				}));
				GlobalFuncs.playsound( this.loc, impact_sound, 30, 1 );
			}

			if ( Obstacle is Tile_Unsimulated_Mineral ) {
				M = Obstacle;
				((dynamic)M).GetDrilled();
			}

			if ( Obstacle is Obj_Structure_Boulder ) {
				GlobalFuncs.returnToPool( Obstacle );
			}
			return base.Bump( Obstacle );
		}

		// Function from file: bullets.dm
		public override bool OnFired(  ) {
			Obj_Item_Weapon_Gun_Energy_Polarstar quote = null;

			base.OnFired();
			quote = this.shot_from;

			if ( !( quote != null ) || !( quote is Obj_Item_Weapon_Gun_Energy_Polarstar_Spur ) ) {
				return false;
			}

			switch ((int)( quote.firelevel )) {
				case 4:
				case 3:
					this.icon_state = "spur_high";
					this.damage = 40;
					this.kill_count = 20;
					break;
				case 2:
					this.icon_state = "spur_medium";
					this.damage = 30;
					this.kill_count = 13;
					break;
				case 1:
				case 0:
					this.icon_state = "spur_low";
					this.damage = 20;
					this.kill_count = 7;
					break;
			}
			return false;
		}

	}

}