// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Item_Weapon_Melee_ClassicBaton : Obj_Item_Weapon_Melee {

		protected override void __FieldInit() {
			base.__FieldInit();

			this.inhand_states = new ByTable().Set( "left_hand", "icons/mob/in-hand/left/misc_tools.dmi" ).Set( "right_hand", "icons/mob/in-hand/right/misc_tools.dmi" );
			this.item_state = "classic_baton";
			this.origin_tech = "combat=3";
			this.mech_flags = 1;
			this.slot_flags = 512;
			this.force = 10;
			this.icon_state = "baton";
		}

		public Obj_Item_Weapon_Melee_ClassicBaton ( dynamic loc = null ) : base( (object)(loc) ) {
			
		}

		// Function from file: swords_axes_etc.dm
		public override bool? attack( dynamic M = null, dynamic user = null, string def_zone = null, bool? eat_override = null ) {
			dynamic H = null;
			dynamic O = null;
			dynamic O2 = null;

			Interface13.Stat( null, user.mutations.Contains( 5 ) );

			if ( false && Rand13.PercentChance( 50 ) ) {
				GlobalFuncs.to_chat( user, "<span class='warning'>You club yourself over the head.</span>" );
				((Mob)user).Weaken( this.force * 3 );

				if ( user is Mob_Living_Carbon_Human ) {
					H = user;
					((Mob_Living)H).apply_damage( this.force * 2, "brute", "head" );
				} else {
					((Mob_Living)user).take_organ_damage( this.force * 2 );
				}
				return null;
			}

			if ( user.a_intent == "hurt" ) {
				
				if ( !( base.attack( (object)(M), (object)(user), def_zone, eat_override ) == true ) ) {
					return null;
				}
				GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "swing_hit", 50, 1, -1 );

				if ( Convert.ToDouble( M.stuttering ) < 8 && !false ) {
					M.stuttering = 8;
				}
				((Mob)M).Stun( 8 );
				((Mob)M).Weaken( 8 );

				foreach (dynamic _a in Lang13.Enumerate( Map13.FetchViewers( null, M ) )) {
					O = _a;
					

					if ( Lang13.Bool( O.client ) ) {
						O.show_message( new Txt( "<span class='danger'>" ).item( M ).str( " has been beaten with " ).the( this ).item().str( " by " ).item( user ).str( "!</span>" ).ToString(), 1, "<span class='warning'>You hear someone fall</span>", 2 );
					}
				}
			} else {
				GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/weapons/Genhit.ogg", 50, 1, -1 );
				((Mob)M).Stun( 5 );
				((Mob)M).Weaken( 5 );
				M.attack_log.Add( "[" + GlobalFuncs.time_stamp() + "] <font color='orange'>Has been attacked with " + this.name + " by " + user.name + " (" + user.ckey + ")</font>" );
				user.attack_log.Add( "[" + GlobalFuncs.time_stamp() + "] <font color='red'>Used the " + this.name + " to attack " + M.name + " (" + M.ckey + ")</font>" );
				GlobalVars.diaryofmeanpeople.WriteMsg( String13.HtmlDecode( "[" + GlobalFuncs.time_stamp() + "]ATTACK: " + ( "<font color='red'>" + user.name + " (" + user.ckey + ") attacked " + M.name + " (" + M.ckey + ") with " + this.name + " (INTENT: " + String13.ToUpper( user.a_intent ) + ")</font>" ) ) );

				if ( !( user is Mob_Living_Carbon ) ) {
					M.LAssailant = null;
				} else {
					M.LAssailant = user;
				}
				this.add_fingerprint( user );

				foreach (dynamic _b in Lang13.Enumerate( Map13.FetchViewers( null, M ) )) {
					O2 = _b;
					

					if ( Lang13.Bool( O2.client ) ) {
						O2.show_message( new Txt( "<span class='danger'>" ).item( M ).str( " has been stunned with " ).the( this ).item().str( " by " ).item( user ).str( "!</span>" ).ToString(), 1, "<span class='warning'>You hear someone fall</span>", 2 );
					}
				}
			}
			return null;
		}

	}

}