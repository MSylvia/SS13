// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Structure_Computerframe : Obj_Structure {

		public int state = 0;
		public dynamic circuit = null;

		protected override void __FieldInit() {
			base.__FieldInit();

			this.icon = "icons/obj/stock_parts.dmi";
			this.icon_state = "0";
		}

		public Obj_Structure_Computerframe ( dynamic loc = null ) : base( (object)(loc) ) {
			
		}

		// Function from file: buildandrepair.dm
		public override dynamic attackby( dynamic a = null, dynamic b = null, dynamic c = null ) {
			dynamic WT = null;
			Game_Data M = null;
			dynamic B = null;
			dynamic C = null;
			dynamic G = null;
			dynamic B2 = null;
			dynamic SC = null;
			dynamic C2 = null;
			dynamic arcade = null;
			dynamic C3 = null;

			
			switch ((int)( this.state )) {
				case 0:
					
					if ( a is Obj_Item_Weapon_Wrench ) {
						GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/items/Ratchet.ogg", 50, 1 );

						if ( GlobalFuncs.do_after( b, this, 5 ) && this.state == 0 ) {
							GlobalFuncs.to_chat( b, "<span class='notice'>You wrench the frame into place.</span>" );
							this.anchored = 1;
							this.state = 1;
						}
						return 1;
					}

					if ( a is Obj_Item_Weapon_Weldingtool ) {
						WT = a;

						if ( !Lang13.Bool( WT.remove_fuel( 0, b ) ) ) {
							GlobalFuncs.to_chat( b, "The welding tool must be on to complete this task." );
							return 1;
						}
						GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/items/welder.ogg", 50, 1 );

						if ( GlobalFuncs.do_after( b, this, 10 ) && this.state == 0 ) {
							
							if ( !( this != null ) || !((Obj_Item_Weapon_Weldingtool)WT).isOn() ) {
								return null;
							}
							GlobalFuncs.to_chat( b, "<span class='notice'>You deconstruct the frame.</span>" );
							M = GlobalFuncs.getFromPool( typeof(Obj_Item_Stack_Sheet_Metal), this.loc );
							((dynamic)M).amount = 5;
							this.state = -1;
							GlobalFuncs.qdel( this );
						}
						return 1;
					}
					break;
				case 1:
					
					if ( a is Obj_Item_Weapon_Wrench ) {
						GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/items/Ratchet.ogg", 50, 1 );

						if ( GlobalFuncs.do_after( b, this, 20 ) && this.state == 1 ) {
							GlobalFuncs.to_chat( b, "<span class='notice'>You unfasten the frame.</span>" );
							this.anchored = 0;
							this.state = 0;
						}
						return 1;
					}

					if ( a is Obj_Item_Weapon_Circuitboard && !Lang13.Bool( this.circuit ) ) {
						B = a;

						if ( B.board_type == "computer" ) {
							
							if ( !Lang13.Bool( b.drop_item( B, this ) ) ) {
								return null;
							}
							GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/items/Deconstruct.ogg", 50, 1 );
							GlobalFuncs.to_chat( b, "<span class='notice'>You place the circuit board inside the frame.</span>" );
							this.icon_state = "1";
							this.circuit = a;
						} else {
							GlobalFuncs.to_chat( b, "<span class='warning'>This frame does not accept circuit boards of this type!</span>" );
						}
						return 1;
					}

					if ( a is Obj_Item_Weapon_Screwdriver && Lang13.Bool( this.circuit ) ) {
						GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/items/Screwdriver.ogg", 50, 1 );
						GlobalFuncs.to_chat( b, "<span class='notice'>You screw the circuit board into place.</span>" );
						this.state = 2;
						this.icon_state = "2";
						return 1;
					}

					if ( a is Obj_Item_Weapon_Crowbar && Lang13.Bool( this.circuit ) ) {
						GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/items/Crowbar.ogg", 50, 1 );
						GlobalFuncs.to_chat( b, "<span class='notice'>You remove the circuit board.</span>" );
						this.state = 1;
						this.icon_state = "0";
						this.circuit.loc = this.loc;
						this.circuit = null;
						return 1;
					}
					break;
				case 2:
					
					if ( a is Obj_Item_Weapon_Screwdriver && Lang13.Bool( this.circuit ) ) {
						GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/items/Screwdriver.ogg", 50, 1 );
						GlobalFuncs.to_chat( b, "<span class='notice'>You unfasten the circuit board.</span>" );
						this.state = 1;
						this.icon_state = "1";
						return 1;
					}

					if ( a is Obj_Item_Stack_CableCoil ) {
						C = a;

						if ( Convert.ToDouble( C.amount ) < 5 ) {
							GlobalFuncs.to_chat( b, "<span class='warning'>You need at least 5 lengths of cable coil for this!</span>" );
							return 1;
						}
						GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/items/Deconstruct.ogg", 50, 1 );

						if ( GlobalFuncs.do_after( b, this, 20 ) && this.state == 2 && Convert.ToDouble( C.amount ) >= 5 ) {
							C.use( 5 );
							GlobalFuncs.to_chat( b, "<span class='notice'>You add cables to the frame.</span>" );
							this.state = 3;
							this.icon_state = "3";
						}
						return 1;
					}
					break;
				case 3:
					
					if ( a is Obj_Item_Weapon_Wirecutters ) {
						GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/items/Wirecutter.ogg", 50, 1 );
						GlobalFuncs.to_chat( b, "<span class='notice'>You remove the cables.</span>" );
						this.state = 2;
						this.icon_state = "2";
						GlobalFuncs.getFromPool( typeof(Obj_Item_Stack_CableCoil), GlobalFuncs.get_turf( this ), 5 );
						return 1;
					}

					if ( a is Obj_Item_Stack_Sheet_Glass_Glass ) {
						G = a;

						if ( Convert.ToDouble( G.amount ) < 2 ) {
							GlobalFuncs.to_chat( b, "<span class='warning'>You need at least 2 sheets of glass for this!</span>" );
							return 1;
						}
						GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/items/Deconstruct.ogg", 50, 1 );

						if ( GlobalFuncs.do_after( b, this, 20 ) && this.state == 3 && Convert.ToDouble( G.amount ) >= 2 ) {
							G.use( 2 );
							GlobalFuncs.to_chat( b, "<span class='notice'>You put in the glass panel.</span>" );
							this.state = 4;
							this.icon_state = "4";
						}
						return 1;
					}
					break;
				case 4:
					
					if ( a is Obj_Item_Weapon_Crowbar ) {
						GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/items/Crowbar.ogg", 50, 1 );
						GlobalFuncs.to_chat( b, "<span class='notice'>You remove the glass panel.</span>" );
						this.state = 3;
						this.icon_state = "3";
						new Obj_Item_Stack_Sheet_Glass_Glass( this.loc, 2 );
						return 1;
					}

					if ( a is Obj_Item_Weapon_Screwdriver ) {
						GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/items/Screwdriver.ogg", 50, 1 );
						GlobalFuncs.to_chat( b, "<span class='notice'>You connect the monitor.</span>" );
						B2 = Lang13.Call( this.circuit.build_path, this.loc );

						if ( Lang13.Bool( this.circuit.powernet ) ) {
							B2.powernet = this.circuit.powernet;
						}

						if ( Lang13.Bool( this.circuit.id_tag ) ) {
							B2.id_tag = this.circuit.id_tag;
						}

						if ( Lang13.Bool( this.circuit.records ) ) {
							B2.records = this.circuit.records;
						}

						if ( Lang13.Bool( this.circuit.frequency ) ) {
							B2.frequency = this.circuit.frequency;
						}

						if ( this.circuit is Obj_Item_Weapon_Circuitboard_Supplycomp ) {
							SC = B2;
							C2 = this.circuit;
							SC.can_order_contraband = C2.contraband_enabled;
						} else if ( this.circuit is Obj_Item_Weapon_Circuitboard_Arcade ) {
							arcade = B2;
							C3 = this.circuit;
							((Obj_Machinery_Computer_Arcade)arcade).import_game_data( C3 );
						}
						GlobalFuncs.qdel( this );
						return 1;
					}
					break;
			}
			return 0;
		}

		// Function from file: buildandrepair.dm
		public override dynamic Destroy( dynamic brokenup = null ) {
			base.Destroy( (object)(brokenup) );
			GlobalFuncs.qdel( this.circuit );
			this.circuit = null;
			return null;
		}

	}

}