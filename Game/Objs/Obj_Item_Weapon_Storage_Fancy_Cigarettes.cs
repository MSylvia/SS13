// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Item_Weapon_Storage_Fancy_Cigarettes : Obj_Item_Weapon_Storage_Fancy {

		protected override void __FieldInit() {
			base.__FieldInit();

			this.item_state = "cigpacket";
			this.w_class = 1;
			this.slot_flags = 512;
			this.storage_slots = 6;
			this.can_hold = new ByTable(new object [] { typeof(Obj_Item_Clothing_Mask_Cigarette), typeof(Obj_Item_Weapon_Lighter) });
			this.icon_type = "cigarette";
			this.spawn_type = typeof(Obj_Item_Clothing_Mask_Cigarette);
			this.icon = "icons/obj/cigarettes.dmi";
			this.icon_state = "cig";
		}

		// Function from file: fancy.dm
		public Obj_Item_Weapon_Storage_Fancy_Cigarettes ( dynamic loc = null ) : base( (object)(loc) ) {
			// Warning: Super call was HERE! If anything above HERE is needed by the super call, it might break!;
			this.flags |= 16384;
			this.create_reagents( ( this.storage_slots ??0) * 15 );
			return;
		}

		// Function from file: fancy.dm
		public override bool attack( dynamic M = null, dynamic user = null, bool? def_zone = null ) {
			dynamic cig = null;
			dynamic W = null;

			
			if ( !( M is Mob ) ) {
				return false;
			}
			cig = Lang13.FindIn( typeof(Obj_Item_Clothing_Mask_Cigarette), this.contents );

			if ( Lang13.Bool( cig ) ) {
				
				if ( M == user && this.contents.len > 0 && !Lang13.Bool( user.wear_mask ) ) {
					W = cig;
					this.remove_from_storage( W, M );
					((Mob)M).equip_to_slot_if_possible( W, 2 );
					this.contents.Remove( W );
					user.WriteMsg( "<span class='notice'>You take a " + this.icon_type + " out of the pack.</span>" );
				} else {
					base.attack( (object)(M), (object)(user), def_zone );
				}
			} else {
				user.WriteMsg( "<span class='notice'>There are no " + this.icon_type + "s left in the pack.</span>" );
			}
			return false;
		}

		// Function from file: fancy.dm
		public override bool remove_from_storage( dynamic W = null, dynamic new_location = null, bool? burn = null ) {
			
			if ( W is Obj_Item_Clothing_Mask_Cigarette ) {
				
				if ( this.reagents != null ) {
					this.reagents.trans_to( W, ( this.reagents.total_volume ??0) / this.contents.len );
				}
			}
			base.remove_from_storage( (object)(W), (object)(new_location), burn );
			return false;
		}

		// Function from file: fancy.dm
		public override bool update_icon( dynamic new_state = null, dynamic new_icon = null, int? new_px = null, int? new_py = null ) {
			int? c = null;

			this.overlays.Cut();
			this.icon_state = Lang13.Initial( this, "icon_state" );

			if ( !( this.contents.len != 0 ) ) {
				this.icon_state += "_empty";
			} else {
				this.overlays.Add( "" + this.icon_state + "_open" );
				c = null;
				c = this.contents.len;

				while (( c ??0) >= 1) {
					this.overlays.Add( new Image( this.icon, null, "cigarette", null, null, ( c ??0) - 1 ) );
					c--;
				}
			}
			return false;
		}

	}

}