// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Effect_Spawner_Lootdrop : Obj_Effect_Spawner {

		public bool lootcount = true;
		public bool lootdoubles = false;
		public string loot = "";

		protected override void __FieldInit() {
			base.__FieldInit();

			this.icon = "icons/mob/screen1.dmi";
			this.icon_state = "x2";
		}

		public Obj_Effect_Spawner_Lootdrop ( dynamic loc = null ) : base( (object)(loc) ) {
			
		}

		// Function from file: loot.dm
		public override bool initialize( bool? suppress_icon_check = null ) {
			ByTable things = null;
			int? i = null;
			dynamic loot_spawn = null;
			Type loot_path = null;

			things = String13.ParseUrlParams( this.loot );

			if ( things != null && things.len != 0 ) {
				i = null;
				i = this.lootcount ?1:0;

				while (( i ??0) > 0) {
					
					if ( !( things.len != 0 ) ) {
						return false;
					}
					loot_spawn = Rand13.PickFromTable( things );
					loot_path = Lang13.FindClass( loot_spawn );

					if ( !( loot_path != null ) || !this.lootdoubles ) {
						things.Remove( loot_spawn );
					} else {
						Lang13.Call( loot_path, GlobalFuncs.get_turf( this ) );
					}
					i--;
				}
			}
			GlobalFuncs.qdel( this );
			return false;
		}

	}

}