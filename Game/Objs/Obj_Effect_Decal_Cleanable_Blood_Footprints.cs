// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Effect_Decal_Cleanable_Blood_Footprints : Obj_Effect_Decal_Cleanable_Blood {

		public int entered_dirs = 0;
		public int exited_dirs = 0;
		public ByTable shoe_types = new ByTable();

		protected override void __FieldInit() {
			base.__FieldInit();

			this.random_icon_states = null;
			this.icon = "icons/effects/footprints.dmi";
			this.icon_state = "nothingwhatsoever";
		}

		public Obj_Effect_Decal_Cleanable_Blood_Footprints ( dynamic loc = null ) : base( (object)(loc) ) {
			
		}

		// Function from file: humans.dm
		public override int can_bloodcrawl_in(  ) {
			
			if ( this.blood_state != "oil" && this.blood_state != "no blood whatsoever" ) {
				return 1;
			}
			return 0;
		}

		// Function from file: humans.dm
		public override void replace_decal( Obj_Effect_Decal_Cleanable C = null ) {
			
			if ( this.blood_state != C.blood_state ) {
				return;
			}
			base.replace_decal( C );
			return;
		}

		// Function from file: humans.dm
		public override double examine( dynamic user = null ) {
			double _default = 0;

			dynamic shoe = null;
			dynamic S = null;

			_default = base.examine( (object)(user) );

			if ( this.shoe_types.len != 0 ) {
				_default += /*[I CANNOT CONVERT SOME RANDOM SHIT TO A DOUBLE: string]*/ 0;

				foreach (dynamic _a in Lang13.Enumerate( this.shoe_types )) {
					shoe = _a;
					
					S = shoe;
					_default += /*[I CANNOT CONVERT SOME RANDOM SHIT TO A DOUBLE: string]*/ 0;
				}
			}
			user.WriteMsg( _default );
			return _default;
		}

		// Function from file: humans.dm
		public override bool update_icon( dynamic new_state = null, dynamic new_icon = null, int? new_px = null, int? new_py = null ) {
			dynamic Ddir = null;
			Image I = null;
			Image I2 = null;

			this.overlays.Cut();

			foreach (dynamic _a in Lang13.Enumerate( GlobalVars.cardinal )) {
				Ddir = _a;
				

				if ( ( this.entered_dirs & Convert.ToInt32( Ddir ) ) != 0 ) {
					I = null;

					if ( Lang13.Bool( GlobalVars.bloody_footprints_cache["entered-" + this.blood_state + "-" + Ddir] ) ) {
						I = GlobalVars.bloody_footprints_cache["entered-" + this.blood_state + "-" + Ddir];
					} else {
						I = new Image( this.icon, "" + this.blood_state + "1", null, null, Ddir );
						GlobalVars.bloody_footprints_cache["entered-" + this.blood_state + "-" + Ddir] = I;
					}

					if ( I != null ) {
						this.overlays.Add( I );
					}
				}

				if ( ( this.exited_dirs & Convert.ToInt32( Ddir ) ) != 0 ) {
					I2 = null;

					if ( Lang13.Bool( GlobalVars.bloody_footprints_cache["exited-" + this.blood_state + "-" + Ddir] ) ) {
						I2 = GlobalVars.bloody_footprints_cache["exited-" + this.blood_state + "-" + Ddir];
					} else {
						I2 = new Image( this.icon, "" + this.blood_state + "2", null, null, Ddir );
						GlobalVars.bloody_footprints_cache["exited-" + this.blood_state + "-" + Ddir] = I2;
					}

					if ( I2 != null ) {
						this.overlays.Add( I2 );
					}
				}
			}
			this.alpha = this.bloodiness + 150;
			return false;
		}

		// Function from file: humans.dm
		public override void Uncrossed( Ent_Dynamic O = null ) {
			Ent_Dynamic H = null;
			Obj_Item_Clothing_Shoes S = null;

			
			if ( O is Mob_Living_Carbon_Human ) {
				H = O;
				S = ((dynamic)H).shoes;

				if ( S != null && Lang13.Bool( S.bloody_shoes[this.blood_state] ) ) {
					S.bloody_shoes[this.blood_state] = Num13.MaxInt( Convert.ToInt32( S.bloody_shoes[this.blood_state] - 5 ), 0 );
					this.exited_dirs |= H.dir;
					this.shoe_types.Or( ((dynamic)H).shoes.type );
				}
			}
			this.update_icon();
			return;
		}

		// Function from file: humans.dm
		public override dynamic Crossed( Ent_Dynamic O = null, dynamic X = null ) {
			Ent_Dynamic H = null;
			Obj_Item_Clothing_Shoes S = null;

			
			if ( O is Mob_Living_Carbon_Human ) {
				H = O;
				S = ((dynamic)H).shoes;

				if ( S != null && Lang13.Bool( S.bloody_shoes[this.blood_state] ) ) {
					S.bloody_shoes[this.blood_state] = Num13.MaxInt( Convert.ToInt32( S.bloody_shoes[this.blood_state] - 5 ), 0 );
					this.entered_dirs |= H.dir;
					this.shoe_types.Or( ((dynamic)H).shoes.type );
				}
			}
			this.update_icon();
			return null;
		}

	}

}