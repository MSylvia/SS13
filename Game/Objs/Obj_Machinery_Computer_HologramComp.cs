// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Machinery_Computer_HologramComp : Obj_Machinery_Computer {

		public dynamic projector = null;
		public dynamic temp = null;
		public double lumens = 0;
		public double h_r = 245;
		public double h_g = 245;
		public double h_b = 245;

		protected override void __FieldInit() {
			base.__FieldInit();

			this.icon_state = "holo_console0";
		}

		// Function from file: hologram.dm
		public Obj_Machinery_Computer_HologramComp ( dynamic loc = null ) : base( (object)(loc) ) {
			// Warning: Super call was HERE! If anything above HERE is needed by the super call, it might break!;
			Task13.Schedule( 10, (Task13.Closure)(() => {
				this.projector = Lang13.FindIn( typeof(Obj_Machinery_Hologram_Projector), Map13.GetStep( this.loc, ((int)( GlobalVars.NORTH )) ) );
				return;
				return;
			}));
			return;
		}

		// Function from file: hologram.dm
		public override dynamic Topic( string href = null, ByTable href_list = null, dynamic hclient = null, HtmlInterface currui = null ) {
			dynamic M = null;

			
			if ( Lang13.Bool( base.Topic( href, href_list, (object)(hclient) ) ) ) {
				return 1;
			} else {
				Icon13.Flick( "holo_console1", this );

				if ( Lang13.Bool( href_list["power"] ) ) {
					
					if ( this.projector.hologram != null ) {
						this.projector.icon_state = "hologram0";
						GlobalFuncs.qdel( this.projector.hologram );
						this.projector.hologram = null;
					} else {
						this.projector.hologram = new Obj_Effect_Overlay( this.projector.loc );
						this.projector.hologram.icon = "icons/mob/human.dmi";
						this.projector.hologram.icon_state = "body_m_s";
						this.projector.icon_state = "hologram1";
						this.render();
					}
				} else if ( Lang13.Bool( href_list["h_r"] ) ) {
					
					if ( this.projector.hologram != null ) {
						this.h_r += String13.ParseNumber( href_list["h_r"] ) ??0;
						this.h_r = Num13.MinInt( Num13.MaxInt( ((int)( this.h_r )), 0 ), 255 );
						this.render();
					}
				} else if ( Lang13.Bool( href_list["h_g"] ) ) {
					
					if ( this.projector.hologram != null ) {
						this.h_g += String13.ParseNumber( href_list["h_g"] ) ??0;
						this.h_g = Num13.MinInt( Num13.MaxInt( ((int)( this.h_g )), 0 ), 255 );
						this.render();
					}
				} else if ( Lang13.Bool( href_list["h_b"] ) ) {
					
					if ( this.projector.hologram != null ) {
						this.h_b += String13.ParseNumber( href_list["h_b"] ) ??0;
						this.h_b = Num13.MinInt( Num13.MaxInt( ((int)( this.h_b )), 0 ), 255 );
						this.render();
					}
				} else if ( Lang13.Bool( href_list["light"] ) ) {
					
					if ( this.projector.hologram != null ) {
						this.lumens += String13.ParseNumber( href_list["light"] ) ??0;
						this.lumens = Num13.MinInt( Num13.MaxInt( ((int)( this.lumens )), -185 ), 35 );
						this.render();
					}
				} else if ( Lang13.Bool( href_list["reset"] ) ) {
					
					if ( this.projector.hologram != null ) {
						this.lumens = 0;
						this.render();
					}
				} else if ( Lang13.Bool( href_list["temp"] ) ) {
					this.temp = null;
				}

				foreach (dynamic _a in Lang13.Enumerate( Map13.FetchViewers( this, 1 ) )) {
					M = _a;
					

					if ( Lang13.Bool( M.client ) && M.machine == this ) {
						this.show_console( M );
					}
				}
			}
			return null;
		}

		// Function from file: hologram.dm
		public void show_console( dynamic user = null ) {
			string dat = null;

			((Mob)user).set_machine( this );

			if ( Lang13.Bool( this.temp ) ) {
				dat = new Txt().item( this.temp ).str( "<BR><BR><A href='?src=" ).Ref( this ).str( ";temp=1'>Clear</A>" ).ToString();
			} else {
				dat = new Txt( "<B>Hologram Status:</B><HR>\nPower: <A href='?src=" ).Ref( this ).str( ";power=1'>" ).item( ( this.projector.hologram != null ? "On" : "Off" ) ).str( "</A><HR>\n<B>Hologram Control:</B><BR>\nColor Luminosity: " ).item( -this.lumens + 35 ).str( "/220 <A href='?src=" ).Ref( this ).str( ";reset=1'>[Reset]</A><BR>\nLighten: <A href='?src=" ).Ref( this ).str( ";light=1'>1</A> <A href='?src=" ).Ref( this ).str( ";light=10'>10</A><BR>\nDarken: <A href='?src=" ).Ref( this ).str( ";light=-1'>1</A> <A href='?src=" ).Ref( this ).str( ";light=-10'>10</A><BR>\n<BR>\nHair Color: (" ).item( this.h_r ).str( "," ).item( this.h_g ).str( "," ).item( this.h_b ).str( ") <A href='?src=" ).Ref( this ).str( ";h_reset=1'>[Reset]</A><BR>\nRed (0-255): <A href='?src=" ).Ref( this ).str( ";h_r=-300'>[0]</A> <A href='?src=" ).Ref( this ).str( ";h_r=-10'>-10</A> <A href='?src=" ).Ref( this ).str( ";h_r=-1'>-1</A> " ).item( this.h_r ).str( " <A href='?src=" ).Ref( this ).str( ";h_r=1'>1</A> <A href='?src=" ).Ref( this ).str( ";h_r=10'>10</A> <A href='?src=" ).Ref( this ).str( ";h_r=300'>[255]</A><BR>\nGreen (0-255): <A href='?src=" ).Ref( this ).str( ";h_g=-300'>[0]</A> <A href='?src=" ).Ref( this ).str( ";h_g=-10'>-10</A> <A href='?src=" ).Ref( this ).str( ";h_g=-1'>-1</A> " ).item( this.h_g ).str( " <A href='?src=" ).Ref( this ).str( ";h_g=1'>1</A> <A href='?src=" ).Ref( this ).str( ";h_g=10'>10</A> <A href='?src=" ).Ref( this ).str( ";h_g=300'>[255]</A><BR>\nBlue (0-255): <A href='?src=" ).Ref( this ).str( ";h_b=-300'>[0]</A> <A href='?src=" ).Ref( this ).str( ";h_b=-10'>-10</A> <A href='?src=" ).Ref( this ).str( ";h_b=-1'>-1</A> " ).item( this.h_b ).str( " <A href='?src=" ).Ref( this ).str( ";h_b=1'>1</A> <A href='?src=" ).Ref( this ).str( ";h_b=10'>10</A> <A href='?src=" ).Ref( this ).str( ";h_b=300'>[255]</A><BR>" ).ToString();
			}
			Interface13.Browse( user, dat, "window=hologram_console" );
			GlobalFuncs.onclose( user, "hologram_console" );
			return;
		}

		// Function from file: hologram.dm
		public void render(  ) {
			Icon I = null;
			Icon U = null;

			I = new Icon( "icons/mob/human.dmi", "body_m_s" );

			if ( this.lumens >= 0 ) {
				I.Blend( String13.ColorCode( ((int)( this.lumens )), ((int)( this.lumens )), ((int)( this.lumens )) ), 0 );
			} else {
				I.Blend( String13.ColorCode( ((int)( -this.lumens )), ((int)( -this.lumens )), ((int)( -this.lumens )) ), 1 );
			}
			I.Blend( new Icon( "icons/mob/human.dmi", "mouth_m_s" ), 3 );
			I.Blend( new Icon( "icons/mob/human.dmi", "underwear1_m_s" ), 3 );
			U = new Icon( "icons/mob/human_face.dmi", "hair_a_s" );
			U.Blend( String13.ColorCode( ((int)( this.h_r )), ((int)( this.h_g )), ((int)( this.h_b )) ), 0 );
			I.Blend( U, 3 );
			this.projector.hologram.icon = I;
			return;
		}

		// Function from file: hologram.dm
		public override bool DblClick( dynamic _object = null, string location = null, string control = null, dynamic _params = null ) {
			
			if ( !GlobalFuncs.in_range( this, Task13.User ) ) {
				return false;
			}
			this.show_console( Task13.User );
			return false;
		}

	}

}