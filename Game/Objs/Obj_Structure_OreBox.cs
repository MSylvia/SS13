// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Structure_OreBox : Obj_Structure {

		protected override void __FieldInit() {
			base.__FieldInit();

			this.pressure_resistance = 506.625;
			this.icon = "icons/obj/mining.dmi";
			this.icon_state = "orebox";
		}

		public Obj_Structure_OreBox ( dynamic loc = null ) : base( (object)(loc) ) {
			
		}

		// Function from file: satchel_ore_boxdm.dm
		public override bool ex_act( double? severity = null, dynamic target = null ) {
			
			if ( Rand13.PercentChance( ((int)( 100 / ( severity ??0) )) ) && ( severity ??0) < 3 ) {
				GlobalFuncs.qdel( this );
			}
			return false;
		}

		// Function from file: satchel_ore_boxdm.dm
		public override dynamic Topic( string href = null, ByTable href_list = null, dynamic hsrc = null ) {
			Obj_Item_Weapon_Ore O = null;

			
			if ( Lang13.Bool( base.Topic( href, href_list, (object)(hsrc) ) ) ) {
				return null;
			}
			Task13.User.set_machine( this );
			this.add_fingerprint( Task13.User );

			if ( Lang13.Bool( href_list["removeall"] ) ) {
				
				foreach (dynamic _a in Lang13.Enumerate( this.contents, typeof(Obj_Item_Weapon_Ore) )) {
					O = _a;
					
					this.contents.Remove( O );
					O.loc = this.loc;
				}
				Task13.User.WriteMsg( "<span class='notice'>You empty the box.</span>" );
			}
			this.updateUsrDialog();
			return null;
		}

		// Function from file: satchel_ore_boxdm.dm
		public override dynamic attack_hand( dynamic a = null, bool? b = null, bool? c = null ) {
			int amt_gold = 0;
			int amt_silver = 0;
			int amt_diamond = 0;
			int amt_glass = 0;
			int amt_iron = 0;
			int amt_plasma = 0;
			int amt_uranium = 0;
			int amt_clown = 0;
			int amt_bluespace = 0;
			Obj_Item_Weapon_Ore C = null;
			string dat = null;

			amt_gold = 0;
			amt_silver = 0;
			amt_diamond = 0;
			amt_glass = 0;
			amt_iron = 0;
			amt_plasma = 0;
			amt_uranium = 0;
			amt_clown = 0;
			amt_bluespace = 0;

			foreach (dynamic _a in Lang13.Enumerate( this.contents, typeof(Obj_Item_Weapon_Ore) )) {
				C = _a;
				

				if ( C is Obj_Item_Weapon_Ore_Diamond ) {
					amt_diamond++;
				}

				if ( C is Obj_Item_Weapon_Ore_Glass ) {
					amt_glass++;
				}

				if ( C is Obj_Item_Weapon_Ore_Plasma ) {
					amt_plasma++;
				}

				if ( C is Obj_Item_Weapon_Ore_Iron ) {
					amt_iron++;
				}

				if ( C is Obj_Item_Weapon_Ore_Silver ) {
					amt_silver++;
				}

				if ( C is Obj_Item_Weapon_Ore_Gold ) {
					amt_gold++;
				}

				if ( C is Obj_Item_Weapon_Ore_Uranium ) {
					amt_uranium++;
				}

				if ( C is Obj_Item_Weapon_Ore_Bananium ) {
					amt_clown++;
				}

				if ( C is Obj_Item_Weapon_Ore_BluespaceCrystal ) {
					amt_bluespace++;
				}
			}
			dat = "<b>The contents of the ore box reveal...</b><br>";

			if ( amt_gold != 0 ) {
				dat += "Gold ore: " + amt_gold + "<br>";
			}

			if ( amt_silver != 0 ) {
				dat += "Silver ore: " + amt_silver + "<br>";
			}

			if ( amt_iron != 0 ) {
				dat += "Metal ore: " + amt_iron + "<br>";
			}

			if ( amt_glass != 0 ) {
				dat += "Sand: " + amt_glass + "<br>";
			}

			if ( amt_diamond != 0 ) {
				dat += "Diamond ore: " + amt_diamond + "<br>";
			}

			if ( amt_plasma != 0 ) {
				dat += "Plasma ore: " + amt_plasma + "<br>";
			}

			if ( amt_uranium != 0 ) {
				dat += "Uranium ore: " + amt_uranium + "<br>";
			}

			if ( amt_clown != 0 ) {
				dat += "Bananium ore: " + amt_clown + "<br>";
			}

			if ( amt_bluespace != 0 ) {
				dat += "Bluespace crystals: " + amt_bluespace + "<br>";
			}
			dat += new Txt( "<br><br><A href='?src=" ).Ref( this ).str( ";removeall=1'>Empty box</A>" ).ToString();
			Interface13.Browse( a, "" + dat, "window=orebox" );
			return null;
		}

		// Function from file: satchel_ore_boxdm.dm
		public override dynamic attackby( dynamic A = null, dynamic user = null, string _params = null, bool? silent = null, bool? replace_spent = null ) {
			dynamic S = null;
			Obj_Item_Weapon_Ore O = null;

			
			if ( A is Obj_Item_Weapon_Ore ) {
				
				if ( !Lang13.Bool( user.drop_item() ) ) {
					return null;
				}
				A.loc = this;
			}

			if ( A is Obj_Item_Weapon_Storage ) {
				S = A;
				((Obj_Item_Weapon_Storage)S).hide_from( Task13.User );

				foreach (dynamic _a in Lang13.Enumerate( S.contents, typeof(Obj_Item_Weapon_Ore) )) {
					O = _a;
					
					((Obj_Item_Weapon_Storage)S).remove_from_storage( O, this );
				}
				user.WriteMsg( "<span class='notice'>You empty the satchel into the box.</span>" );
			}
			return null;
		}

	}

}