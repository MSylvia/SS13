// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Machinery_Telecomms_Receiver : Obj_Machinery_Telecomms {

		protected override void __FieldInit() {
			base.__FieldInit();

			this.anchored = 1;
			this.idle_power_usage = 30;
			this.machinetype = 1;
			this.heatgen = 0;
			this.circuitboard = "/obj/item/weapon/circuitboard/telecomms/receiver";
			this.icon_state = "broadcast receiver";
		}

		public Obj_Machinery_Telecomms_Receiver ( dynamic loc = null ) : base( (object)(loc) ) {
			
		}

		// Function from file: telecomunications.dm
		public bool check_receive_level( Game_Data signal = null ) {
			Obj_Machinery_Telecomms_Hub H = null;
			ByTable connected_levels = null;
			Obj_Machinery_Telecomms_Relay R = null;

			
			if ( Convert.ToInt32( ((dynamic)signal).data["level"] ) != this.listening_level ) {
				
				foreach (dynamic _b in Lang13.Enumerate( this.links, typeof(Obj_Machinery_Telecomms_Hub) )) {
					H = _b;
					
					connected_levels = new ByTable();

					foreach (dynamic _a in Lang13.Enumerate( H.links, typeof(Obj_Machinery_Telecomms_Relay) )) {
						R = _a;
						

						if ( R.can_receive( signal ) ) {
							connected_levels.Or( R.listening_level );
						}
					}
					Interface13.Stat( null, connected_levels.Contains( ((dynamic)signal).data["level"] ) );

					if ( H is Obj_Machinery_Telecomms_Hub ) {
						return true;
					}
				}
				return false;
			}
			return true;
		}

		// Function from file: telecomunications.dm
		public override bool receive_signal( Game_Data signal = null, bool? receive_method = null, dynamic receive_param = null ) {
			int? can_send = null;

			
			if ( !this.on ) {
				return false;
			}

			if ( !( signal != null ) ) {
				return false;
			}

			if ( !this.check_receive_level( signal ) ) {
				return false;
			}

			if ( Convert.ToInt32( ((dynamic)signal).transmission_method ) == 2 ) {
				
				if ( this.is_freq_listening( signal ) ) {
					((dynamic)signal).data["level"] = new ByTable();
					can_send = this.relay_information( signal, "/obj/machinery/telecomms/hub" );

					if ( !Lang13.Bool( can_send ) ) {
						this.relay_information( signal, "/obj/machinery/telecomms/bus" );
					}
				}
			}
			return false;
		}

	}

}