// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Item_AmmoBox_Magazine_Internal_Cylinder : Obj_Item_AmmoBox_Magazine_Internal {

		protected override void __FieldInit() {
			base.__FieldInit();

			this.ammo_type = typeof(Obj_Item_AmmoCasing_A357);
			this.caliber = "357";
		}

		public Obj_Item_AmmoBox_Magazine_Internal_Cylinder ( dynamic loc = null ) : base( (object)(loc) ) {
			
		}

		// Function from file: magazines.dm
		public override bool give_round( dynamic R = null, bool? replace_spent = null ) {
			replace_spent = replace_spent ?? false;

			double i = 0;
			Obj_Item_AmmoCasing bullet = null;

			
			if ( !Lang13.Bool( R ) || Lang13.Bool( this.caliber ) && R.caliber != this.caliber || !Lang13.Bool( this.caliber ) && R.type != this.ammo_type ) {
				return false;
			}

			foreach (dynamic _a in Lang13.IterateRange( 1, this.stored_ammo.len )) {
				i = _a;
				
				bullet = this.stored_ammo[i];

				if ( !( bullet != null ) || !Lang13.Bool( bullet.BB ) ) {
					this.stored_ammo[i] = R;
					R.loc = this;

					if ( bullet != null ) {
						bullet.loc = GlobalFuncs.get_turf( this.loc );
					}
					return true;
				}
			}
			return false;
		}

		// Function from file: magazines.dm
		public void spin(  ) {
			double i = 0;

			
			foreach (dynamic _a in Lang13.IterateRange( 1, Rand13.Int( 0, ( this.max_ammo ??0) * 2 ) )) {
				i = _a;
				
				this.rotate();
			}
			return;
		}

		// Function from file: magazines.dm
		public void rotate(  ) {
			dynamic b = null;
            Console.WriteLine(">>>> Please check out Obj_Item_AmmoBox_Magazine_Internal_Cylinder.rotate() to see if bullets are emptying properly."); //-Pdan
			b = this.stored_ammo[1];        //1 
			this.stored_ammo.Cut( 2, 3 );       //1, 2
            this.stored_ammo.Insert( 1, b );        //0, b
			return;
		}

		// Function from file: magazines.dm
		public override dynamic get_round( bool? keep = null ) {
			keep = keep ?? false;

			dynamic b = null;

			this.rotate();
			b = this.stored_ammo[1];

			if ( !( keep == true ) ) {
				this.stored_ammo[1] = null;
			}
			return b;
		}

		// Function from file: magazines.dm
		public override int ammo_count( bool? countempties = null ) {
			countempties = countempties ?? true;

			int boolets = 0;
			Obj_Item_AmmoCasing bullet = null;

			boolets = 0;

			foreach (dynamic _a in Lang13.Enumerate( this.stored_ammo, typeof(Obj_Item_AmmoCasing) )) {
				bullet = _a;
				

				if ( bullet != null && ( Lang13.Bool( bullet.BB ) || countempties == true ) ) {
					boolets++;
				}
			}
			return boolets;
		}

	}

}