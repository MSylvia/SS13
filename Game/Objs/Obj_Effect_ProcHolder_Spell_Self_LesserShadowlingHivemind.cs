// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Effect_ProcHolder_Spell_Self_LesserShadowlingHivemind : Obj_Effect_ProcHolder_Spell_Self {

		protected override void __FieldInit() {
			base.__FieldInit();

			this.panel = "Thrall Abilities";
			this.charge_max = 50;
			this.human_req = 1;
			this.clothes_req = 0;
			this.action_icon_state = "commune";
		}

		public Obj_Effect_ProcHolder_Spell_Self_LesserShadowlingHivemind ( dynamic loc = null ) : base( (object)(loc) ) {
			
		}

		// Function from file: shadowling_abilities.dm
		public override bool cast( dynamic targets = null, dynamic thearea = null, dynamic user = null ) {
			string text = null;
			dynamic M = null;

			
			if ( !GlobalFuncs.is_shadow_or_thrall( targets ) ) {
				targets.WriteMsg( "<span class='warning'><b>As you attempt to commune with the others, an agonizing spike of pain drives itself into your head!</b></span>" );
				targets.apply_damage( 10, "brute", "head" );
				return false;
			}
			text = GlobalFuncs.stripped_input( targets, "What do you want to say your masters and fellow thralls?.", "Lesser Commune", "" );

			if ( !Lang13.Bool( text ) ) {
				return false;
			}
			text = "<span class='shadowling'><b>[Thrall]</b><i> " + targets.real_name + "</i>: " + text + "</span>";

			foreach (dynamic _a in Lang13.Enumerate( GlobalVars.mob_list )) {
				M = _a;
				

				if ( GlobalFuncs.is_shadow_or_thrall( M ) ) {
					M.WriteMsg( text );
				}

				if ( M is Mob_Dead_Observer ) {
					M.WriteMsg( new Txt( "<a href='?src=" ).Ref( M ).str( ";follow=" ).Ref( targets ).str( "'>(F)</a> " ).item( text ).ToString() );
				}
			}
			GlobalFuncs.log_say( "" + targets.real_name + "/" + targets.key + " : " + text );
			return false;
		}

	}

}