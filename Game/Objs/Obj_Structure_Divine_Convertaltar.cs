// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Structure_Divine_Convertaltar : Obj_Structure_Divine {

		protected override void __FieldInit() {
			base.__FieldInit();

			this.metal_cost = 15;
			this.can_buckle = 1;
			this.icon_state = "convertaltar";
		}

		public Obj_Structure_Divine_Convertaltar ( dynamic loc = null ) : base( (object)(loc) ) {
			
		}

		// Function from file: structures.dm
		public override dynamic attack_hand( dynamic a = null, bool? b = null, bool? c = null ) {
			dynamic H = null;

			base.attack_hand( (object)(a), b, c );
			H = Lang13.FindIn( typeof(Mob_Living_Carbon_Human), GlobalFuncs.get_turf( this ) );

			if ( !GlobalFuncs.is_handofgod_cultist( a ) ) {
				a.WriteMsg( "<span class='notice'>You try to use it, but unfortunately you don't know any rituals.</span>" );
				return null;
			}

			if ( !Lang13.Bool( H ) ) {
				return null;
			}

			if ( !Lang13.Bool( H.mind ) ) {
				a.WriteMsg( "<span class='danger'>Only sentients may serve your deity.</span>" );
				return null;
			}

			if ( this.side == "red" && GlobalFuncs.is_handofgod_redcultist( a ) && !GlobalFuncs.is_handofgod_redcultist( H ) || this.side == "blue" && GlobalFuncs.is_handofgod_bluecultist( a ) && !GlobalFuncs.is_handofgod_bluecultist( H ) ) {
				a.WriteMsg( "<span class='notice'>You invoke the conversion ritual.</span>" );
				((GameMode)GlobalVars.ticker.mode).add_hog_follower( H.mind, this.side );
			} else {
				a.WriteMsg( "<span class='notice'>You invoke the conversion ritual.</span>" );
				a.WriteMsg( "<span class='danger'>But the altar ignores your words...</span>" );
			}
			return null;
		}

	}

}