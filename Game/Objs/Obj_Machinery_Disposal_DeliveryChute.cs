// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Machinery_Disposal_DeliveryChute : Obj_Machinery_Disposal {

		protected override void __FieldInit() {
			base.__FieldInit();

			this.mode = 0;
			this.icon_state = "intake";
		}

		// Function from file: disposal-unit.dm
		public Obj_Machinery_Disposal_DeliveryChute ( dynamic loc = null, Obj_Structure_Disposalconstruct make_from = null ) : base( (object)(loc), make_from ) {
			// Warning: Super call was HERE! If anything above HERE is needed by the super call, it might break!;
			((dynamic)this.stored).ptype = 8;
			Task13.Schedule( 5, (Task13.Closure)(() => {
				this.trunk = Lang13.FindIn( typeof(Obj_Structure_Disposalpipe_Trunk), loc );

				if ( Lang13.Bool( this.trunk ) ) {
					this.trunk.linked = this;
				}
				return;
			}));
			return;
		}

		// Function from file: disposal-unit.dm
		public override void newHolderDestination( Obj_Structure_Disposalholder H = null ) {
			H.destinationTag = 1;
			return;
		}

		// Function from file: disposal-unit.dm
		public override bool Bumped( dynamic AM = null ) {
			dynamic O = null;
			dynamic M = null;

			
			if ( !((Ent_Dynamic)AM).disposalEnterTry() ) {
				return false;
			}

			switch ((int)( this.dir )) {
				case 1:
					
					if ( AM.loc.y != this.loc.y + 1 ) {
						return false;
					}
					break;
				case 4:
					
					if ( AM.loc.x != this.loc.x + 1 ) {
						return false;
					}
					break;
				case 2:
					
					if ( AM.loc.y != this.loc.y - 1 ) {
						return false;
					}
					break;
				case 8:
					
					if ( AM.loc.x != this.loc.x - 1 ) {
						return false;
					}
					break;
			}

			if ( AM is Obj ) {
				O = AM;
				O.loc = this;
			} else if ( AM is Mob ) {
				M = AM;

				if ( Rand13.PercentChance( 2 ) ) {
					M.WriteMsg( "<span class='warning'>You hit the edge of the chute.</span>" );
					return false;
				}
				((Ent_Dynamic)M).forceMove( this );
			}
			this.f_flush();
			return false;
		}

	}

}