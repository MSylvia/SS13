// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Item_Weapon_Organ : Obj_Item_Weapon {

		public dynamic organ_data = null;
		public Dna owner_dna = null;
		public string part = "organ";
		public ByTable butchering_drops = new ByTable();

		protected override void __FieldInit() {
			base.__FieldInit();

			this.icon = "icons/mob/human_races/r_human.dmi";
		}

		// Function from file: organ_external.dm
		public Obj_Item_Weapon_Organ ( dynamic loc = null, Mob_Living_Carbon_Human H = null ) : base( (object)(loc) ) {
			Icon _base = null;
			ButcheringProduct B = null;
			dynamic new_bp = null;

			// Warning: Super call was HERE! If anything above HERE is needed by the super call, it might break!;

			if ( !( H is Mob_Living_Carbon_Human ) ) {
				return;
			}

			if ( H.dna != null ) {
				this.owner_dna = H.dna.Clone();

				if ( !( this.blood_DNA != null ) ) {
					this.blood_DNA = new ByTable();
				}
				this.blood_DNA[H.dna.unique_enzymes] = H.dna.b_type;
			}

			if ( Lang13.Bool( H.species ) && Lang13.Bool( H.species.icobase ) ) {
				_base = new Icon( H.species.icobase );
			} else {
				_base = new Icon( "icons/mob/human_races/r_human.dmi" );
			}

			if ( _base != null ) {
				
				if ( !Lang13.Bool( H.species ) || Lang13.Bool( H.species.flags & 16 ) ) {
					
					if ( ( H.s_tone ??0) >= 0 ) {
						_base.Blend( String13.ColorCode( ((int)( H.s_tone ??0 )), ((int)( H.s_tone ??0 )), ((int)( H.s_tone ??0 )) ), 0 );
					} else {
						_base.Blend( String13.ColorCode( ((int)( -( H.s_tone ??0) )), ((int)( -( H.s_tone ??0) )), ((int)( -( H.s_tone ??0) )) ), 1 );
					}
				}
			}
			this.icon = _base;
			this.dir = ((int)( GlobalVars.SOUTH ));
			this.transform = Num13.Rotate( this.transform, Rand13.Int( 70, 130 ) );

			foreach (dynamic _a in Lang13.Enumerate( H.butchering_drops, typeof(ButcheringProduct) )) {
				B = _a;
				

				if ( B.stored_in_organ == this.part ) {
					new_bp = Lang13.Call( B.type );
					new_bp.amount = B.amount;
					B.amount = 0;
					this.butchering_drops.Add( new_bp );
				}
			}
			return;
		}

		// Function from file: organ_external.dm
		public override dynamic examine( dynamic user = null, string size = null ) {
			string butchery = null;
			ButcheringProduct B = null;

			base.examine( (object)(user), size );

			if ( this.butchering_drops.len != 0 ) {
				
				foreach (dynamic _a in Lang13.Enumerate( this.butchering_drops, typeof(ButcheringProduct) )) {
					B = _a;
					
					butchery = "" + butchery + B.desc_modifier( this, user );
				}
			}

			if ( Lang13.Bool( butchery ) ) {
				GlobalFuncs.to_chat( user, "<span class='warning'>" + butchery + "</span>" );
			}
			return null;
		}

	}

}