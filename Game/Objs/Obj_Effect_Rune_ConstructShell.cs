// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Effect_Rune_ConstructShell : Obj_Effect_Rune {

		protected override void __FieldInit() {
			base.__FieldInit();

			this.color = "#969696";
			this.cultist_name = "Fabricate Shell";
			this.cultist_desc = "Turns five plasteel sheets into an empty construct shell, suitable for containing a soul shard.";
			this.invocation = null;
			this.icon_state = "5";
		}

		public Obj_Effect_Rune_ConstructShell ( dynamic loc = null ) : base( (object)(loc) ) {
			
		}

		// Function from file: runes.dm
		public override void invoke( dynamic user = null ) {
			dynamic T = null;
			Obj_Item_Stack_Sheet S = null;
			Obj_Item_Stack_Sheet M = null;

			T = GlobalFuncs.get_turf( this );

			foreach (dynamic _a in Lang13.Enumerate( T, typeof(Obj_Item_Stack_Sheet) )) {
				S = _a;
				

				if ( S is Obj_Item_Stack_Sheet_Plasteel ) {
					M = S;

					if ( ( M.amount ??0) >= 5 ) {
						((Ent_Dynamic)user).say( "Ethra p'ni dedol!" );
						new Obj_Structure_Constructshell( T );
						M.visible_message( "<span class='warning'>" + M + " bends and twists into a humanoid shell!</span>" );
						M.amount -= 5;

						if ( ( M.amount ??0) <= 0 ) {
							GlobalFuncs.qdel( M );
						}
						GlobalFuncs.qdel( this );
						return;
					} else {
						user.WriteMsg( "<span class='cultitalic'>There must be at least five sheets of plasteel on " + this + "!</span>" );
						this.fail_invoke();
						GlobalFuncs.log_game( "Construct Shell rune failed - not enough plasteel sheets" );
						return;
					}
				}
			}
			return;
		}

	}

}