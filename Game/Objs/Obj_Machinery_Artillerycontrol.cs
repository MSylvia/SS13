// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Machinery_Artillerycontrol : Obj_Machinery {

		public int reload = 180;

		protected override void __FieldInit() {
			base.__FieldInit();

			this.anchored = 1;
			this.icon = "icons/obj/machines/particle_accelerator.dmi";
			this.icon_state = "control_boxp1";
		}

		public Obj_Machinery_Artillerycontrol ( dynamic loc = null ) : base( (object)(loc) ) {
			
		}

		// Function from file: bluespaceartillery.dm
		public override dynamic Topic( string href = null, ByTable href_list = null, dynamic hclient = null, HtmlInterface currui = null ) {
			dynamic A = null;
			Base_Data thearea = null;
			ByTable L = null;
			dynamic T = null;
			dynamic loc = null;

			
			if ( Lang13.Bool( base.Topic( href, href_list, (object)(hclient) ) ) ) {
				return 1;
			} else {
				A = Interface13.Input( "Area to jump bombard", "Open Fire", A, null, GlobalVars.teleportlocs, InputType.Any );
				thearea = GlobalVars.teleportlocs[A];

				if ( Lang13.Bool( Task13.User.stat ) || Task13.User.restrained() ) {
					return null;
				}

				if ( this.reload < 180 ) {
					return null;
				}

				if ( Task13.User.contents.Find( this ) != 0 || GlobalFuncs.in_range( this, Task13.User ) && this.loc is Tile || Task13.User is Mob_Living_Silicon ) {
					GlobalFuncs.command_alert( "Bluespace artillery fire detected. Brace for impact." );
					GlobalFuncs.message_admins( "" + GlobalFuncs.key_name_admin( Task13.User ) + " has launched an artillery strike." );
					L = new ByTable();

					foreach (dynamic _a in Lang13.Enumerate( GlobalFuncs.get_area_turfs( thearea.type ) )) {
						T = _a;
						
						L.Add( T );
					}
					loc = Rand13.PickFromTable( L );
					GlobalFuncs.explosion( loc, 2, 5, 11 );
					this.reload = 0;
				}
			}
			return null;
		}

		// Function from file: bluespaceartillery.dm
		public override dynamic attack_hand( dynamic a = null, dynamic b = null, dynamic c = null ) {
			string dat = null;

			((Mob)a).set_machine( this );
			dat = "<B>Bluespace Artillery Control:</B><BR>";
			dat += new Txt( "Locked on<BR>\n		<B>Charge progress: " ).item( this.reload ).str( "/180:</B><BR>\n		<A href='byond://?src=" ).Ref( this ).str( ";fire=1'>Open Fire</A><BR>\n		Deployment of weapon authorized by <br>Nanotrasen Naval Command<br><br>Remember, friendly fire is grounds for termination of your contract and life.<HR>" ).ToString();
			Interface13.Browse( a, dat, "window=scroll" );
			GlobalFuncs.onclose( a, "scroll" );
			return null;
		}

		// Function from file: bluespaceartillery.dm
		public override dynamic process(  ) {
			
			if ( this.reload < 180 ) {
				this.reload++;
			}
			return null;
		}

	}

}