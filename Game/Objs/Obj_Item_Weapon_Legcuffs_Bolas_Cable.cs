// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Item_Weapon_Legcuffs_Bolas_Cable : Obj_Item_Weapon_Legcuffs_Bolas {

		public dynamic weight1 = null;
		public dynamic weight2 = null;
		public string cable_color = "";
		public string desc_empty = "A poorly made bolas, tied together with cable. It has nothing on it.";
		public dynamic screw_state = "";
		public string screw_istate = "";

		protected override void __FieldInit() {
			base.__FieldInit();

			this.throw_range = 6;
			this.trip_prob = 10;
		}

		// Function from file: weapon.dm
		public Obj_Item_Weapon_Legcuffs_Bolas_Cable ( dynamic loc = null ) : base( (object)(loc) ) {
			// Warning: Super call was HERE! If anything above HERE is needed by the super call, it might break!;
			this.desc = this.desc_empty;
			this.weight1 = null;
			this.weight2 = null;
			this.update_icon();
			return;
		}

		// Function from file: weapon.dm
		public override dynamic attackby( dynamic a = null, dynamic b = null, dynamic c = null ) {
			dynamic I = null;
			Obj_Item_Stack_CableCoil C = null;
			Obj_Item_Weapon_Screwdriver S = null;

			
			if ( a is Obj_Item ) {
				
				if ( a is Obj_Item_Weapon_Gift || a is Obj_Item_Delivery ) {
					return null;
				}
				I = a;

				if ( a is Obj_Item_Weapon_Legcuffs_Bolas ) {
					return null;
				}

				if ( I is Obj_Item_Weapon_Wirecutters ) {
					
					if ( !Lang13.Bool( this.weight1 ) && !Lang13.Bool( this.weight2 ) ) {
						b.show_message( "<span class='notice'>You cut the knot in the " + this + ".</span>" );
						GlobalFuncs.playsound( Task13.User, "sound/items/Wirecutter.ogg", 50, 1 );
						C = new Obj_Item_Stack_CableCoil( b.loc );
						S = new Obj_Item_Weapon_Screwdriver( b.loc );
						C.amount = 10;
						C._color = this.cable_color;
						C.icon_state = "coil_" + C._color;
						C.update_icon();
						S.item_state = this.screw_state;
						S.icon_state = this.screw_istate;
						S.update_icon();
						((Mob)b).put_in_hands( S );
						GlobalFuncs.qdel( this );
						return null;
					} else {
						b.show_message( "<span class='notice'>You cut off " + this.weight1 + " " + ( Lang13.Bool( this.weight2 ) ? "and " + this.weight2 : "" ) + ".</span>" );

						if ( Lang13.Bool( this.weight1 ) ) {
							this.weight1.loc = GlobalFuncs.get_turf( Task13.User );
							this.weight1 = null;
						}

						if ( Lang13.Bool( this.weight2 ) ) {
							this.weight2.loc = GlobalFuncs.get_turf( Task13.User );
							this.weight2 = null;
						}
						GlobalFuncs.playsound( b, "sound/items/Wirecutter.ogg", 50, 1 );
						this.update_icon();
						return null;
					}
				}

				if ( Lang13.Bool( I.w_class ) ) {
					
					if ( I.w_class == 2 || I.w_class == 3 ) {
						
						if ( !Lang13.Bool( this.weight1 ) ) {
							
							if ( Lang13.Bool( b.drop_item( I, this ) ) ) {
								this.weight1 = I;
								b.show_message( "<span class='notice'>You tie " + this.weight1 + " to the " + this + ".</span>" );
								this.update_icon();
								return null;
							}
						}

						if ( !Lang13.Bool( this.weight2 ) ) {
							
							if ( Lang13.Bool( b.drop_item( I, this ) ) ) {
								this.weight2 = I;
								b.show_message( "<span class='notice'>You tie " + this.weight2 + " to the " + this + ".</span>" );
								this.update_icon();
								return null;
							}
						} else {
							b.show_message( "<span class='rose'>There are already two weights on this " + this + "!</span>" );
							return null;
						}
					} else if ( Convert.ToDouble( I.w_class ) < 2 ) {
						b.show_message( new Txt( "<span class='rose'>" ).The( I ).item().str( " is too small to be used as a weight.</span>" ).ToString() );
					} else if ( Convert.ToDouble( I.w_class ) > 3 ) {
						b.show_message( new Txt( "<span class='rose'>" ).The( I ).item().str( " is " ).item( ( Convert.ToDouble( I.w_class ) > 4 ? "far " : "" ) ).str( " too big to be used a weight.</span>" ).ToString() );
					} else {
						b.show_message( "<span class='rose'>There are already two weights on this " + this + "!</span>" );
					}
				}
			}
			return null;
		}

		// Function from file: weapon.dm
		public override void throw_failed(  ) {
			
			if ( Rand13.PercentChance( 20 ) ) {
				this.visible_message( new Txt( "<span class='rose'>" ).The( this ).item().str( " falls to pieces on impact!</span>" ).ToString() );

				if ( Lang13.Bool( this.weight1 ) ) {
					this.weight1.loc = this.loc;
					this.weight1 = null;
				}

				if ( Lang13.Bool( this.weight2 ) ) {
					this.weight2.loc = this.loc;
					this.weight2 = null;
				}
				this.update_icon( this );
			}
			return;
		}

		// Function from file: weapon.dm
		public override bool? update_icon( dynamic location = null, dynamic target = null ) {
			
			if ( !Lang13.Bool( this.weight1 ) && !Lang13.Bool( this.weight2 ) ) {
				this.icon_state = "cbolas_" + this.cable_color;
				this.overlays.len = 0;
				this.desc = this.desc_empty;
				this.trip_prob = 0;
				return null;
			} else {
				this.overlays.len = 0;

				if ( Lang13.Bool( this.weight1 ) ) {
					this.trip_prob = 10;
					this.overlays.Add( new Icon( "icons/obj/weapons.dmi", "cbolas_weight1" ) );
				}

				if ( Lang13.Bool( this.weight2 ) ) {
					this.trip_prob = 30;
					this.overlays.Add( new Icon( "icons/obj/weapons.dmi", "cbolas_weight2" ) );
				}
				this.desc = new Txt( "A poorly made bolas, made out of " ).a( this.weight1 ).item().str( " and " ).item( ( Lang13.Bool( this.weight2 ) ? new Txt().a( this.weight2 ).item().ToString() : "missing a second weight" ) ).str( ", tied together with cable." ).ToString();
			}
			return null;
		}

	}

}