// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Tile_Unsimulated_Wall_Supermatter : Tile_Unsimulated_Wall {

		public bool spawned = false;
		public int next_check = 0;
		public ByTable avail_dirs = new ByTable(new object [] { 1, 2, 4, 8 });

		protected override void __FieldInit() {
			base.__FieldInit();

			this.dynamic_lighting = false;
			this.icon = "icons/turf/space.dmi";
			this.icon_state = "bluespace";
			this.layer = 11;
		}

		// Function from file: blob.dm
		public Tile_Unsimulated_Wall_Supermatter ( dynamic loc = null ) : base( (object)(loc) ) {
			GlobalVars.processing_objects.Or( this );
			// Warning: Super call was HERE! If anything above HERE is needed by the super call, it might break!;
			return;
		}

		// Function from file: blob.dm
		public void Consume( dynamic user = null ) {
			
			if ( user is Mob_Dead_Observer ) {
				return;
			}
			GlobalFuncs.qdel( user );
			return;
		}

		// Function from file: blob.dm
		public override bool Bumped( Ent_Static AM = null, dynamic yes = null ) {
			
			if ( AM is Mob_Living ) {
				AM.visible_message( new Txt( "<span class=\"warning\">" ).The( AM ).item().str( " slams into " ).the( this ).item().str( " inducing a resonance... " ).his_her_its_their().str( " body starts to glow and catch flame before flashing into ash.</span>" ).ToString(), new Txt( "<span class=\"danger\">You slam into " ).the( this ).item().str( " as your ears are filled with unearthly ringing. Your last thought is \"Oh, fuck.\"</span>" ).ToString(), "<span class=\"warning\">You hear an unearthly noise as a wave of heat washes over you.</span>" );
			} else {
				AM.visible_message( new Txt( "<span class=\"warning\">" ).The( AM ).item().str( " smacks into " ).the( this ).item().str( " and rapidly flashes to ash.</span>" ).ToString(), "<span class=\"warning\">You hear a loud crack as you are washed with a wave of heat.</span>" );
			}
			GlobalFuncs.playsound( this, "sound/effects/supermatter.ogg", 50, 1 );
			this.Consume( AM );
			return false;
		}

		// Function from file: blob.dm
		public override dynamic attackby( dynamic a = null, dynamic b = null, dynamic c = null ) {
			((Ent_Static)b).visible_message( new Txt( "<span class=\"warning\">" ).The( b ).item().str( " touches " ).a( a ).item().str( " to " ).the( this ).item().str( " as a silence fills the room...</span>" ).ToString(), new Txt( "<span class=\"danger\">You touch " ).the( a ).item().str( " to " ).the( this ).item().str( " when everything suddenly goes silent.\"</span>\n<span class=\"notice\">" ).The( a ).item().str( " flashes into dust as you flinch away from " ).the( this ).item().str( ".</span>" ).ToString(), "<span class=\"warning\">Everything suddenly goes silent.</span>" );
			GlobalFuncs.playsound( this, "sound/effects/supermatter.ogg", 50, 1 );
			((Mob)b).drop_from_inventory( a );
			this.Consume( a );
			return null;
		}

		// Function from file: blob.dm
		public override dynamic attack_hand( dynamic a = null, dynamic b = null, dynamic c = null ) {
			((Ent_Static)a).visible_message( new Txt( "<span class=\"warning\">" ).The( a ).item().str( " reaches out and touches " ).the( this ).item().str( "... And then blinks out of existance.</span>" ).ToString(), new Txt( "<span class=\"danger\">You reach out and touch " ).the( this ).item().str( ". Everything immediately goes quiet. Your last thought is \"That was not a wise decision.\"</span>" ).ToString(), "<span class=\"warning\">You hear an unearthly noise.</span>" );
			GlobalFuncs.playsound( this, "sound/effects/supermatter.ogg", 50, 1 );
			this.Consume( a );
			return null;
		}

		// Function from file: blob.dm
		public override dynamic attack_ai( dynamic user = null ) {
			return user.__CallVerb("Examine", this );
		}

		// Function from file: blob.dm
		public override dynamic attack_ghost( Mob_Dead_Observer user = null ) {
			user.__CallVerb("Examine", this );
			return null;
		}

		// Function from file: blob.dm
		public override dynamic attack_robot( Mob_Living_Silicon_Robot user = null ) {
			
			if ( this.Adjacent( user ) ) {
				return this.attack_hand( user );
			} else {
				GlobalFuncs.to_chat( user, "<span class = \"warning\">What the fuck are you doing?</span>" );
			}
			return null;
		}

		// Function from file: blob.dm
		public override dynamic attack_paw( Mob a = null, dynamic b = null, dynamic c = null ) {
			return this.attack_hand( a );
		}

		// Function from file: blob.dm
		public override bool process(  ) {
			dynamic pdir = null;
			Tile T = null;
			Ent_Dynamic A = null;

			
			if ( this.next_check > Game13.time ) {
				return false;
			}

			if ( this.avail_dirs.len == 0 ) {
				GlobalVars.processing_objects.Remove( this );
				return true;
			}
			this.next_check = Game13.time + 50;
			pdir = Rand13.PickFromTable( this.avail_dirs );
			this.avail_dirs.Remove( pdir );
			T = Map13.GetStep( this, Convert.ToInt32( pdir ) );

			if ( T is Tile ) {
				new Obj_Effect_Overlay_Bluespacify( T );
				Task13.Schedule( 10, (Task13.Closure)(() => {
					
					foreach (dynamic _a in Lang13.Enumerate( T, typeof(Ent_Dynamic) )) {
						A = _a;
						

						if ( A != null ) {
							
							if ( A is Mob_Living ) {
								GlobalFuncs.qdel( A );
								A = null;
							} else if ( A is Mob ) {
								continue;
							}
							GlobalFuncs.qdel( A );
							A = null;
						}

						if ( Game13.cpu > 80 ) {
							Task13.Sleep( ((int)( Game13.tick_lag )) );
						}
					}
					T.ChangeTurf( this.type );
					return;
				}));
			}

			if ( ( ( this.spawned ?1:0) & 15 ) == 15 ) {
				GlobalVars.processing_objects.Remove( this );
				return false;
			}
			return false;
		}

		// Function from file: blob.dm
		public override dynamic Destroy( dynamic brokenup = null ) {
			GlobalVars.processing_objects.Remove( this );
			return base.Destroy( (object)(brokenup) );
		}

	}

}