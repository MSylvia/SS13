// FILE AUTOGENERATED BY SOM13. DO NOT EDIT YET.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class EffectSystem_ExplParticles : EffectSystem {

		protected override void __FieldInit() {
			base.__FieldInit();

			this.number = 10;
		}

		// Function from file: effects_explosion.dm
		public override void start(  ) {
			double i = 0;
			Obj_Effect_ParticleEffect_ExplParticles expl = null;
			dynamic direct = null;
			dynamic steps_amt = null;
			double j = 0;

			
			foreach (dynamic _b in Lang13.IterateRange( 1, this.number )) {
				i = _b;
				
				Task13.Schedule( 0, (Task13.Closure)(() => {
					expl = new Obj_Effect_ParticleEffect_ExplParticles( this.location );
					direct = Rand13.PickFromTable( GlobalVars.alldirs );
					steps_amt = Rand13.PickWeighted(new object [] { 612, 25, 1836, 50, 63083, 3, 65535, 200 });

					foreach (dynamic _a in Lang13.IterateRange( 1, steps_amt )) {
						j = _a;
						
						Task13.Sleep( 1 );
						Map13.Step( expl, Convert.ToInt32( direct ) );
					}
					return;
				}));
			}
			return;
		}

	}

}