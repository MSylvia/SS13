// FILE AUTOGENERATED BY SOM13. DO NOT EDIT YET.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Machinery_Firealarm_Partyalarm : Obj_Machinery_Firealarm {

		public Obj_Machinery_Firealarm_Partyalarm ( dynamic loc = null, dynamic ndir = null, dynamic building = null ) : base( (object)(loc), (object)(ndir), (object)(building) ) {
			
		}

		// Function from file: alarm.dm
		public override void alarm(  ) {
			Ent_Static A = null;
			dynamic RA = null;

			
			if ( ( this.stat & 3 ) != 0 ) {
				return;
			}
			A = this.loc;
			A = A.loc;

			if ( !( A is Zone ) ) {
				return;
			}

			foreach (dynamic _a in Lang13.Enumerate( ((dynamic)A).related )) {
				RA = _a;
				
				((Zone)RA).partyalert();
			}
			return;
		}

		// Function from file: alarm.dm
		public override void reset(  ) {
			Ent_Static A = null;
			dynamic RA = null;

			
			if ( ( this.stat & 3 ) != 0 ) {
				return;
			}
			A = this.loc;
			A = A.loc;

			if ( !( A is Zone ) ) {
				return;
			}

			foreach (dynamic _a in Lang13.Enumerate( ((dynamic)A).related )) {
				RA = _a;
				
				((Zone)RA).partyreset();
			}
			return;
		}

		// Function from file: alarm.dm
		public override dynamic attack_hand( dynamic a = null, bool? b = null, bool? c = null ) {
			Ent_Static A = null;
			string d1 = null;
			string dat = null;
			Browser popup = null;

			
			if ( Lang13.Bool( a.stat ) && !GlobalFuncs.IsAdminGhost( a ) || ( this.stat & 3 ) != 0 ) {
				return null;
			}

			if ( this.buildstage != 2 ) {
				return null;
			}
			((Mob)a).set_machine( this );
			A = this.loc;

			if ( a is Mob_Living_Carbon_Human || a.has_unlimited_silicon_privilege ) {
				A = A.loc;

				if ( Lang13.Bool( ((dynamic)A).party ) ) {
					d1 = new Txt( "<A href='?src=" ).Ref( this ).str( ";reset=1'>No Party :(</A>" ).ToString();
				} else {
					d1 = new Txt( "<A href='?src=" ).Ref( this ).str( ";alarm=1'>PARTY!!!</A>" ).ToString();
				}
				dat = "<HTML><HEAD></HEAD><BODY><TT><B>Party Button</B> " + d1 + "</BODY></HTML>";
			} else {
				A = A.loc;

				if ( Lang13.Bool( ((dynamic)A).fire ) ) {
					d1 = new Txt( "<A href='?src=" ).Ref( this ).str( ";reset=1'>" ).item( GlobalFuncs.stars( "No Party :(" ) ).str( "</A>" ).ToString();
				} else {
					d1 = new Txt( "<A href='?src=" ).Ref( this ).str( ";alarm=1'>" ).item( GlobalFuncs.stars( "PARTY!!!" ) ).str( "</A>" ).ToString();
				}
				dat = "<HTML><HEAD></HEAD><BODY><TT><B>" + GlobalFuncs.stars( "Party Button" ) + "</B> " + d1;
			}
			popup = new Browser( a, "firealarm", "Party Alarm" );
			popup.set_content( dat );
			popup.set_title_image( ((Mob)a).browse_rsc_icon( this.icon, this.icon_state ) );
			popup.open();
			return null;
		}

	}

}