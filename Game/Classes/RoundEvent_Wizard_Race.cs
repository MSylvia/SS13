// FILE AUTOGENERATED BY SOM13. DO NOT EDIT YET.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class RoundEvent_Wizard_Race : RoundEvent_Wizard {

		// Function from file: race.dm
		public override bool start(  ) {
			bool all_the_same = false;
			ByTable all_species = null;
			dynamic speciestype = null;
			dynamic S = null;
			dynamic new_species = null;
			Mob_Living_Carbon_Human H = null;

			all_the_same = false;
			all_species = new ByTable();

			foreach (dynamic _a in Lang13.Enumerate( Lang13.GetTypes( typeof(Species) ) - typeof(Species) )) {
				speciestype = _a;
				
				S = Lang13.Call( speciestype );

				if ( !S.dangerous_existence ) {
					all_species.Add( speciestype );
				}
			}
			new_species = Rand13.PickFromTable( all_species );

			if ( Rand13.PercentChance( 50 ) ) {
				all_the_same = true;
			}

			foreach (dynamic _b in Lang13.Enumerate( GlobalVars.mob_list, typeof(Mob_Living_Carbon_Human) )) {
				H = _b;
				
				H.set_species( new_species );
				H.real_name = ((Species)new_species).random_name( H.gender, true );
				H.dna.unique_enzymes = H.dna.generate_unique_enzymes();
				H.WriteMsg( "<span class='notice'>You feel somehow... different?</span>" );

				if ( !all_the_same ) {
					new_species = Rand13.PickFromTable( all_species );
				}
			}
			return false;
		}

	}

}