// FILE AUTOGENERATED BY SOM13. DO NOT EDIT YET.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Machinery_WashingMachine : Obj_Machinery {

		public int state = 1;
		public bool panel = false;
		public bool hacked = true;
		public bool gibs_ready = false;
		public dynamic crayon = null;

		protected override void __FieldInit() {
			base.__FieldInit();

			this.anchored = 1;
			this.icon = "icons/obj/machines/washing_machine.dmi";
			this.icon_state = "wm_10";
		}

		public Obj_Machinery_WashingMachine ( dynamic loc = null ) : base( (object)(loc) ) {
			
		}

		// Function from file: washing_machine.dm
		public override dynamic attack_hand( dynamic a = null, bool? b = null, bool? c = null ) {
			Ent_Dynamic O = null;
			Ent_Dynamic O2 = null;
			dynamic M = null;
			Ent_Dynamic O3 = null;

			
			switch ((int)( this.state )) {
				case 1:
					this.state = 2;
					break;
				case 2:
					this.state = 1;

					foreach (dynamic _a in Lang13.Enumerate( this.contents, typeof(Ent_Dynamic) )) {
						O = _a;
						
						O.loc = this.loc;
					}
					break;
				case 3:
					this.state = 4;
					break;
				case 4:
					this.state = 3;

					foreach (dynamic _b in Lang13.Enumerate( this.contents, typeof(Ent_Dynamic) )) {
						O2 = _b;
						
						O2.loc = this.loc;
					}
					this.crayon = null;
					this.state = 1;
					break;
				case 5:
					a.WriteMsg( "<span class='danger'>The " + this + " is busy.</span>" );
					break;
				case 6:
					this.state = 7;
					break;
				case 7:
					
					if ( this.gibs_ready ) {
						this.gibs_ready = false;

						if ( Lang13.Bool( Lang13.FindIn( typeof(Mob), this.contents ) ) ) {
							M = Lang13.FindIn( typeof(Mob), this.contents );
							((Mob)M).gib();
						}
					}

					foreach (dynamic _c in Lang13.Enumerate( this.contents, typeof(Ent_Dynamic) )) {
						O3 = _c;
						
						O3.loc = this.loc;
					}
					this.crayon = null;
					this.state = 1;
					break;
			}
			this.update_icon();
			return null;
		}

		// Function from file: washing_machine.dm
		public override dynamic attackby( dynamic A = null, dynamic user = null, string _params = null, bool? silent = null, bool? replace_spent = null ) {
			dynamic G = null;

			
			if ( A is Obj_Item_Toy_Crayon || A is Obj_Item_Weapon_Stamp ) {
				
				if ( new ByTable(new object [] { 1, 3, 6 }).Contains( this.state ) ) {
					
					if ( !Lang13.Bool( this.crayon ) ) {
						
						if ( !Lang13.Bool( user.drop_item() ) ) {
							return null;
						}
						this.crayon = A;
						this.crayon.loc = this;
					} else {
						base.attackby( (object)(A), (object)(user), _params, silent, replace_spent );
					}
				} else {
					base.attackby( (object)(A), (object)(user), _params, silent, replace_spent );
				}
			} else if ( A is Obj_Item_Weapon_Grab ) {
				
				if ( this.state == 1 && this.hacked ) {
					G = A;

					if ( G.affecting is Mob_Living_SimpleAnimal_Pet_Dog_Corgi ) {
						G.affecting.loc = this;
						GlobalFuncs.qdel( G );
						this.state = 3;
					}
				} else {
					base.attackby( (object)(A), (object)(user), _params, silent, replace_spent );
				}
			} else if ( A is Obj_Item_Stack_Sheet_Hairlesshide || A is Obj_Item_Clothing_Under || A is Obj_Item_Clothing_Mask || A is Obj_Item_Clothing_Head || A is Obj_Item_Clothing_Gloves || A is Obj_Item_Clothing_Shoes || A is Obj_Item_Clothing_Suit || A is Obj_Item_Weapon_Bedsheet ) {
				
				if ( A is Obj_Item_Clothing_Suit_Space ) {
					user.WriteMsg( "This item does not fit." );
					return null;
				}

				if ( A is Obj_Item_Clothing_Suit_Syndicatefake ) {
					user.WriteMsg( "This item does not fit." );
					return null;
				}

				if ( A is Obj_Item_Clothing_Suit_CyborgSuit ) {
					user.WriteMsg( "This item does not fit." );
					return null;
				}

				if ( A is Obj_Item_Clothing_Suit_BombSuit ) {
					user.WriteMsg( "This item does not fit." );
					return null;
				}

				if ( A is Obj_Item_Clothing_Suit_Armor ) {
					user.WriteMsg( "This item does not fit." );
					return null;
				}

				if ( A is Obj_Item_Clothing_Suit_Armor ) {
					user.WriteMsg( "This item does not fit." );
					return null;
				}

				if ( A is Obj_Item_Clothing_Mask_Gas ) {
					user.WriteMsg( "This item does not fit." );
					return null;
				}

				if ( A is Obj_Item_Clothing_Mask_Cigarette ) {
					user.WriteMsg( "This item does not fit." );
					return null;
				}

				if ( A is Obj_Item_Clothing_Head_Syndicatefake ) {
					user.WriteMsg( "This item does not fit." );
					return null;
				}

				if ( A is Obj_Item_Clothing_Head_Helmet ) {
					user.WriteMsg( "This item does not fit." );
					return null;
				}

				if ( Lang13.Bool( A.flags & 2 ) ) {
					user.WriteMsg( new Txt( "<span class='warning'>" ).The( A ).item().str( " is stuck to your hand, you cannot put it in the washing machine!</span>" ).ToString() );
					return null;
				}

				if ( this.contents.len < 5 ) {
					
					if ( new ByTable(new object [] { 1, 3 }).Contains( this.state ) ) {
						
						if ( !Lang13.Bool( user.drop_item() ) ) {
							return null;
						}
						A.loc = this;
						this.state = 3;
					} else {
						user.WriteMsg( "<span class='warning'>You can't put the item in right now!</span>" );
					}
				} else {
					user.WriteMsg( "<span class='warning'>The washing machine is full!</span>" );
				}
			} else {
				base.attackby( (object)(A), (object)(user), _params, silent, replace_spent );
			}
			this.update_icon();
			return null;
		}

		// Function from file: washing_machine.dm
		public override bool? update_icon( dynamic new_state = null, dynamic new_icon = null, int? new_px = null, int? new_py = null ) {
			this.icon_state = "wm_" + this.state + this.panel;
			return null;
		}

		// Function from file: washing_machine.dm
		[Verb]
		[VerbInfo( name: "Climb out", group: "Object", access: VerbAccess.InUserLocation, range: 127 )]
		public void climb_out(  ) {
			Task13.Sleep( 20 );

			if ( new ByTable(new object [] { 1, 3, 6 }).Contains( this.state ) ) {
				Task13.User.loc = this.loc;
			}
			return;
		}

		// Function from file: washing_machine.dm
		[Verb]
		[VerbInfo( name: "Start Washing", group: "Object", access: VerbAccess.InViewExcludeThis, range: 1 )]
		public void start(  ) {
			Ent_Static A = null;
			Obj_Item_Stack_Sheet_Hairlesshide HH = null;
			Obj_Item_Stack_Sheet_Wetleather WL = null;
			Obj_Item_Clothing_Suit_Hooded_IanCostume IC = null;
			dynamic wash_color = null;
			dynamic CR = null;
			dynamic ST = null;
			string new_jumpsuit_icon_state = null;
			dynamic new_jumpsuit_item_state = null;
			string new_jumpsuit_name = null;
			bool? new_can_adjust = null;
			string new_glove_icon_state = null;
			dynamic new_glove_item_state = null;
			string new_glove_name = null;
			string new_shoe_icon_state = null;
			string new_shoe_name = null;
			string new_sheet_icon_state = null;
			string new_sheet_name = null;
			string new_softcap_icon_state = null;
			string new_softcap_name = null;
			string new_desc = null;
			dynamic T = null;
			dynamic J = null;
			dynamic T2 = null;
			dynamic G = null;
			dynamic T3 = null;
			dynamic S = null;
			dynamic T4 = null;
			dynamic B = null;
			dynamic T5 = null;
			dynamic H = null;
			Obj_Item_Clothing_Under_Color J2 = null;
			Obj_Item_Clothing_Gloves_Color G2 = null;
			Obj_Item_Clothing_Shoes_Sneakers S2 = null;
			Obj_Item_Weapon_Bedsheet B2 = null;
			Obj_Item_Clothing_Head_Soft H2 = null;

			
			if ( Task13.User.stat != 0 || Task13.User.restrained() || !Task13.User.canmove ) {
				return;
			}

			if ( this.state != 4 ) {
				Task13.User.WriteMsg( "The washing machine cannot run in this state." );
				return;
			}

			if ( Lang13.Bool( Lang13.FindIn( typeof(Mob), this.contents ) ) ) {
				this.state = 8;
			} else {
				this.state = 5;
			}
			this.update_icon();
			Task13.Sleep( 200 );

			foreach (dynamic _a in Lang13.Enumerate( this.contents, typeof(Ent_Static) )) {
				A = _a;
				
				A.clean_blood();
			}

			foreach (dynamic _b in Lang13.Enumerate( this.contents, typeof(Obj_Item_Stack_Sheet_Hairlesshide) )) {
				HH = _b;
				
				WL = new Obj_Item_Stack_Sheet_Wetleather( this );
				WL.amount = HH.amount;
				GlobalFuncs.qdel( HH );
			}

			foreach (dynamic _c in Lang13.Enumerate( this.contents, typeof(Obj_Item_Clothing_Suit_Hooded_IanCostume) )) {
				IC = _c;
				
				new Obj_Item_Weapon_ReagentContainers_Food_Snacks_Meat_Slab_Corgi( this );
				GlobalFuncs.qdel( IC );
			}

			if ( Lang13.Bool( this.crayon ) ) {
				wash_color = null;

				if ( this.crayon is Obj_Item_Toy_Crayon ) {
					CR = this.crayon;
					wash_color = CR.colourName;
				} else if ( this.crayon is Obj_Item_Weapon_Stamp ) {
					ST = this.crayon;
					wash_color = ST.item_color;
				}

				if ( Lang13.Bool( wash_color ) ) {
					new_jumpsuit_icon_state = "";
					new_jumpsuit_item_state = "";
					new_jumpsuit_name = "";
					new_can_adjust = null;
					new_glove_icon_state = "";
					new_glove_item_state = "";
					new_glove_name = "";
					new_shoe_icon_state = "";
					new_shoe_name = "";
					new_sheet_icon_state = "";
					new_sheet_name = "";
					new_softcap_icon_state = "";
					new_softcap_name = "";
					new_desc = "The colors are a bit dodgy.";

					foreach (dynamic _d in Lang13.Enumerate( Lang13.GetTypes( typeof(Obj_Item_Clothing_Under_Color) ) )) {
						T = _d;
						
						J = Lang13.Call( T );

						if ( wash_color == J.item_color ) {
							new_jumpsuit_icon_state = J.icon_state;
							new_jumpsuit_item_state = J.item_state;
							new_jumpsuit_name = J.name;
							new_can_adjust = J.can_adjust;
							GlobalFuncs.qdel( J );
							break;
						}
						GlobalFuncs.qdel( J );
					}

					foreach (dynamic _e in Lang13.Enumerate( Lang13.GetTypes( typeof(Obj_Item_Clothing_Gloves_Color) ) )) {
						T2 = _e;
						
						G = Lang13.Call( T2 );

						if ( wash_color == G.item_color ) {
							new_glove_icon_state = G.icon_state;
							new_glove_item_state = G.item_state;
							new_glove_name = G.name;
							GlobalFuncs.qdel( G );
							break;
						}
						GlobalFuncs.qdel( G );
					}

					foreach (dynamic _f in Lang13.Enumerate( Lang13.GetTypes( typeof(Obj_Item_Clothing_Shoes_Sneakers) ) )) {
						T3 = _f;
						
						S = Lang13.Call( T3 );

						if ( wash_color == S.item_color ) {
							new_shoe_icon_state = S.icon_state;
							new_shoe_name = S.name;
							GlobalFuncs.qdel( S );
							break;
						}
						GlobalFuncs.qdel( S );
					}

					foreach (dynamic _g in Lang13.Enumerate( Lang13.GetTypes( typeof(Obj_Item_Weapon_Bedsheet) ) )) {
						T4 = _g;
						
						B = Lang13.Call( T4 );

						if ( wash_color == B.item_color ) {
							new_sheet_icon_state = B.icon_state;
							new_sheet_name = B.name;
							GlobalFuncs.qdel( B );
							break;
						}
						GlobalFuncs.qdel( B );
					}

					foreach (dynamic _h in Lang13.Enumerate( Lang13.GetTypes( typeof(Obj_Item_Clothing_Head_Soft) ) )) {
						T5 = _h;
						
						H = Lang13.Call( T5 );

						if ( wash_color == H.item_color ) {
							new_softcap_icon_state = H.icon_state;
							new_softcap_name = H.name;
							GlobalFuncs.qdel( H );
							break;
						}
						GlobalFuncs.qdel( H );
					}

					if ( Lang13.Bool( new_jumpsuit_icon_state ) && Lang13.Bool( new_jumpsuit_item_state ) && Lang13.Bool( new_jumpsuit_name ) ) {
						
						foreach (dynamic _i in Lang13.Enumerate( this.contents, typeof(Obj_Item_Clothing_Under_Color) )) {
							J2 = _i;
							
							J2.item_state = new_jumpsuit_item_state;
							J2.icon_state = new_jumpsuit_icon_state;
							J2.item_color = wash_color;
							J2.name = new_jumpsuit_name;
							J2.desc = new_desc;
							J2.suit_color = wash_color;
							J2.can_adjust = new_can_adjust;
						}
					}

					if ( Lang13.Bool( new_glove_icon_state ) && Lang13.Bool( new_glove_item_state ) && Lang13.Bool( new_glove_name ) ) {
						
						foreach (dynamic _j in Lang13.Enumerate( this.contents, typeof(Obj_Item_Clothing_Gloves_Color) )) {
							G2 = _j;
							
							G2.item_state = new_glove_item_state;
							G2.icon_state = new_glove_icon_state;
							G2.item_color = wash_color;
							G2.name = new_glove_name;
							G2.desc = new_desc;
						}
					}

					if ( Lang13.Bool( new_shoe_icon_state ) && Lang13.Bool( new_shoe_name ) ) {
						
						foreach (dynamic _k in Lang13.Enumerate( this.contents, typeof(Obj_Item_Clothing_Shoes_Sneakers) )) {
							S2 = _k;
							

							if ( S2.chained == true ) {
								S2.chained = false;
								S2.slowdown = 0;
								new Obj_Item_Weapon_Restraints_Handcuffs( this );
							}
							S2.icon_state = new_shoe_icon_state;
							S2.item_color = wash_color;
							S2.name = new_shoe_name;
							S2.desc = new_desc;
						}
					}

					if ( Lang13.Bool( new_sheet_icon_state ) && Lang13.Bool( new_sheet_name ) ) {
						
						foreach (dynamic _l in Lang13.Enumerate( this.contents, typeof(Obj_Item_Weapon_Bedsheet) )) {
							B2 = _l;
							
							B2.icon_state = new_sheet_icon_state;
							B2.item_color = wash_color;
							B2.name = new_sheet_name;
							B2.desc = new_desc;
						}
					}

					if ( Lang13.Bool( new_softcap_icon_state ) && Lang13.Bool( new_softcap_name ) ) {
						
						foreach (dynamic _m in Lang13.Enumerate( this.contents, typeof(Obj_Item_Clothing_Head_Soft) )) {
							H2 = _m;
							
							H2.icon_state = new_softcap_icon_state;
							H2.item_color = wash_color;
							H2.name = new_softcap_name;
							H2.desc = new_desc;
						}
					}
				}
				GlobalFuncs.qdel( this.crayon );
				this.crayon = null;
			}

			if ( Lang13.Bool( Lang13.FindIn( typeof(Mob), this.contents ) ) ) {
				this.state = 7;
				this.gibs_ready = true;
			} else {
				this.state = 4;
			}
			this.update_icon();
			return;
		}

	}

}