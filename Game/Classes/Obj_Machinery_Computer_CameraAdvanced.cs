// FILE AUTOGENERATED BY SOM13. DO NOT EDIT YET.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Machinery_Computer_CameraAdvanced : Obj_Machinery_Computer {

		public Mob_Camera_AiEye_Remote eyeobj = null;
		public dynamic current_user = null;
		public ByTable networks = new ByTable(new object [] { "SS13" });
		public Action_Innate_CameraOff off_action = new Action_Innate_CameraOff();
		public Action_Innate_CameraJump jump_action = new Action_Innate_CameraJump();

		protected override void __FieldInit() {
			base.__FieldInit();

			this.icon_screen = "cameras";
			this.icon_keyboard = "security_key";
		}

		public Obj_Machinery_Computer_CameraAdvanced ( dynamic location = null, dynamic C = null ) : base( (object)(location), (object)(C) ) {
			
		}

		// Function from file: camera_advanced.dm
		public override dynamic attack_hand( dynamic a = null, bool? b = null, bool? c = null ) {
			dynamic L = null;
			Obj_Machinery_Camera C = null;

			
			if ( Lang13.Bool( base.attack_hand( (object)(a), b, c ) ) ) {
				return null;
			}

			if ( !( a is Mob_Living_Carbon ) ) {
				return null;
			}
			L = a;

			if ( !Lang13.Bool( this.current_user ) ) {
				
				if ( !( this.eyeobj != null ) ) {
					this.CreateEye();
				}
				this.GrantActions( a );
				this.current_user = a;
				this.eyeobj.user = a;
				this.eyeobj.name = "Camera Eye (" + a.name + ")";
				L.remote_view = true;
				L.remote_control = this.eyeobj;
				L.client.perspective = GlobalVars.EYE_PERSPECTIVE ?1:0;

				if ( !this.eyeobj.initialized ) {
					
					foreach (dynamic _a in Lang13.Enumerate( GlobalVars.cameranet.cameras, typeof(Obj_Machinery_Camera) )) {
						C = _a;
						

						if ( !C.can_use() ) {
							continue;
						}

						if ( ( C.network & this.networks ) != null ) {
							this.eyeobj.setLoc( GlobalFuncs.get_turf( C ) );
							break;
						}
					}
					this.eyeobj.initialized = true;
				} else {
					this.eyeobj.setLoc( this.eyeobj.loc );
				}
			} else {
				a.WriteMsg( "The console is already in use!" );
			}
			return null;
		}

		// Function from file: camera_advanced.dm
		public override bool? check_eye( Mob user = null ) {
			
			if ( Map13.GetDistance( user, this ) > 1 || user.eye_blind != 0 ) {
				
				if ( user == this.current_user ) {
					this.off_action.Activate();
				}
				return false;
			}
			return true;
		}

		// Function from file: camera_advanced.dm
		public virtual void GrantActions( dynamic user = null ) {
			this.off_action.target = user;
			this.off_action.Grant( user );
			this.jump_action.target = user;
			this.jump_action.Grant( user );
			return;
		}

		// Function from file: camera_advanced.dm
		public virtual void CreateEye(  ) {
			this.eyeobj = new Mob_Camera_AiEye_Remote();
			this.eyeobj.origin = this;
			return;
		}

	}

}