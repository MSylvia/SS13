// FILE AUTOGENERATED BY SOM13. DO NOT EDIT YET.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Item_Device_Instrument : Obj_Item_Device {

		public Song_Handheld song = null;
		public string instrumentId = "generic";
		public string instrumentExt = "ogg";

		protected override void __FieldInit() {
			base.__FieldInit();

			this.burn_state = 0;
			this.burntime = 20;
		}

		// Function from file: instruments.dm
		public Obj_Item_Device_Instrument ( dynamic loc = null ) : base( (object)(loc) ) {
			this.song = new Song_Handheld( this.instrumentId, this );
			this.song.instrumentExt = this.instrumentExt;
			return;
		}

		// Function from file: instruments.dm
		public override dynamic interact( dynamic user = null, bool? flag1 = null ) {
			
			if ( !Lang13.Bool( user ) ) {
				return null;
			}

			if ( !( user is Mob_Living ) || Lang13.Bool( user.stat ) || ((Mob)user).restrained() || Lang13.Bool( user.lying ) ) {
				return null;
			}
			((Mob)user).set_machine( this );
			this.song.interact( user );
			return null;
		}

		// Function from file: instruments.dm
		public override dynamic attack_self( dynamic user = null, dynamic flag = null, bool? emp = null ) {
			
			if ( !((Mob)user).IsAdvancedToolUser() ) {
				user.WriteMsg( "<span class='warning'>You don't have the dexterity to do this!</span>" );
				return 1;
			}
			this.interact( user );
			return null;
		}

		// Function from file: instruments.dm
		public override void initialize(  ) {
			this.song.tempo = this.song.sanitize_tempo( this.song.tempo );
			base.initialize();
			return;
		}

		// Function from file: instruments.dm
		public override int suicide_act( Mob_Living_Carbon_Human user = null ) {
			user.visible_message( new Txt( "<span class='suicide'>" ).item( user ).str( " begins to play 'Gloomy Sunday'! It looks like " ).he_she_it_they().str( "'s trying to commit suicide..</span>" ).ToString() );
			return 1;
		}

		// Function from file: instruments.dm
		public override dynamic Destroy(  ) {
			GlobalFuncs.qdel( this.song );
			this.song = null;
			return base.Destroy();
		}

	}

}