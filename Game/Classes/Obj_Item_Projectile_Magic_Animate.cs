// FILE AUTOGENERATED BY SOM13. DO NOT EDIT YET.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Item_Projectile_Magic_Animate : Obj_Item_Projectile_Magic {

		protected override void __FieldInit() {
			base.__FieldInit();

			this.damage_type = "fire";
			this.icon_state = "red_1";
		}

		public Obj_Item_Projectile_Magic_Animate ( dynamic loc = null ) : base( (object)(loc) ) {
			
		}

		// Function from file: magic.dm
		public override dynamic Bump( Ent_Dynamic A = null, dynamic yes = null ) {
			Ent_Static H = null;
			Mob_Living_SimpleAnimal_Hostile_Statue S = null;
			Ent_Dynamic O = null;
			Ent_Dynamic C = null;

			base.Bump( A );

			if ( A is Obj_Item || A is Obj_Structure && !GlobalFuncs.is_type_in_list( A, GlobalVars.protected_objects ) ) {
				
				if ( A is Obj_Structure_Closet_Statue ) {
					
					foreach (dynamic _a in Lang13.Enumerate( A.contents, typeof(Mob_Living_Carbon_Human) )) {
						H = _a;
						
						S = new Mob_Living_SimpleAnimal_Hostile_Statue( A.loc, this.firer );
						S.name = "statue of " + H.name;
						S.faction = new ByTable(new object [] { new Txt().Ref( this.firer ).ToString() });
						S.icon = A.icon;

						if ( Lang13.Bool( ((dynamic)H).mind ) ) {
							((Mind)((dynamic)H).mind).transfer_to( S );
							S.WriteMsg( "<span class='userdanger'>You are an animate statue. You cannot move when monitored, but are nearly invincible and deadly when unobserved! Do not harm " + this.firer.name + ", your creator.</span>" );
						}
						H = A;
						H.loc = S;
						GlobalFuncs.qdel( this );
						return null;
					}
				} else {
					O = A;

					if ( O is Obj_Item_Weapon_Gun ) {
						new Mob_Living_SimpleAnimal_Hostile_Mimic_Copy_Ranged( O.loc, O, this.firer );
					} else {
						new Mob_Living_SimpleAnimal_Hostile_Mimic_Copy( O.loc, O, this.firer );
					}
				}
			} else if ( A is Mob_Living_SimpleAnimal_Hostile_Mimic_Copy ) {
				C = A;
				((dynamic)C).ChangeOwner( this.firer );
			}
			return null;
		}

	}

}