// FILE AUTOGENERATED BY SOM13. DO NOT EDIT YET.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Item_Asteroid_GoliathHide : Obj_Item_Asteroid {

		protected override void __FieldInit() {
			base.__FieldInit();

			this.flags = 4;
			this.icon = "icons/obj/mining.dmi";
			this.icon_state = "goliath_hide";
			this.layer = 4;
		}

		public Obj_Item_Asteroid_GoliathHide ( dynamic loc = null ) : base( (object)(loc) ) {
			
		}

		// Function from file: mining_mobs.dm
		public override bool afterattack( dynamic target = null, dynamic user = null, bool? proximity_flag = null, string click_parameters = null ) {
			dynamic C = null;
			dynamic current_armor = null;
			dynamic D = null;
			ByTable damage_absorption = null;

			
			if ( proximity_flag == true ) {
				
				if ( target is Obj_Item_Clothing_Suit_Space_Hardsuit_Mining || target is Obj_Item_Clothing_Head_Helmet_Space_Hardsuit_Mining ) {
					C = target;
					current_armor = C.armor;

					if ( Convert.ToDouble( current_armor["melee"] ) < 80 ) {
						current_armor["melee"] = Num13.MinInt( Convert.ToInt32( current_armor["melee"] + 10 ), 80 );
						user.WriteMsg( "<span class='info'>You strengthen " + target + ", improving its resistance against melee attacks.</span>" );
						GlobalFuncs.qdel( this );
					} else {
						user.WriteMsg( "<span class='warning'>You can't improve " + C + " any further!</span>" );
						return false;
					}
				}

				if ( target is Obj_Mecha_Working_Ripley ) {
					D = target;
					damage_absorption = D.damage_absorption;

					if ( ( D.hides ??0) < 3 ) {
						D.hides++;
						damage_absorption["brute"] = Num13.MaxInt( Convert.ToInt32( damage_absorption["brute"] - 0.1 ), ((int)( 0.3 )) );
						damage_absorption["bullet"] = damage_absorption["bullet"] - 0.05;
						damage_absorption["fire"] = damage_absorption["fire"] - 0.05;
						damage_absorption["laser"] = damage_absorption["laser"] - 0.025;
						user.WriteMsg( "<span class='info'>You strengthen " + target + ", improving its resistance against melee attacks.</span>" );
						D.update_icon();

						if ( D.hides == 3 ) {
							D.desc = "Autonomous Power Loader Unit. It's wearing a fearsome carapace entirely composed of goliath hide plates - its pilot must be an experienced monster hunter.";
						} else {
							D.desc = "Autonomous Power Loader Unit. Its armour is enhanced with some goliath hide plates.";
						}
						GlobalFuncs.qdel( this );
					} else {
						user.WriteMsg( "<span class='warning'>You can't improve " + D + " any further!</span>" );
						return false;
					}
				}
			}
			return false;
		}

	}

}