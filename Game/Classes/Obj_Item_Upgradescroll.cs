// FILE AUTOGENERATED BY SOM13. DO NOT EDIT YET.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Item_Upgradescroll : Obj_Item {

		protected override void __FieldInit() {
			base.__FieldInit();

			this.w_class = 1;
			this.icon = "icons/obj/wizard.dmi";
			this.icon_state = "scroll";
		}

		public Obj_Item_Upgradescroll ( dynamic loc = null ) : base( (object)(loc) ) {
			
		}

		// Function from file: rpgloot.dm
		public override bool afterattack( dynamic target = null, dynamic user = null, bool? proximity_flag = null, string click_parameters = null ) {
			dynamic quality = null;
			dynamic value = null;

			
			if ( !( proximity_flag == true ) || !( target is Obj_Item ) ) {
				return false;
			}
			quality = target.force - Lang13.Initial( target, "force" );

			if ( Convert.ToDouble( quality ) > 9 && Rand13.PercentChance( Convert.ToInt32( ( quality - 9 ) * 10 ) ) ) {
				user.WriteMsg( "<span class='danger'>" + target + " catches fire!</span>" );

				if ( target.burn_state == -1 ) {
					target.burn_state = 0;
				}
				((Ent_Static)target).fire_act();
				GlobalFuncs.qdel( this );
				return false;
			}
			target.force += 1;
			target.throwforce += 1;

			foreach (dynamic _a in Lang13.Enumerate( target.armor )) {
				value = _a;
				
				target.armor[value] += 1;
			}
			user.WriteMsg( "<span class='notice'>" + target + " glows blue and seems vaguely \"better\"!</span>" );
			GlobalFuncs.qdel( this );
			return false;
		}

	}

}