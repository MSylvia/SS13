// FILE AUTOGENERATED BY SOM13. DO NOT EDIT YET.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class SurgeryStep_ReshapeGenitals : SurgeryStep {

		protected override void __FieldInit() {
			base.__FieldInit();

			this.name = "reshape genitals";
			this.implements = new ByTable().Set( typeof(Obj_Item_Weapon_Scalpel), 100 ).Set( typeof(Obj_Item_Weapon_Hatchet), 50 ).Set( typeof(Obj_Item_Weapon_Wirecutters), 35 );
			this.time = 64;
		}

		// Function from file: gender_reassignment.dm
		public override bool failure( dynamic user = null, Mob target = null, string target_zone = null, dynamic tool = null, Surgery surgery = null ) {
			Mob H = null;

			H = target;
			((dynamic)H).gender_ambiguous = 1;
			((Ent_Static)user).visible_message( "<span class='warning'>" + user + " accidentally mutilates " + target + "'s genitals beyond the point of recognition!</span>", "<span class='warning'>You accidentally mutilate " + target + "'s genitals beyond the point of recognition!</span>" );
			target.gender = Rand13.Pick(new object [] { GlobalVars.MALE, GlobalVars.FEMALE });
			target.regenerate_icons();
			return true;
		}

		// Function from file: gender_reassignment.dm
		public override bool success( dynamic user = null, Mob target = null, string target_zone = null, dynamic tool = null, Surgery surgery = null ) {
			Mob H = null;

			H = target;
			((dynamic)H).gender_ambiguous = 0;

			if ( target.gender == GlobalVars.FEMALE ) {
				((Ent_Static)user).visible_message( "" + user + " has made a man of " + target + "!", "<span class='notice'>You made " + target + " a man.</span>" );
				target.gender = GlobalVars.MALE;
			} else {
				((Ent_Static)user).visible_message( "" + user + " has made a woman of " + target + "!", "<span class='notice'>You made " + target + " a woman.</span>" );
				target.gender = GlobalVars.FEMALE;
			}
			target.regenerate_icons();
			return true;
		}

		// Function from file: gender_reassignment.dm
		public override int preop( dynamic user = null, Mob target = null, string target_zone = null, dynamic tool = null, Surgery surgery = null ) {
			
			if ( target.gender == GlobalVars.FEMALE ) {
				((Ent_Static)user).visible_message( "" + user + " begins to reshape " + target + "'s genitals to look more masculine.", "<span class='notice'>You begin to reshape " + target + "'s genitals to look more masculine...</span>" );
			} else {
				((Ent_Static)user).visible_message( "" + user + " begins to reshape " + target + "'s genitals to look more feminine.", "<span class='notice'>You begin to reshape " + target + "'s genitals to look more feminine...</span>" );
			}
			return 0;
		}

	}

}