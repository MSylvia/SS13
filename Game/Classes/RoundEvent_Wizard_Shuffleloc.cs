// FILE AUTOGENERATED BY SOM13. DO NOT EDIT YET.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class RoundEvent_Wizard_Shuffleloc : RoundEvent_Wizard {

		// Function from file: shuffle.dm
		public override bool start(  ) {
			ByTable moblocs = null;
			ByTable mobs = null;
			Mob_Living_Carbon_Human H = null;
			Mob_Living_Carbon_Human H2 = null;
			Mob_Living_Carbon_Human H3 = null;
			EffectSystem_SmokeSpread smoke = null;

			moblocs = new ByTable();
			mobs = new ByTable();

			foreach (dynamic _a in Lang13.Enumerate( GlobalVars.living_mob_list, typeof(Mob_Living_Carbon_Human) )) {
				H = _a;
				

				if ( H.z != 1 ) {
					continue;
				}
				moblocs.Add( H.loc );
				mobs.Add( H );
			}

			if ( !( mobs != null ) ) {
				return false;
			}
			GlobalFuncs.shuffle( moblocs );
			GlobalFuncs.shuffle( mobs );

			foreach (dynamic _b in Lang13.Enumerate( mobs, typeof(Mob_Living_Carbon_Human) )) {
				H2 = _b;
				

				if ( !( moblocs != null ) ) {
					break;
				}
				GlobalFuncs.do_teleport( H2, moblocs[moblocs.len] );
				moblocs.len -= 1;
			}

			foreach (dynamic _c in Lang13.Enumerate( GlobalVars.living_mob_list, typeof(Mob_Living_Carbon_Human) )) {
				H3 = _c;
				
				smoke = new EffectSystem_SmokeSpread();
				smoke.set_up( 0, H3.loc );
				smoke.start();
			}
			return false;
		}

	}

}