// FILE AUTOGENERATED BY SOM13. DO NOT EDIT YET.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Outfit_Job_Security : Outfit_Job {

		public dynamic department = null;
		public Type tie = null;
		public ByTable dep_access = null;
		public Type destination = null;
		public dynamic spawn_point = null;

		protected override void __FieldInit() {
			base.__FieldInit();

			this.name = "Security Officer";
			this.belt = typeof(Obj_Item_Device_Pda_Security);
			this.ears = typeof(Obj_Item_Device_Radio_Headset_HeadsetSec_Alt);
			this.uniform = typeof(Obj_Item_Clothing_Under_Rank_Security);
			this.gloves = typeof(Obj_Item_Clothing_Gloves_Color_Black);
			this.head = typeof(Obj_Item_Clothing_Head_Helmet_Sec);
			this.suit = typeof(Obj_Item_Clothing_Suit_Armor_Vest);
			this.shoes = typeof(Obj_Item_Clothing_Shoes_Jackboots);
			this.l_pocket = typeof(Obj_Item_Device_Assembly_Flash_Handheld);
			this.suit_store = typeof(Obj_Item_Weapon_Gun_Energy_Gun_Advtaser);
			this.backpack_contents = new ByTable().Set( typeof(Obj_Item_Weapon_Restraints_Handcuffs), 1 ).Set( typeof(Obj_Item_Weapon_Melee_Baton_Loaded), 1 );
			this.backpack = typeof(Obj_Item_Weapon_Storage_Backpack_Security);
			this.satchel = typeof(Obj_Item_Weapon_Storage_Backpack_SatchelSec);
			this.box = typeof(Obj_Item_Weapon_Storage_Box_Security);
		}

		// Function from file: security.dm
		public override void post_equip( Mob H = null, bool? visualsOnly = null ) {
			visualsOnly = visualsOnly ?? GlobalVars.FALSE;

			Obj_Item_Clothing_Under U = null;
			Obj_Item_Weapon_Implant_Loyalty L = null;
			dynamic W = null;
			bool teleport = false;
			dynamic T = null;
			int safety = 0;

			base.post_equip( H, visualsOnly );
			U = ((dynamic)H).w_uniform;

			if ( this.tie != null ) {
				U.attachTie( Lang13.Call( this.tie ) );
			}

			if ( visualsOnly == true ) {
				return;
			}
			L = new Obj_Item_Weapon_Implant_Loyalty( H );
			L.imp_in = H;
			L.implanted = 1;
			((dynamic)H).sec_hud_set_implants();
			W = ((dynamic)H).wear_id;
			W.access |= this.dep_access;
			teleport = false;

			if ( !GlobalVars.config.sec_start_brig ) {
				
				if ( this.destination != null || Lang13.Bool( this.spawn_point ) ) {
					teleport = true;
				}
			}

			if ( teleport ) {
				
				if ( Lang13.Bool( this.spawn_point ) ) {
					T = GlobalFuncs.get_turf( this.spawn_point );
					H.Move( T );
				} else {
					safety = 0;

					while (safety < 25) {
						T = GlobalFuncs.safepick( GlobalFuncs.get_area_turfs( this.destination ) );

						if ( Lang13.Bool( T ) && !H.Move( T ) ) {
							safety += 1;
							continue;
						} else {
							break;
						}
					}
				}
			}

			if ( Lang13.Bool( this.department ) ) {
				H.WriteMsg( "<b>You have been assigned to " + this.department + "!</b>" );
			} else {
				H.WriteMsg( "<b>You have not been assigned to any department. Patrol the halls and help where needed.</b>" );
			}
			return;
		}

		// Function from file: security.dm
		public override void pre_equip( Mob H = null, bool? visualsOnly = null ) {
			visualsOnly = visualsOnly ?? GlobalVars.FALSE;

			base.pre_equip( H, visualsOnly );

			if ( GlobalVars.sec_departments.len != 0 ) {
				this.department = Rand13.PickFromTable( GlobalVars.sec_departments );

				if ( !( visualsOnly == true ) ) {
					GlobalVars.sec_departments.Remove( this.department );
				}

				dynamic _a = this.department; // Was a switch-case, sorry for the mess.
				if ( _a=="supply" ) {
					this.ears = typeof(Obj_Item_Device_Radio_Headset_HeadsetSec_Alt_Department_Supply);
					this.dep_access = new ByTable(new object [] { GlobalVars.access_mailsorting, GlobalVars.access_mining });
					this.destination = typeof(Zone_Security_Checkpoint_Supply);
					this.spawn_point = Lang13.FindIn( typeof(Obj_Effect_Landmark_Start_Depsec_Supply), GlobalVars.department_security_spawns );
					this.tie = typeof(Obj_Item_Clothing_Tie_Armband_Cargo);
				} else if ( _a=="engineering" ) {
					this.ears = typeof(Obj_Item_Device_Radio_Headset_HeadsetSec_Alt_Department_Engi);
					this.dep_access = new ByTable(new object [] { GlobalVars.access_construction, GlobalVars.access_engine });
					this.destination = typeof(Zone_Security_Checkpoint_Engineering);
					this.spawn_point = Lang13.FindIn( typeof(Obj_Effect_Landmark_Start_Depsec_Engineering), GlobalVars.department_security_spawns );
					this.tie = typeof(Obj_Item_Clothing_Tie_Armband_Engine);
				} else if ( _a=="medical" ) {
					this.ears = typeof(Obj_Item_Device_Radio_Headset_HeadsetSec_Alt_Department_Med);
					this.dep_access = new ByTable(new object [] { GlobalVars.access_medical });
					this.destination = typeof(Zone_Security_Checkpoint_Medical);
					this.spawn_point = Lang13.FindIn( typeof(Obj_Effect_Landmark_Start_Depsec_Medical), GlobalVars.department_security_spawns );
					this.tie = typeof(Obj_Item_Clothing_Tie_Armband_Medblue);
				} else if ( _a=="science" ) {
					this.ears = typeof(Obj_Item_Device_Radio_Headset_HeadsetSec_Alt_Department_Sci);
					this.dep_access = new ByTable(new object [] { GlobalVars.access_research });
					this.destination = typeof(Zone_Security_Checkpoint_Science);
					this.spawn_point = Lang13.FindIn( typeof(Obj_Effect_Landmark_Start_Depsec_Science), GlobalVars.department_security_spawns );
					this.tie = typeof(Obj_Item_Clothing_Tie_Armband_Science);
				}
			}
			return;
		}

	}

}