// FILE AUTOGENERATED BY SOM13. DO NOT EDIT YET.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Structure_FirelockFrame : Obj_Structure {

		public int constructionStep = 4;
		public bool reinforced = false;

		protected override void __FieldInit() {
			base.__FieldInit();

			this.icon = "icons/obj/doors/Doorfire.dmi";
			this.icon_state = "frame1";
		}

		public Obj_Structure_FirelockFrame ( dynamic loc = null ) : base( (object)(loc) ) {
			
		}

		// Function from file: firedoor.dm
		public override dynamic attackby( dynamic A = null, dynamic user = null, string _params = null, bool? silent = null, bool? replace_spent = null ) {
			Obj_Item_Stack_CableCoil B = null;
			dynamic W = null;
			dynamic B2 = null;
			dynamic W2 = null;
			Obj_Item_Stack_Sheet_Metal M = null;

			
			switch ((int)( this.constructionStep )) {
				case 1:
					
					if ( A is Obj_Item_Weapon_Crowbar ) {
						GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/items/Crowbar.ogg", 50, 1 );
						((Ent_Static)user).visible_message( "<span class='notice'>" + user + " starts prying something out from " + this + "...</span>", "<span class='notice'>You begin prying out the wire cover...</span>" );

						if ( !GlobalFuncs.do_after( user, 50 / A.toolspeed, null, this ) ) {
							return null;
						}

						if ( this.constructionStep != 1 ) {
							return null;
						}
						GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/items/Deconstruct.ogg", 50, 1 );
						((Ent_Static)user).visible_message( "<span class='notice'>" + user + " pries out a metal plate from " + this + ", exposing the wires.</span>", "<span class='notice'>You remove the cover plate from " + this + ", exposing the wires.</span>" );
						this.constructionStep = 2;
						this.update_icon();
						return null;
					}

					if ( A is Obj_Item_Weapon_Wrench ) {
						GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/items/ratchet.ogg", 50, 1 );
						((Ent_Static)user).visible_message( "<span class='notice'>" + user + " starts bolting down " + this + "...</span>", "<span class='notice'>You begin bolting " + this + "...</span>" );

						if ( !GlobalFuncs.do_after( user, 30 / A.toolspeed, null, this ) ) {
							return null;
						}
						((Ent_Static)user).visible_message( "<span class='notice'>" + user + " finishes the firelock.</span>", "<span class='notice'>You finish the firelock.</span>" );
						GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/items/Deconstruct.ogg", 50, 1 );

						if ( this.reinforced ) {
							new Obj_Machinery_Door_Firedoor_Heavy( GlobalFuncs.get_turf( this ) );
						} else {
							new Obj_Machinery_Door_Firedoor( GlobalFuncs.get_turf( this ) );
						}
						GlobalFuncs.qdel( this );
						return null;
					}
					break;
				case 2:
					
					if ( A is Obj_Item_Weapon_Wirecutters ) {
						GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/items/Wirecutter.ogg", 50, 1 );
						((Ent_Static)user).visible_message( "<span class='notice'>" + user + " starts cutting the wires from " + this + "...</span>", "<span class='notice'>You begin removing " + this + "'s wires...</span>" );

						if ( !GlobalFuncs.do_after( user, 60 / A.toolspeed, null, this ) ) {
							return null;
						}

						if ( this.constructionStep != 2 ) {
							return null;
						}
						((Ent_Static)user).visible_message( "<span class='notice'>" + user + " removes the wires from " + this + ".</span>", "<span class='notice'>You remove the wiring from " + this + ", exposing the circuit board.</span>" );
						B = new Obj_Item_Stack_CableCoil( GlobalFuncs.get_turf( this ) );
						B.amount = 5;
						this.constructionStep = 3;
						this.update_icon();
						return null;
					}

					if ( A is Obj_Item_Weapon_Weldingtool ) {
						W = A;

						if ( ((Obj_Item_Weapon_Weldingtool)W).remove_fuel( 1, user ) ) {
							GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/items/welder.ogg", 50, 1 );
							((Ent_Static)user).visible_message( "<span class='notice'>" + user + " starts welding a metal plate into " + this + "...</span>", "<span class='notice'>You begin welding the cover plate back onto " + this + "...</span>" );

							if ( !GlobalFuncs.do_after( user, 80 / A.toolspeed, null, this ) ) {
								return null;
							}

							if ( this.constructionStep != 2 ) {
								return null;
							}
							GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/items/welder2.ogg", 50, 1 );
							((Ent_Static)user).visible_message( "<span class='notice'>" + user + " welds the metal plate into " + this + ".</span>", "<span class='notice'>You weld " + this + "'s cover plate into place, hiding the wires.</span>" );
						}
						this.constructionStep = 1;
						this.update_icon();
						return null;
					}
					break;
				case 3:
					
					if ( A is Obj_Item_Weapon_Crowbar ) {
						((Ent_Static)user).visible_message( "<span class='notice'>" + user + " begins removing the circuit board from " + this + "...</span>", "<span class='notice'>You begin prying out the circuit board from " + this + "...</span>" );
						GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/items/Crowbar.ogg", 50, 1 );

						if ( !GlobalFuncs.do_after( user, 50 / A.toolspeed, null, this ) ) {
							return null;
						}

						if ( this.constructionStep != 3 ) {
							return null;
						}
						((Ent_Static)user).visible_message( "<span class='notice'>" + user + " removes " + this + "'s circuit board.</span>", "<span class='notice'>You remove the circuit board from " + this + ".</span>" );
						new Obj_Item_Weapon_Electronics_Firelock( GlobalFuncs.get_turf( this ) );
						GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/items/Crowbar.ogg", 50, 1 );
						this.constructionStep = 4;
						this.update_icon();
						return null;
					}

					if ( A is Obj_Item_Stack_CableCoil ) {
						B2 = A;

						if ( Convert.ToDouble( B2.amount ) < 5 ) {
							user.WriteMsg( "<span class='warning'>You need more wires to add wiring to " + this + ".</span>" );
							return null;
						}
						((Ent_Static)user).visible_message( "<span class='notice'>" + user + " begins wiring " + this + "...</span>", "<span class='notice'>You begin adding wires to " + this + "...</span>" );
						GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/items/Deconstruct.ogg", 50, 1 );

						if ( !GlobalFuncs.do_after( user, 60, null, this ) ) {
							return null;
						}

						if ( this.constructionStep != 3 ) {
							return null;
						}
						((Ent_Static)user).visible_message( "<span class='notice'>" + user + " adds wires to " + this + ".</span>", "<span class='notice'>You wire " + this + ".</span>" );
						GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/items/Deconstruct.ogg", 50, 1 );
						((Obj_Item_Stack)B2).use( 5 );
						this.constructionStep = 2;
						this.update_icon();
						return null;
					}
					break;
				case 4:
					
					if ( A is Obj_Item_Weapon_Weldingtool ) {
						W2 = A;

						if ( ((Obj_Item_Weapon_Weldingtool)W2).remove_fuel( 1, user ) ) {
							GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/items/welder.ogg", 50, 1 );
							((Ent_Static)user).visible_message( "<span class='notice'>" + user + " begins cutting apart " + this + "'s frame...</span>", "<span class='notice'>You begin slicing " + this + " apart...</span>" );

							if ( !GlobalFuncs.do_after( user, 80 / A.toolspeed, null, this ) ) {
								return null;
							}

							if ( this.constructionStep != 4 ) {
								return null;
							}
							((Ent_Static)user).visible_message( "<span class='notice'>" + user + " cuts apart " + this + "!</span>", "<span class='notice'>You cut " + this + " into metal.</span>" );
							GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/items/welder2.ogg", 50, 1 );
							M = new Obj_Item_Stack_Sheet_Metal( GlobalFuncs.get_turf( this ) );
							M.amount = 3;
							GlobalFuncs.qdel( this );
						}
						return null;
					}

					if ( A is Obj_Item_Weapon_Electronics_Firelock ) {
						((Ent_Static)user).visible_message( "<span class='notice'>" + user + " starts adding " + A + " to " + this + "...</span>", "<span class='notice'>You begin adding a circuit board to " + this + "...</span>" );
						GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/items/Deconstruct.ogg", 50, 1 );

						if ( !GlobalFuncs.do_after( user, 40, null, this ) ) {
							return null;
						}

						if ( this.constructionStep != 4 ) {
							return null;
						}
						user.drop_item();
						GlobalFuncs.qdel( A );
						((Ent_Static)user).visible_message( "<span class='notice'>" + user + " adds a circuit to " + this + ".</span>", "<span class='notice'>You insert and secure " + A + ".</span>" );
						GlobalFuncs.playsound( GlobalFuncs.get_turf( this ), "sound/items/Deconstruct.ogg", 50, 1 );
						this.constructionStep = 3;
						this.update_icon();
						return null;
					}
					break;
			}
			return null;
		}

		// Function from file: firedoor.dm
		public override bool? update_icon( dynamic new_state = null, dynamic new_icon = null, int? new_px = null, int? new_py = null ) {
			base.update_icon( (object)(new_state), (object)(new_icon), new_px, new_py );
			this.icon_state = "frame" + this.constructionStep;
			return null;
		}

		// Function from file: firedoor.dm
		public override double examine( dynamic user = null ) {
			base.examine( (object)(user) );

			switch ((int)( this.constructionStep )) {
				case 1:
					user.WriteMsg( "There is a small metal plate covering the wires." );
					break;
				case 2:
					user.WriteMsg( "Wires are trailing from the maintenance panel." );
					break;
				case 3:
					user.WriteMsg( "The circuit board is visible." );
					break;
				case 4:
					user.WriteMsg( "There are no electronics in the frame." );
					break;
			}
			return 0;
		}

	}

}