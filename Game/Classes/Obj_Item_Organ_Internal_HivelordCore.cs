// FILE AUTOGENERATED BY SOM13. DO NOT EDIT YET.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Obj_Item_Organ_Internal_HivelordCore : Obj_Item_Organ_Internal {

		public bool inert = false;
		public bool preserved = false;

		protected override void __FieldInit() {
			base.__FieldInit();

			this.flags = 4;
			this.slot = "hivecore";
			this.icon_state = "roro core 2";
		}

		// Function from file: mining_mobs.dm
		public Obj_Item_Organ_Internal_HivelordCore ( dynamic loc = null ) : base( (object)(loc) ) {
			// Warning: Super call was HERE! If anything above HERE is needed by the super call, it might break!;
			Task13.Schedule( 2400, (Task13.Closure)(() => {
				
				if ( !Lang13.Bool( this.owner ) && !this.preserved ) {
					this.inert = true;
					this.desc = "The remains of a hivelord that have become useless, having been left alone too long after being harvested.";
				}
				return;
			}));
			return;
		}

		// Function from file: mining_mobs.dm
		public override Obj_Item_Weapon_ReagentContainers_Food_Snacks_Organ prepare_eat(  ) {
			return null;
		}

		// Function from file: mining_mobs.dm
		public override bool afterattack( dynamic target = null, dynamic user = null, bool? proximity_flag = null, string click_parameters = null ) {
			dynamic H = null;

			
			if ( proximity_flag == true && target is Mob_Living_Carbon_Human ) {
				H = target;

				if ( this.inert ) {
					user.WriteMsg( "<span class='notice'>" + this + " have become inert, its healing properties are no more.</span>" );
					return false;
				} else {
					
					if ( Convert.ToInt32( H.stat ) == 2 ) {
						user.WriteMsg( "<span class='notice'>" + this + " are useless on the dead.</span>" );
						return false;
					}

					if ( H != user ) {
						((Ent_Static)H).visible_message( "" + user + " forces " + H + " to apply " + this + "... they quickly regenerate all injuries!" );
					} else {
						user.WriteMsg( "<span class='notice'>You start to smear " + this + " on yourself. It feels and smells disgusting, but you feel amazingly refreshed in mere moments.</span>" );
					}
					H.revive();
					GlobalFuncs.qdel( this );
				}
			}
			base.afterattack( (object)(target), (object)(user), proximity_flag, click_parameters );
			return false;
		}

		// Function from file: mining_mobs.dm
		public override void on_life(  ) {
			dynamic H = null;
			dynamic B = null;
			int blood_volume = 0;

			base.on_life();

			if ( Lang13.Bool( this.owner ) ) {
				((Mob_Living)this.owner).adjustBruteLoss( -1 );
				((Mob_Living)this.owner).adjustFireLoss( -1 );
				((Mob_Living)this.owner).adjustOxyLoss( -2 );
			}

			if ( this.owner is Mob_Living_Carbon_Human ) {
				H = this.owner;
				B = Lang13.FindIn( typeof(Reagent_Blood), H.vessel.reagent_list );
				blood_volume = Num13.Floor( H.vessel.get_reagent_amount( "blood" ) ?1:0 );

				if ( Lang13.Bool( B ) && blood_volume < 560 && blood_volume != 0 ) {
					B.volume += 2;
				}
			}
			return;
		}

	}

}