// FILE AUTOGENERATED BY SOMNIUM13.

using System;
using Somnium.Engine.ByImpl;

namespace Somnium.Game {
	class Mob_Living_SimpleAnimal_Hostile_MiningDrone : Mob_Living_SimpleAnimal_Hostile {

		protected override void __FieldInit() {
			base.__FieldInit();

			this.icon_living = "mining_drone";
			this.status_flags = 11;
			this.a_intent = "hurt";
			this.min_oxy = 0;
			this.max_tox = false;
			this.max_co2 = 0;
			this.minbodytemp = 0;
			this.wander = false;
			this.idle_vision_range = 5;
			this.move_to_delay = 10;
			this.retreat_distance = 1;
			this.minimum_distance = 2;
			this.melee_damage_lower = 15;
			this.melee_damage_upper = 15;
			this.attacktext = "drills";
			this.attack_sound = "sound/weapons/circsawhit.ogg";
			this.ranged = true;
			this.ranged_message = "shoots";
			this.projectiletype = typeof(Obj_Item_Projectile_Beam);
			this.projectilesound = "sound/weapons/laser.ogg";
			this.wanted_objects = new ByTable(new object [] { typeof(Obj_Item_Weapon_Ore) });
			this.icon = "icons/obj/aibots.dmi";
			this.icon_state = "mining_drone";
		}

		// Function from file: mine_items.dm
		public Mob_Living_SimpleAnimal_Hostile_MiningDrone ( dynamic loc = null ) : base( (object)(loc) ) {
			// Warning: Super call was HERE! If anything above HERE is needed by the super call, it might break!;
			this.SetCollectBehavior();
			return;
		}

		// Function from file: mine_items.dm
		public override bool adjustBruteLoss( dynamic amount = null, string damage_type = null ) {
			
			if ( this.search_objects != 0 ) {
				this.SetOffenseBehavior();
			}
			base.adjustBruteLoss( (object)(amount), damage_type );
			return false;
		}

		// Function from file: mine_items.dm
		public override dynamic AttackingTarget(  ) {
			
			if ( this.target is Obj_Item_Weapon_Ore ) {
				this.CollectOre();
				return null;
			}
			base.AttackingTarget();
			return null;
		}

		// Function from file: mine_items.dm
		public void DropOre(  ) {
			Obj_Item_Weapon_Ore O = null;

			
			if ( !( this.contents.len != 0 ) ) {
				return;
			}

			foreach (dynamic _a in Lang13.Enumerate( this.contents, typeof(Obj_Item_Weapon_Ore) )) {
				O = _a;
				
				this.contents.Remove( O );
				O.loc = this.loc;
			}
			return;
		}

		// Function from file: mine_items.dm
		public void CollectOre(  ) {
			Obj_Item_Weapon_Ore O = null;
			dynamic dir = null;
			Tile T = null;

			
			foreach (dynamic _a in Lang13.Enumerate( this.loc, typeof(Obj_Item_Weapon_Ore) )) {
				O = _a;
				
				O.loc = this;
			}

			foreach (dynamic _c in Lang13.Enumerate( GlobalVars.alldirs )) {
				dir = _c;
				
				T = Map13.GetStep( this, Convert.ToInt32( dir ) );

				foreach (dynamic _b in Lang13.Enumerate( T, typeof(Obj_Item_Weapon_Ore) )) {
					O = _b;
					
					O.loc = this;
				}
			}
			return;
		}

		// Function from file: mine_items.dm
		public void SetOffenseBehavior(  ) {
			this.stop_automated_movement_when_pulled = false;
			this.idle_vision_range = 5;
			this.search_objects = 0;
			this.wander = false;
			this.ranged = true;
			this.retreat_distance = 1;
			this.minimum_distance = 2;
			this.icon_state = "mining_drone_offense";
			return;
		}

		// Function from file: mine_items.dm
		public void SetCollectBehavior(  ) {
			this.stop_automated_movement_when_pulled = true;
			this.idle_vision_range = 9;
			this.search_objects = 2;
			this.wander = true;
			this.ranged = false;
			this.minimum_distance = 1;
			this.retreat_distance = null;
			this.icon_state = "mining_drone";
			return;
		}

		// Function from file: mine_items.dm
		public override dynamic attack_hand( dynamic a = null, dynamic b = null, dynamic c = null ) {
			
			if ( a.a_intent == "help" ) {
				
				switch ((int)( this.search_objects )) {
					case 0:
						this.SetCollectBehavior();
						GlobalFuncs.to_chat( a, new Txt( "<span class='info'>" ).The( this ).item().str( " will now search and store loose ore.</span>" ).ToString() );
						break;
					case 2:
						this.SetOffenseBehavior();
						GlobalFuncs.to_chat( a, new Txt( "<span class='info'>" ).The( this ).item().str( " will now attack hostile wildlife.</span>" ).ToString() );
						break;
				}
				return null;
			}
			base.attack_hand( (object)(a), (object)(b), (object)(c) );
			return null;
		}

		// Function from file: mine_items.dm
		public override void Die( bool? gore = null ) {
			base.Die( gore );
			this.visible_message( new Txt( "<span class='danger'>" ).The( this ).item().str( " blows apart!</span>" ).ToString() );
			new Obj_Effect_Decal_Remains_Robot( this.loc );
			this.DropOre();
			GlobalFuncs.qdel( this );
			return;
		}

		// Function from file: mine_items.dm
		public override dynamic attackby( dynamic a = null, dynamic b = null, dynamic c = null ) {
			dynamic W = null;

			
			if ( a is Obj_Item_Weapon_Weldingtool ) {
				W = a;

				if ( W.welding && !Lang13.Bool( this.stat ) ) {
					
					if ( this.stance != 1 ) {
						GlobalFuncs.to_chat( b, new Txt( "<span class='warning'>" ).The( this ).item().str( " is moving around too much to repair!</span>" ).ToString() );
						return null;
					}

					if ( this.maxHealth == this.health ) {
						GlobalFuncs.to_chat( b, new Txt( "<span class='notice'>" ).The( this ).item().str( " is at full integrity.</span>" ).ToString() );
					} else {
						this.health += 10;
						((Ent_Static)b).visible_message( new Txt( "<span class='notice'>" ).item( b ).str( " repairs some of the armor on " ).the( this ).item().str( ".</span>" ).ToString(), new Txt( "<span class='notice'>You repair some of the armor on " ).the( this ).item().str( ".</span>" ).ToString() );
					}
					return null;
				}
			}

			if ( a is Obj_Item_Device_MiningScanner ) {
				GlobalFuncs.to_chat( b, new Txt( "<span class='notice'>You instruct " ).the( this ).item().str( " to drop any collected ore.</span>" ).ToString() );
				this.DropOre();
				return null;
			}
			base.attackby( (object)(a), (object)(b), (object)(c) );
			return null;
		}

	}

}